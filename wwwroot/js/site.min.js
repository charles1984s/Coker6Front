function ready(){Coker.Token={GetToken:function(){return $.ajax({url:"/api/Token/CreateToken",type:"POST"})},CheckToken:function(e){return $.ajax({url:"/api/Token/CheckToken/",type:"GET",data:{id:e}})}},$.cookie("Member_Name","會員一",{path:"/"}),"function"==typeof PageReady&&PageReady(),HeaderInit(),FooterInit(),SideFloatingInit();var e=$("header").css("height");$("body").css("padding-top",e),$(window).resize((function(){var e=$("header").css("height");$("body").css("padding-top",e)})),null==$.cookie("cookie")||"reject"==$.cookie("cookie")?$("#Cookie").toggleClass("show"):CheckToken(),SiteElementInit(),$(".btn_refresh").on("click",(function(e){e.preventDefault(),NewCaptcha($LoginImgCaptcha,$InputLoginVCode),NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode)}));var o=document.getElementById("LoginModal");o.addEventListener("show.bs.modal",(function(e){NewCaptcha($LoginImgCaptcha,$InputLoginVCode)})),o.addEventListener("hidden.bs.modal",(function(e){FormClear(LoginForms,$InputLoginVCode)}));var t=document.getElementById("RegisterModal");t.addEventListener("show.bs.modal",(function(e){NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode)})),t.addEventListener("hidden.bs.modal",(function(e){FormClear(RegisterForms,$InputRegisterVCode)})),$(".btn_login").on("click",(function(){SiteFormCheck(LoginForms,$InputLoginVCode)?CaptchaVerify($LoginImgCaptcha,$InputLoginVCode,LoginAction):Coker.sweet.error("錯誤","請確實填寫登入資料",null,!0)})),$(".btn_register").on("click",(function(){var e=PassCheck(),o=SiteFormCheck(RegisterForms,$InputRegisterVCode);$NewPass.keyup(PassCheck),$CheckPass.keyup(PassCheck),e&&o?CaptchaVerify($RegisterImgCaptcha,$InputRegisterVCode,RegisterAction):Coker.sweet.error("錯誤","請確實填寫註冊資料",null,!0)})),$(".btn_cookie_accept").on("click",cookie_accept),$(".btn_cookie_reject").on("click",cookie_reject),$("#Collapse_Button > i").on("click",(function(){$("footer").toggleClass("footer_pack_up")})),$(".btn_favorites").on("click",AddFavorites),window.onscroll=function(){scrollFunction()}}function SiteElementInit(){$InputLoginVCode=$("#InputLoginVCode"),$LoginImgCaptcha=$("#LoginImgCaptcha"),LoginForms=$("#LoginForm"),$LoginMail=$("#InputLoginMail"),$LoginPass=$("#InputLoginPass"),$LoginRemember=$("#CheckRemember"),$InputRegisterVCode=$("#InputRegisterVCode"),$RegisterImgCaptcha=$("#RegisterImgCaptcha"),RegisterForms=$("#RegisterForm"),$RegisterMail=$("#InputRegisterMail"),$RegisterName=$("#InputRegisterName"),$RegisterAccept=$("#CheckAccept"),$NewPass=$("#InputRegisterNewPass"),$NewPassFeedBack=$("#NewPassFeedBack"),$CheckPass=$("#InputRegisterCheckPass"),$CheckPassFeedBack=$("#CheckPassFeedBack")}function scrollFunction(){document.body.scrollTop>350||document.documentElement.scrollTop>350?$("#btn_gotop").css("display","block"):$("#btn_gotop").css("display","none")}function cookie_accept(){$.cookie("cookie","accept",{expires:7,path:"/"}),$("#Cookie").toggleClass("show"),CreateToken()}function cookie_reject(){$.cookie("cookie","reject"),$("#Cookie").toggleClass("show")}function CreateToken(){Coker.Token.GetToken().done((function(e){$.cookie("Token",e.token,{expires:30,path:"/"})}))}function CheckToken(){Coker.Token.CheckToken($.cookie("Token")).done((function(e){e.success||CheckToken()}))}function AddFavorites(){var e=$(this).children("i"),o=e.parents("li").first();e.hasClass("fa-solid")?Coker.sweet.confirm("確定將商品從收藏中移除？","該商品將會從收藏中移除，且不可復原。","確認移除","取消",(function(){e.removeClass("fa-solid"),e.hasClass("fav_item")&&(o.remove(),Coker.sweet.success("成功移除商品",null,!0))})):(e.addClass("fa-solid"),Coker.sweet.success("成功加入收藏",null,!0))}function SiteFormCheck(e,o){o.addClass("is-invalid");var t=!1;return Array.from(e).forEach((e=>{e.checkValidity()&&(t=!0),e.classList.add("was-validated")})),t}function CaptchaVerify(e,o,t){var s=o.val();""!=s?$.ajax("/api/Captcha/Validate?id="+id+"&code="+s,{dataType:"JSON",success:function(s){s.success?(o.removeClass("is-invalid"),o.addClass("is-valid"),t()):(o.addClass("is-invalid"),o.siblings("div").addClass("me-4 pe-2"),NewCaptcha(e,o),o.val(""),Coker.sweet.error("錯誤","驗證碼錯誤",null,!0))}}):(o.addClass("is-invalid"),o.siblings("div").addClass("me-4 pe-2"),NewCaptcha(e,o),o.val(""),Coker.sweet.error("錯誤","請確實填寫驗證碼",null,!0))}function LoginAction(){new bootstrap.Modal($("#LoginModal")).hide()}function RegisterAction(){new bootstrap.Modal($("#RegisterModal")).hide()}function NewCaptcha(e,o){id=Math.floor(1e4*Math.random()),e.attr("src","/api/Captcha/index?id="+id),o.val("")}function FormClear(e,o){e.removeClass("was-validated"),o.siblings("div").removeClass("me-4 pe-2"),o.removeClass("is-invalid"),$LoginMail.val(""),$LoginPass.val(""),$LoginRemember.prop("checked",!1),$RegisterMail.val(""),$RegisterName.val(""),$NewPass.val(""),$NewPassFeedBack.val(""),$CheckPass.val(""),$CheckPassFeedBack.val(""),$RegisterAccept.prop("checked",!1),o.val("")}function PassCheck(){if($NewPass.addClass("is-invalid"),$CheckPass.addClass("is-invalid"),$NewPass.val().length>=6)if(/\d+/.test($NewPass.val())&&/[a-zA-Z]+/.test($NewPass.val())&&!/[^\a-\z\A-\Z0-9]/g.test($NewPass.val())){if($NewPass.removeClass("is-invalid"),$NewPass.addClass("is-valid"),$NewPassFeedBack.text("　"),$CheckPass.val()==$NewPass.val())return $CheckPass.removeClass("is-invalid"),$CheckPass.addClass("is-valid"),$CheckPassFeedBack.text("　"),!0;$CheckPassFeedBack.text("密碼不相符")}else $NewPassFeedBack.text("密碼格式有誤"),$CheckPassFeedBack.text("密碼格式有誤");else $NewPassFeedBack.text("請輸入6個以上的字元"),$CheckPassFeedBack.text("密碼格式有誤");return!1}var Coker={timeout:{time:1500},sweet:{success:function(e,o,t){var s=!1;t&&(s=Coker.timeout.time),Swal.fire({icon:"success",html:e,showConfirmButton:!t,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:s}).then((e=>{e.isConfirmed&&"function"==typeof o&&o()}))},error:function(e,o,t,s){var a=!1;s&&(a=Coker.timeout.time),Swal.fire({icon:"error",title:e,html:o,showConfirmButton:!s,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:a}).then((e=>{e.isConfirmed&&"function"==typeof t&&t()}))},confirm:function(e,o,t,s,a){Swal.fire({icon:"info",title:e,html:o,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:t,cancelButtonText:s}).then((e=>{e.isConfirmed&&"function"==typeof a&&a()}))}}};