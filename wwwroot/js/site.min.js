var loginModal,otherLoginModal,registerModal,forgetModal,resetodal,OrgName="Page",LayoutType=0,SiteId=0,IsFaPage=!0;function ready(){const e=$("#main"),t=$("#ParentNode"),o=$("#PostCSS");loginModal=$("#LoginModal").length>0?new bootstrap.Modal($("#LoginModal")):null,otherLoginModal=$("#OtherLoginModal").length>0?new bootstrap.Modal($("#OtherLoginModal")):null,registerModal=$("#RegisterModal").length>0?new bootstrap.Modal($("#RegisterModal")):null,forgetModal=$("#ForgetModal").length>0?new bootstrap.Modal($("#ForgetModal")):null,resetodal=$("#ResetModal").length>0?new bootstrap.Modal($("#ResetModal")):null,jqueryExtend(),$("link").each((function(){var e=$(this);null!=e.data("orgname")&&(OrgName=e.data("orgname")),null!=e.data("layouttype")&&(LayoutType=e.data("layouttype")),null!=e.data("siteid")&&(SiteId=e.data("siteid")),null!=e.data("isfapage")&&(IsFaPage=e.data("isfapage"))})),IsFaPage="string"==typeof IsFaPage&&"true"==IsFaPage.toLowerCase();const n=function(){const e=$(this).find("img");$(e).data("mouseover")&&$(e).attr("src",$(e).data("mouseover"))},a=function(){const e=$(this).find("img");$(e).data("mouseout")&&$(e).attr("src",$(e).data("mouseout"))};if($(".menu-item").on("mouseover",n),$(".menu-item").on("mouseout",a),$(".menu-item").on("focus",n),$(".menu-item").on("blur",a),e.length>0){let o=e.text().indexOf("&amp;")>=0&&e.text().indexOf("lt;")>=0?Coker.stringManager.ReplaceAndSinge(e.text()):co.stringManager.htmlEncode(e.html()),n=document.createElement("span");if(n.innerHTML=o,t.length>0&&t.text().indexOf("subpage_content")>=0){let e=Coker.stringManager.ReplaceAndSinge(t.text()),o=$("<div>");o[0].innerHTML=e,o.html(o.text()),o.find(".catalog_frame,.noInherit").remove(),o.find(".subpage_content").replaceWith(n.textContent||n.innerText),n.textContent=o.html()}location.pathname.toLowerCase().indexOf("/article/")>=0?e.html($('<div class="container">').html(n.textContent||n.innerText)):location.pathname.toLowerCase().indexOf("/product/")>=0?e.find("#ProductDescription > Content").html(n.textContent||n.innerText):e.html(n.textContent||n.innerText),e.find("[draggable]").removeAttr("draggable"),e.removeClass("d-none")}if(o.length>0){const e=$("#frameCss");let t=Coker.stringManager.ReplaceAndSinge(o.text()),n=document.createElement("span");n.innerHTML=t,e.text(n.textContent||n.innerText),o.remove()}$(".editTime,.popular").appendTo(e),$(".backstageType").remove(),$(".one_swiper,.one_swiper_thumbs,.two_swiper,.three_swiper,.four_swiper,.five_swiper,.six_swiper,.picture-category").length>0&&SwiperInit({autoplay:!0}),$(".masonry").length>0&&FrameInit(),$(".type_change_frame").length>0&&ViewTypeChangeInit(),$(".hover_mask").length>0&&HoverEffectInit(),($(".catalog_frame").length>0||$(".menu_directory").length>0||$(".advertise_directory").length>0)&&DirectoryGetDataInit(),$(".sitemap_hierarchical_frame").length>0&&SitemapInit(),$(".link_with_icon").length>0&&LinkWithIconInit(),($(".anchor_directory").length>0||$(".anchor_title").length>0)&&AnchorPointInit(),$(".shareBlock").length>0&&ShareBlockInit(),$(".ContactForm").length>0&&setContact(),$(".BGCanvas").length>0&&setBGCanvas(),$(".FlipBook").length>0&&FlipBookInit(),$(".MapMessage").length>0&&MapMessage(),$(".getlatlng").length>0&&GetLatLng(),$("body").width()<992&&$("#lanBar").before($("#layout4 #NavbarContent")),$(".container .qa,.container-fluid .qa").length>0&&$(".container,.container-fluid").each(((e,t)=>{var o=$(t);void 0===o.attr("id")&&o.find("qa").length>0&&o.setRandenId(),o.find(".qa .collapse").each(((e,t)=>{$(t).attr("data-bs-parent",`#${o.attr("id")}`),0==e&&1!=o.find(".qa .collapse").length||$(t).collapse("hide")}))})),""!=location.hash&&$(location.hash).length>0&&$(location.hash).goTo(45),$("video").length>0&&$("video").each((function(){void 0!==this.video&&(this.video.pause(),setTimeout((()=>{this.video.play().then((e=>{console.log("playing start",e)})).catch((e=>{console.log("error playing",e)}))}),0))})),_c.Search.Init("#Search"),$(".nav-link").on("focus",(function(){$(this).trigger("mouseover")})),$(".dropdown-toggle").on("focus",(function(){new bootstrap.Dropdown($(this)[0],{}).show()})),$(".accesskey[href]").on("click",(function(e){const t=$(this);return $(t.attr("href")).goTo(),!1})),$("#videoModal").on("hidden.bs.modal",(function(){$(this).find("iframe").remove()})),$('[data-bs-target="#videoModal"]').on("click",(function(){const e=$("#videoModal .modal-body");let t="";var o=$(this).attr("data-model-target").match(/^.*(?:(?:youtu.be\/|v\/|vi\/|u\/w\/|embed\/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*/);if(e.find(".fa-duotone").removeClass("d-none"),e.find(".fa-3x").addClass("d-none"),null!=o&&o.length>0&&(t=o[1]),""!=t){if(0==e.find("iframe").length){$(`<iframe allowfullscreen="allowfullscreen" rel="0" src="https://www.youtube.com/embed/${t}?autohide=1" class="h-100"></iframe>`).appendTo(e)}e.find(".fa-duotone").addClass("d-none"),e.find(".fa-3x").addClass("d-none")}else e.find(".fa-duotone").addClass("d-none"),e.find(".fa-3x").addClass("d-none")})),Coker.Token={GetToken:function(){return $.ajax({url:"/api/Token/CreateToken",type:"POST"})},CheckToken:function(){return $.ajax({url:"/api/Token/CheckToken/",headers:{Authorization:"Bearer "+localStorage.getItem("verify").Token},type:"GET"})}},$.cookie("Member_Name","會員一",{path:"/"}),"function"==typeof PageReady&&PageReady(),"function"==typeof HeaderInit&&HeaderInit(),"function"==typeof FooterInit&&FooterInit(),SideFloatingInit(),Coker.Token.GetToken().done((e=>{e.success&&localStorage.setItem("token",e.token)})),null!=$.cookie("cookie")&&"reject"!=$.cookie("cookie")||$("#Cookie").toggleClass("show");const i=$("#EnterAdModal");var s=i.data("enteradid"),r=void 0===$.cookie("EnterAd_Show")?[]:$.cookie("EnterAd_Show").split(",");if($("#EnterAdModal").length>0&&(void 0===$.cookie("EnterAd_Show")||$.inArray(s.toString(),r)<0)){new bootstrap.Modal($("#EnterAdModal")).show(),i.on("hidden.bs.modal",(e=>{r.push(s),$.cookie("EnterAd_Show",r,{path:"/"})}));var d=$("#EnterAdModal .modal-content").data("aid");"undefined"!=d&&(Advertise.ActivityExposure({FK_Aid:d,FK_Tid:$.cookie("Token")}).done((function(e){console.log(e)})),$("#EnterAdModal img").on("click",(function(){Advertise.ActivityClick({FK_Aid:d,FK_Tid:$.cookie("Token")}).done((function(e){console.log(e)}))})))}SiteElementInit(),$(".btn_refresh").on("click",(function(e){e.preventDefault(),NewCaptcha($LoginImgCaptcha,$InputLoginVCode),NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode)}));var l=document.getElementById("LoginModal");null!=l&&(l.addEventListener("show.bs.modal",(function(e){NewCaptcha($LoginImgCaptcha,$InputLoginVCode)})),l.addEventListener("hidden.bs.modal",(function(e){FormClear(LoginForms,$InputLoginVCode)})));var c=document.getElementById("OtherLoginModal");null!=c&&(c.addEventListener("show.bs.modal",(function(e){loginModal.hide()})),c.addEventListener("hidden.bs.modal",(function(e){})));var g=document.getElementById("ResetModal");null!=g&&(g.addEventListener("show.bs.modal",(function(e){loginModal.hide(),NewCaptcha($ResetImgCaptcha,$InputResetVCode)})),g.addEventListener("hidden.bs.modal",(function(e){FormClear(ResetForms,$InputResetVCode)})));var u=document.getElementById("RegisterModal");null!=u&&(u.addEventListener("show.bs.modal",(function(e){loginModal.hide(),NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode)})),u.addEventListener("hidden.bs.modal",(function(e){FormClear(RegisterForms,$InputRegisterVCode)})));var h=document.getElementById("ForgetModal");null!=h&&(h.addEventListener("show.bs.modal",(function(e){loginModal.hide(),NewCaptcha($ForgetImgCaptcha,$InputForgetVCode)})),h.addEventListener("hidden.bs.modal",(function(e){FormClear(ForgetForms,$InputForgetVCode)}))),$(".btn_login").on("click",(function(){SiteFormCheck(LoginForms,$InputLoginVCode)?CaptchaVerify($LoginImgCaptcha,$InputLoginVCode,LoginAction):($InputLoginVCode.addClass("is-invalid"),$InputLoginVCode.siblings("div").addClass("me-4 pe-2"),NewCaptcha($LoginImgCaptcha,$InputLoginVCode),$InputLoginVCode.val(""),Coker.sweet.error("錯誤","請確實填寫登入資料",null,!0))})),$(".btn_register").on("click",(function(){var e=PassCheck(),t=SiteFormCheck(RegisterForms,$InputRegisterVCode);$NewPass.keyup(PassCheck),$CheckPass.keyup(PassCheck),e&&t?$RegisterAccept.prop("checked")?CaptchaVerify($RegisterImgCaptcha,$InputRegisterVCode,RegisterAction):(NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode),Coker.sweet.error("錯誤","請詳閱並同意會員條款",null,!0)):(NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode),Coker.sweet.error("錯誤","請確實填寫註冊資料",null,!0))})),$(".btn_cookie_accept").on("click",cookie_accept),$(".btn_cookie_reject").on("click",cookie_reject),$("#Collapse_Button").on("click",(function(){$("footer").toggleClass("footer_pack_up")})),$(".btn_favorites").on("click",AddFavorites),window.onscroll=function(){scrollFunction()}}function SiteElementInit(){$InputLoginVCode=$("#InputLoginVCode"),$LoginImgCaptcha=$("#LoginImgCaptcha"),LoginForms=$("#LoginForm"),$LoginMail=$("#InputLoginMail"),$LoginPass=$("#InputLoginPass"),$LoginRemember=$("#CheckRemember"),$InputRegisterVCode=$("#InputRegisterVCode"),$RegisterImgCaptcha=$("#RegisterImgCaptcha"),RegisterForms=$("#RegisterForm"),$RegisterMail=$("#InputRegisterMail"),$RegisterName=$("#InputRegisterName"),$RegisterAccept=$("#CheckAccept"),$InputForgetVCode=$("#InputForgetVCode"),$ForgetImgCaptcha=$("#ForgetImgCaptcha"),ForgetForms=$("#ForgetForm"),$InputResetVCode=$("#InputResetVCode"),$ResetImgCaptcha=$("#ResetImgCaptcha"),ResetForms=$("#ResetForm"),$NewPass=$("#InputRegisterNewPass"),$NewPassFeedBack=$("#NewPassFeedBack"),$CheckPass=$("#InputRegisterCheckPass"),$CheckPassFeedBack=$("#CheckPassFeedBack")}function scrollFunction(){document.body.scrollTop>350||document.documentElement.scrollTop>350?$("#btn_gotop").css("display","block"):$("#btn_gotop").css("display","none")}function cookie_accept(){$.cookie("cookie","accept",{expires:7,path:"/"}),$("#Cookie").toggleClass("show"),CreateToken()}function cookie_reject(){$.cookie("cookie","reject"),$("#Cookie").toggleClass("show")}function CreateToken(){Coker.Token.GetToken().done((function(e){console.log("set token"),$.cookie("Token",e.token,{expires:30,path:"/"})}))}function CheckToken(){Coker.Token.CheckToken($.cookie("Token")).done((function(e){console.log(e),e.success?$.cookie("Token",e.token,{expires:30,path:"/"}):($.cookie("Token",null,{path:"/"}),CreateToken())}))}function AddFavorites(){var e=$(this).children("i"),t=e.parents("li").first();e.hasClass("fa-solid")?Coker.sweet.confirm("確定將商品從收藏中移除？","該商品將會從收藏中移除，且不可復原。","確認移除","取消",(function(){e.removeClass("fa-solid"),e.hasClass("fav_item")&&(t.remove(),Coker.sweet.success("成功移除商品",null,!0))})):(e.addClass("fa-solid"),Coker.sweet.success("成功加入收藏",null,!0))}function SiteFormCheck(e,t){t.addClass("is-invalid");var o=!1;return Array.from(e).forEach((e=>{e.checkValidity()&&(o=!0),e.classList.add("was-validated")})),o}function CaptchaVerify(e,t,o){var n=t.val();""!=n?$.ajax("/api/Captcha/Validate?id="+e.data("id")+"&code="+n,{dataType:"JSON",success:function(n){n.success?(t.removeClass("is-invalid"),t.addClass("is-valid"),o()):(t.addClass("is-invalid"),t.siblings("div").addClass("me-4 pe-2"),NewCaptcha(e,t),t.val(""),Coker.sweet.error("錯誤","驗證碼錯誤",null,!0))}}):(t.addClass("is-invalid"),t.siblings("div").addClass("me-4 pe-2"),NewCaptcha(e,t),t.val(""),Coker.sweet.error("錯誤","請確實填寫驗證碼",null,!0))}function LoginAction(){Coker.sweet.success("歡迎回來！",null,!0),loginModal.hide()}function RegisterAction(){var e=co.Form.getJson($("#RegisterForm").attr("id"));e.FK_WebsiteId=SiteId,e.FK_RoleId=2,co.User.AddUser(e).done((e=>{e.success?(Coker.sweet.success("註冊成功，已發送確認信至您的信箱！",null,!0),registerModal.hide()):(Coker.sweet.error(e.error,null,!0),NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode))}))}function ForgetAction(){var e=co.Form.getJson($("#ForgetForm").attr("id"));e.FK_WebsiteId=SiteId,e.FK_RoleId=2}function ResetAction(){var e=co.Form.getJson($("#ResetForm").attr("id"));e.FK_WebsiteId=SiteId,e.FK_RoleId=2}function NewCaptcha(e,t,o=""){if(!e.data("id")){e.data("id",Math.floor(1e4*Math.random()));const t=e.parents("form");let n=t.find("[name='captchaId']");0==n.length&&(n=$('<input type="hidden" name="captchaId" />'),t.append(n)),n.val(o+e.data("id"))}e.attr("src",`/api/Captcha/index?id=${o}${e.data("id")}&v=${Math.floor(1e4*Math.random())}`),t.val("")}function FormClear(e,t){e.removeClass("was-validated"),t.siblings("div").removeClass("me-4 pe-2"),t.removeClass("is-invalid"),$LoginMail.val(""),$LoginPass.val(""),$LoginRemember.prop("checked",!1),$RegisterMail.val(""),$RegisterName.val(""),$NewPass.val(""),$NewPassFeedBack.val(""),$CheckPass.val(""),$CheckPassFeedBack.val(""),$RegisterAccept.prop("checked",!1),t.val("")}function PassCheck(){if($NewPass.addClass("is-invalid"),$CheckPass.addClass("is-invalid"),$NewPass.val().length>=8)if(/\d+/.test($NewPass.val())&&/[a-zA-Z]+/.test($NewPass.val())&&!/[^\a-\z\A-\Z0-9]/g.test($NewPass.val())){if($NewPass.removeClass("is-invalid"),$NewPass.addClass("is-valid"),$NewPassFeedBack.text("　"),$CheckPass.val()==$NewPass.val())return $CheckPass.removeClass("is-invalid"),$CheckPass.addClass("is-valid"),$CheckPassFeedBack.text("　"),!0;$CheckPassFeedBack.text("密碼不相符")}else $NewPassFeedBack.text("密碼格式有誤"),$CheckPassFeedBack.text("密碼格式有誤");else $NewPassFeedBack.text("請輸入8個以上的字元"),$CheckPassFeedBack.text("密碼格式有誤");return!1}function ClickLog(e){null!=$.cookie("Token")&&Product.Log.Click({FK_Pid:e,FK_Tid:$.cookie("Token"),Action:2}).done((function(){ProdHistorySet()}))}var Coker={timeout:{time:1500},User:{AddUser:function(e){return $.ajax({url:"/api/User/AddUser",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})}},Form:{getJson:function(e,t){let o=document.getElementById(e),n=new FormData(o),a=void 0!==t&&t;return Object.fromEntries(Array.from(n.keys(),(e=>{const t=n.getAll(e);return[e,a||t.length>1?t:t.pop()]})))}},sweet:{success:function(e,t,o){var n=!1;o&&(n=Coker.timeout.time),Swal.fire({icon:"success",html:e,showConfirmButton:!o,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:n}).then((e=>{e.isConfirmed&&"function"==typeof t&&t()}))},error:function(e,t,o,n){var a=!1;n&&(a=Coker.timeout.time),Swal.fire({icon:"error",title:e,html:t,showConfirmButton:!n,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:a}).then((e=>{e.isConfirmed&&"function"==typeof o&&o()}))},confirm:function(e,t,o,n,a){Swal.fire({icon:"info",title:e,html:t,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:o,cancelButtonText:n}).then((e=>{e.isConfirmed&&"function"==typeof a&&a()}))}},stringManager:{ReplaceAndSinge:function(e){if(e){var t=e.replace(/&amp;/g,"&");return t.indexOf("&amp;")>0?_c.stringManager.ReplaceAndSinge(t):t}return""},htmlEncode:function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML}},Search:{Init:function(e){const t=$(e),o=t.find(".dropdown-menu button"),n=t.find(".input_sear"),a=$("#SearchInput");t.data("sid",o.first().data("id")),o.on("click",(function(){t.data("sid",$(this).data("id")),""!=n.val()&&(window.location.href=`/${OrgName}/Search/Get/${t.data("sid")}/${n.val()}`)})),t.find(".btn_sear").on("click",(function(){return""==n.val()?co.sweet.error("錯誤","請輸入搜尋文字",null,!1):window.location.href=`/${OrgName}/Search/Get/${t.data("sid")}/${n.val()}`,!1})),0!=a.length&&a.on("keypress",(function(e){13==e.which&&(window.location.href=`/${OrgName}/Search/Get/0/${a.val()}`)}))}},isMobileDevice:function(){let e=["Android","webOS","iPhone","iPad","iPod","BlackBerry","Windows Phone"];for(var t=0;t<e.length;t++)if(navigator.userAgent.match(e[t]))return!0;return!1}};$.fn.extend({goTo:function(e){$("html, body").animate({scrollTop:$(this).offset().top+(e||0)},0)},setRandenId:function(e){const t=$(this);let o=void 0!==t.attr("class")&&""!=t.attr("class")?t.attr("class").split(/\s+/)[0]+"Id":"",n=e||0;""==o&&(o="RandenId");let a=o+(0==n?"":n);0==$(`#${a}`).length?t.attr("id",a):t.setRandenId(n+1)},getFormJson:function(){const e=$(this),t=$(e).serializeArray();return $(t).each((function(){const t=this,o=$(e).find(`[name="${t.name}"]`);switch(o.attr("name")){case"authentiity_token":case"captcha":break;default:if("SELECT"===o.get(0).tagName)t.title=o.nextAll("label").text().trim(),t.value=o.find("option:selected").text().trim();else switch(o.attr("type")){case"radio":case"checkbox":t.title=o.parents(".d-flex").prevAll(".title").text().trim(),t.value="",$(e).find(`[name="${t.name}"]:checked`).each((function(){t.value+=$(this).nextAll("label").text().trim()+" ,"})),t.value=t.value.substring(0,t.value.length-2);break;default:t.title=o.nextAll("label").text().trim()}}})),t}});let _c=Coker,co=Coker;