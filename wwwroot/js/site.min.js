var loginModal,otherLoginModal,registerModal,forgetModal,resetModal,OrgName="Page",LayoutType=0,SiteId=0,IsFaPage=!0;function ready(){const e=$("#main"),t=$("#ParentNode"),n=$("#PostCSS");loginModal=$("#LoginModal").length>0?new bootstrap.Modal($("#LoginModal")):null,otherLoginModal=$("#OtherLoginModal").length>0?new bootstrap.Modal($("#OtherLoginModal")):null,registerModal=$("#RegisterModal").length>0?new bootstrap.Modal($("#RegisterModal")):null,forgetModal=$("#ForgetModal").length>0?new bootstrap.Modal($("#ForgetModal")):null,resetModal=$("#ResetModal").length>0?new bootstrap.Modal($("#ResetModal")):null,jqueryExtend(),$(".navbar-nav > .nav-item").each((function(){$this=$(this),0==$this.find(".subtitle").length&&$this.find(".menu-item").addClass("no-arrow")})),$("link").each((function(){var e=$(this);null!=e.data("orgname")&&(OrgName=e.data("orgname")),null!=e.data("layouttype")&&(LayoutType=e.data("layouttype")),null!=e.data("siteid")&&(SiteId=e.data("siteid")),null!=e.data("isfapage")&&(IsFaPage=e.data("isfapage"))})),IsFaPage="string"==typeof IsFaPage&&"true"==IsFaPage.toLowerCase();const a=function(){const e=$(this).find("img");$(e).data("mouseover")&&$(e).attr("src",$(e).data("mouseover"))},o=function(){const e=$(this).find("img");$(e).data("mouseout")&&$(e).attr("src",$(e).data("mouseout"))};if($(".menu-item").on("mouseover",a),$(".menu-item").on("mouseout",o),$(".menu-item").on("focus",a),$(".menu-item").on("blur",o),e.length>0){let n=e.text().indexOf("&amp;")>=0&&e.text().indexOf("lt;")>=0?Coker.stringManager.ReplaceAndSinge(e.text()):co.stringManager.htmlEncode(e.html()),a=document.createElement("span");if(a.innerHTML=n,t.length>0&&t.text().indexOf("subpage_content")>=0){let e=Coker.stringManager.ReplaceAndSinge(t.text()),n=$("<div>");n[0].innerHTML=e,n.html(n.text()),n.find(".catalog_frame,.noInherit").remove(),n.find(".subpage_content").replaceWith(a.textContent||a.innerText),a.textContent=n.html()}location.pathname.toLowerCase().indexOf("/article/")>=0?e.html($('<div class="container">').html(a.textContent||a.innerText)):location.pathname.toLowerCase().indexOf("/product/")>=0?e.find("#ProductDescription > Content").html(a.textContent||a.innerText):e.html(a.textContent||a.innerText),e.find("[draggable]").removeAttr("draggable"),e.find("#CustMain").length>0&&$("#jumpToCenter").attr("href","#CustMain"),e.removeClass("d-none")}if(n.length>0){const e=$("#frameCss");let t=Coker.stringManager.ReplaceAndSinge(n.text()),a=document.createElement("span");a.innerHTML=t,e.text(a.textContent||a.innerText),n.remove()}let i;$(".editTime,.popular").appendTo(e),$(".backstageType").remove(),($(".catalog_frame").length>0||$(".menu_directory").length>0||$(".advertise_directory").length>0)&&DirectoryGetDataInit(),$(".one_swiper,.one_swiper_thumbs,.two_swiper,.three_swiper,.four_swiper,.five_swiper,.six_swiper,.picture-category").length>0&&SwiperInit({autoplay:!0}),$(".marqueeSwiper").length>0&&MarqueeSwiper(),($(".masonry").length>0||$(".YTmodal_frame").length>0)&&FrameInit(),$(".type_change_frame").length>0&&ViewTypeChangeInit(),$(".hover_mask").length>0&&HoverEffectInit(),$(".sitemap_hierarchical_frame").length>0&&SitemapInit(),$(".link_with_icon").length>0&&LinkWithIconInit(),($(".anchor_directory").length>0||$(".anchor_title").length>0)&&AnchorPointInit(),$(".shareBlock").length>0&&ShareBlockInit(),$(".ContactForm").length>0&&setContact(),$(".BGCanvas").length>0&&setBGCanvas(),$(".FlipBookItem").length>0&&FlipBookInit(),$(".MapMessage").length>0&&MapMessage(),$(".getlatlng").length>0&&GetLatLng(),$("body").width()<992&&$("#lanBar").before($("#layout4 #NavbarContent")),$(".container .qa,.container-fluid .qa").length>0&&$(".container,.container-fluid").each(((e,t)=>{var n=$(t);void 0===n.attr("id")&&n.find("qa").length>0&&n.setRandenId(),n.find(".qa .collapse").each(((e,t)=>{$(t).attr("data-bs-parent",`#${n.attr("id")}`),$(t).collapse("hide")}))})),""!=location.hash&&$(location.hash).length>0&&$(location.hash).goTo(45),$("video").length>0&&$("video").each((function(){void 0!==this.video&&(this.video.pause(),setTimeout((()=>{this.video.play().then((e=>{console.log("playing start",e)})).catch((e=>{console.log("error playing",e)}))}),0))})),_c.Search.Init("#Search"),$(".nav-link").on("focus",(function(){$(this).trigger("mouseover")})),$(".dropdown-toggle").on("focus",(function(){new bootstrap.Dropdown($(this)[0],{}).show()})),$(".accesskey[href]").on("click",(function(e){const t=$(this),n=$(t.attr("href"));return n.length>0&&(n.goTo(),n.attr("tabindex","-1").trigger("focus"),n.on("blur",(function(){n.removeAttr("tabindex")}))),!1})),$("#videoModal").on("hidden.bs.modal",(function(){$(this).find("iframe").remove()})),$('[data-bs-target="#videoModal"]').on("click",(function(){const e=$("#videoModal .modal-body");let t="";var n=$(this).attr("data-model-target").match(/^.*(?:(?:youtu.be\/|v\/|vi\/|u\/w\/|embed\/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*/);if(e.find(".fa-duotone").removeClass("d-none"),e.find(".fa-3x").addClass("d-none"),null!=n&&n.length>0&&(t=n[1]),""!=t){if(0==e.find("iframe").length){$(`<iframe allowfullscreen="allowfullscreen" rel="0" src="https://www.youtube-nocookie.com/embed/${t}?autohide=1" class="h-100"></iframe>`).appendTo(e)}e.find(".fa-duotone").addClass("d-none"),e.find(".fa-3x").addClass("d-none")}else e.find(".fa-duotone").addClass("d-none"),e.find(".fa-3x").addClass("d-none")})),Coker.Token={GetToken:function(){return $.ajax({url:"/api/Token/CreateToken",type:"POST"})},CheckToken:function(){return $.ajax({url:"/api/Token/CheckToken/",headers:{Authorization:"Bearer "+localStorage.getItem("token")},type:"GET"})},AgreePrivacy:function(){return $.ajax({url:"/api/Token/AgreePrivacy/",headers:{Authorization:"Bearer "+localStorage.getItem("token")},type:"GET"})}},"function"==typeof PageReady&&PageReady(),"function"==typeof HeaderInit&&HeaderInit(),"function"==typeof FooterInit&&FooterInit(),SideFloatingInit(),CreateToken(),sessionStorage.setItem("pageLoadTime",Date.now());const r=function(){if(!sessionStorage.isNullOrEmpty("PageKey")){let e=Date.now()-parseInt(sessionStorage.getItem("pageLoadTime"));const t={PageKey:sessionStorage.getItem("PageKey"),TimeSpan:e},n={type:"application/json"},a=new Blob([JSON.stringify(t)],n);navigator.sendBeacon("/api/UserStatistic/trackTime",a),sessionStorage.setItem("pageLoadTime",Date.now())}};function s(){clearTimeout(i),i=setTimeout((function(){sessionStorage.setItem("pageLoadTime",Date.now())}),3e5)}window.addEventListener("beforeunload",(function(){document.hidden||r()})),document.addEventListener("mousemove",s),document.addEventListener("keydown",s),document.addEventListener("scroll",s),document.addEventListener("visibilitychange",(function(){document.hidden?r():sessionStorage.setItem("pageLoadTime",Date.now())}));const c=$("#EnterAdModal");var l=c.data("enteradid"),d=null==localStorage.getItem("AgreePrivacy")||null==localStorage.getItem("EnterAd_Show")?[]:localStorage.getItem("EnterAd_Show").split(",");if($("#EnterAdModal").length>0&&(null==localStorage.getItem("EnterAd_Show")||$.inArray(l.toString(),d)<0)){new bootstrap.Modal($("#EnterAdModal")).show(),c.on("hidden.bs.modal",(e=>{d.push(l),localStorage.setItem("EnterAd_Show",d)}));var u=$("#EnterAdModal .modal-content").data("aid");"undefined"!=u&&(Advertise.ActivityExposure(u).done((function(e){})),$("#EnterAdModal img").on("click",(function(){Advertise.ActivityClick(u).done((function(e){}))})))}SiteElementInit(),$(".btn_refresh").on("click",(function(e){e.preventDefault(),NewCaptcha($LoginImgCaptcha,$InputLoginVCode),NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode),NewCaptcha($ForgetImgCaptcha,$InputForgetVCode),NewCaptcha($ResetImgCaptcha,$InputResetVCode)}));var g=document.getElementById("LoginModal");null!=g&&(g.addEventListener("show.bs.modal",(function(e){NewCaptcha($LoginImgCaptcha,$InputLoginVCode)})),g.addEventListener("hidden.bs.modal",(function(e){FormClear(LoginForms,$InputLoginVCode)})));var p=document.getElementById("OtherLoginModal");null!=p&&(p.addEventListener("show.bs.modal",(function(e){loginModal.hide()})),p.addEventListener("hidden.bs.modal",(function(e){})));var h=document.getElementById("ResetModal");null!=h&&(h.addEventListener("show.bs.modal",(function(e){loginModal.hide(),NewCaptcha($ResetImgCaptcha,$InputResetVCode)})),h.addEventListener("hidden.bs.modal",(function(e){FormClear(ResetForms,$InputResetVCode)})));var m=document.getElementById("RegisterModal");null!=m&&(m.addEventListener("show.bs.modal",(function(e){loginModal.hide(),NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode)})),m.addEventListener("hidden.bs.modal",(function(e){FormClear(RegisterForms,$InputRegisterVCode)})));var f=document.getElementById("ForgetModal");null!=f&&(f.addEventListener("show.bs.modal",(function(e){loginModal.hide(),NewCaptcha($ForgetImgCaptcha,$InputForgetVCode)})),f.addEventListener("hidden.bs.modal",(function(e){FormClear(ForgetForms,$InputForgetVCode)}))),$("#LoginForm input").on("keypress",(function(e){13==e.which&&(e.preventDefault(),$("#LoginModal .btn_login").click())})),$(".btn_login").on("click",(function(){SiteFormCheck(LoginForms,$InputLoginVCode)?CaptchaVerify($LoginImgCaptcha,$InputLoginVCode,LoginAction):($InputLoginVCode.addClass("is-invalid"),$InputLoginVCode.siblings("div").addClass("me-4 pe-2"),NewCaptcha($LoginImgCaptcha,$InputLoginVCode),$InputLoginVCode.val(""),Coker.sweet.error("錯誤","請確實填寫登入資料",null,!0))})),$("#RegisterForm input").on("keypress",(function(e){13==e.which&&(e.preventDefault(),$("#RegisterModal .btn_register").click())})),$(".btn_register").on("click",(function(){var e=PassCheck($("#InputRegisterNewPass"),$("#InputRegisterCheckPass"),$("#RegisterNewPassFeedBack"),$("#RegisterCheckPassFeedBack"));$("#InputRegisterNewPass").keyup((function(){PassCheck($("#InputRegisterNewPass"),$("#InputRegisterCheckPass"),$("#RegisterNewPassFeedBack"),$("#RegisterCheckPassFeedBack"))})),$("#InputRegisterCheckPass").keyup((function(){PassCheck($("#InputRegisterNewPass"),$("#InputRegisterCheckPass"),$("#RegisterNewPassFeedBack"),$("#RegisterCheckPassFeedBack"))}));var t=SiteFormCheck(RegisterForms,$InputRegisterVCode);e&&t?$RegisterAccept.prop("checked")?CaptchaVerify($RegisterImgCaptcha,$InputRegisterVCode,RegisterAction):(NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode),Coker.sweet.error("錯誤","請詳閱並同意會員條款",null,!0)):(NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode),Coker.sweet.error("錯誤","請確實填寫註冊資料",null,!0))})),$("#ForgetForm input").on("keypress",(function(e){13==e.which&&(e.preventDefault(),$("#ForgetModal .btn_forget").click())})),$(".btn_forget").on("click",(function(){CaptchaVerify($ForgetImgCaptcha,$InputForgetVCode,ForgetAction)})),$(".btn_backlogin").on("click",(function(){loginModal.show(),forgetModal.hide()})),$("#ResetForm input").on("keypress",(function(e){13==e.which&&(e.preventDefault(),$("#ResetModal .btn_reset").click())})),$(".btn_reset").on("click",(function(){var e=PassCheck($("#InputResetNewPass"),$("#InputResetCheckPass"),$("#ResetNewPassFeedBack"),$("#ResetCheckPassFeedBack"));$("#InputResetNewPass").keyup((function(){PassCheck($("#InputResetNewPass"),$("#InputResetCheckPass"),$("#ResetNewPassFeedBack"),$("#ResetCheckPassFeedBack"))})),$("#InputResetCheckPass").keyup((function(){PassCheck($("#InputResetNewPass"),$("#InputResetCheckPass"),$("#ResetNewPassFeedBack"),$("#ResetCheckPassFeedBack"))}));var t=SiteFormCheck(ResetForms,$InputResetVCode);e&&t?CaptchaVerify($ResetImgCaptcha,$InputResetVCode,(function(){ResetAction($(".btn_reset").data("forgetId"))})):e?t||(NewCaptcha($ResetImgCaptcha,$InputResetVCode),Coker.sweet.error("錯誤","驗證碼輸入錯誤",null,!0)):(NewCaptcha($ResetImgCaptcha,$InputResetVCode),Coker.sweet.error("錯誤","密碼格式有誤",null,!0))})),$("#ResetModal .btn_resetforget").on("click",(function(){Coker.sweet.confirm(`寄送『密碼重設通知』至您的信箱："${$("#ResetForm").data("Email")}"?`,"","是","否",(function(){Coker.sweet.loading();var e={};e.Email=$("#ResetForm").data("Email"),e.WebsiteId=SiteId,e.WebsiteLink=$(location).attr("origin"),e.WebsiteName=$("meta[property='og:site_name'").attr("content"),co.User.PasswordForget(e).done((e=>{e.success?(Coker.sweet.success("系統將立即發送『密碼重設通知』信函至您所登錄之E-Mail中，此信函中包含您所設定之登入帳號(即E-mail)、密碼。請靜候密碼重設通知信。",null,!1),registerModal.hide()):Coker.sweet.error(e.error,null,!0)}))}))})),$(".btn_cookie_accept").on("click",cookie_accept),$(".btn_cookie_reject").on("click",cookie_reject),$("#Collapse_Button").on("click",(function(){$("footer").toggleClass("footer_pack_up")})),window.onscroll=function(){scrollFunction()};var C=$(location).attr("search").substring(1,$(location).attr("search").length).split("&"),k={};if($.each(C,(function(e,t){k[t.split("=")[0]]=t.split("=")[1]})),void 0!==k.useraction)switch(k.useraction){case"accountoping":void 0!==k.openid&&(Coker.sweet.loading(),co.User.AccountOpening(k.openid).done((e=>{if(e.success)Coker.sweet.custom("success","","會員帳號成功開通","填寫會員資料",(function(){window.location.href=`/${OrgName}/Member`}),"下次再說",(function(){location.reload()}));else if("ReSendOrNot"==e.message){var t={};t.OpenId=k.openid,t.WebsiteId=SiteId,t.WebsiteLink=$(location).attr("origin"),t.WebsiteName=$("meta[property='og:site_name'").attr("content"),co.sweet.confirm(e.error,"","重新寄送","取消",(function(){Coker.sweet.loading(),co.User.AccountReSendOpening(t).done((e=>{e.success?Coker.sweet.success("系統將立即重新發送『加入會員通知』信函至您所登錄之E-Mail中。請靜候開通帳號通知信。",null,!1):(console.log(e.error),console.log(e.message))}))}))}else co.sweet.error(e.error,"",null,!1)})));break;case"passwordforget":void 0!==k.forgetid&&(Coker.sweet.loading(),co.User.ForgetIdCheck(k.forgetid).done((e=>{e.success?(Swal.close(),resetModal.show(),$(".btn_reset").data("forgetId",k.forgetid)):co.sweet.error(e.error,"",null,!1)})))}$(".btn_passtoggle").on("click",(function(e){e.preventDefault();var t=$(this);switch(t.text()){case"visibility":t.parent("div").siblings("input").attr("type","password"),t.attr("title","顯示密碼"),t.text("visibility_off");break;case"visibility_off":t.parent("div").siblings("input").attr("type","text"),t.attr("title","隱藏密碼"),t.text("visibility")}}));var v=$("#TermsModal .modal-body .content").text().toString();v=$.trim(v),$("#TermsModal .modal-body .content").html(v)}function SiteElementInit(){$InputLoginVCode=$("#InputLoginVCode"),$LoginImgCaptcha=$("#LoginImgCaptcha"),LoginForms=$("#LoginForm"),$LoginMail=$("#InputLoginMail"),$LoginPass=$("#InputLoginPass"),$LoginRemember=$("#CheckRemember"),$InputRegisterVCode=$("#InputRegisterVCode"),$RegisterImgCaptcha=$("#RegisterImgCaptcha"),RegisterForms=$("#RegisterForm"),$RegisterMail=$("#InputRegisterMail"),$RegisterName=$("#InputRegisterName"),$RegisterAccept=$("#CheckAccept"),$InputForgetVCode=$("#InputForgetVCode"),$ForgetImgCaptcha=$("#ForgetImgCaptcha"),ForgetForms=$("#ForgetForm"),$InputResetVCode=$("#InputResetVCode"),$ResetImgCaptcha=$("#ResetImgCaptcha"),ResetForms=$("#ResetForm")}function scrollFunction(){document.body.scrollTop>350||document.documentElement.scrollTop>350?$("#btn_gotop").css("display","block"):$("#btn_gotop").css("display","none")}function cookie_accept(){Coker.Token.AgreePrivacy().done((function(e){e.success?(localStorage.setItem("AgreePrivacy","True"),$("#Cookie").hasClass("show")&&$("#Cookie").removeClass("show")):console.log(e)}))}function cookie_reject(){$("#Cookie").hasClass("show")&&$("#Cookie").removeClass("show")}function CreateToken(){Coker.Token.GetToken().done((function(e){localStorage.setItem("token",e.token),CheckToken()}))}function CheckToken(){Coker.Token.CheckToken().done((function(e){if(e.success){if(console.log("userData:",e),e.isLogin&&""!=e.name&&$("#HiUser > .name").text(`${e.name} 您好!`),$("#Cart_Dropdown_Parent").length>0&&CartDropInit(),window.location.pathname==`/${OrgName}/ShoppingCar`){var t=window.location.search;if(""==t)CardDataGet();else if($.isNumeric(t.substring(1))){if(!localStorage.getItem("lastSaveToken")==e.token&&null!=localStorage.getItem("lastSaveTime"))new Date(localStorage.getItem("lastSaveTime"))>new Date(Date.now()-9e5)&&Coker.Token.CheckToken(localStorage.getItem("lastSaveToken")).done((function(e){e.success&&(localStorage.setItem("token",e.token),localStorage.setItem("lastSaveTime",null))}))}}e.agreePrivacy?cookie_accept():$("#Cookie").hasClass("show")||$("#Cookie").addClass("show")}}))}function SiteFormCheck(e,t){t.addClass("is-invalid");var n=!1;return Array.from(e).forEach((e=>{e.checkValidity()&&(n=!0),e.classList.add("was-validated")})),n}function CaptchaVerify(e,t,n){var a=t.val();""!=a?$.ajax("/api/Captcha/Validate?id="+e.data("id")+"&code="+a,{dataType:"JSON",success:function(a){a.success?(t.removeClass("is-invalid"),t.addClass("is-valid"),n()):(t.addClass("is-invalid"),t.siblings("div").addClass("me-4 pe-2"),NewCaptcha(e,t),t.val(""),Coker.sweet.error("錯誤","驗證碼錯誤",null,!0))}}):(t.addClass("is-invalid"),t.siblings("div").addClass("me-4 pe-2"),NewCaptcha(e,t),t.val(""),Coker.sweet.error("錯誤","請確實填寫驗證碼",null,!0))}function LoginAction(){Coker.sweet.loading(),loginModal.hide();var e=co.Form.getJson($("#LoginForm").attr("id"));e.WebsiteId=SiteId,co.User.Login(e).done((t=>{if(t.success)Coker.sweet.success("歡迎回來！",(function(){location.reload()}),!1);else{if("重新寄送通知信"===t.message)Coker.sweet.confirm(t.error,"",t.message,"關閉視窗",(function(){Coker.sweet.loading(),e.WebsiteLink=$(location).attr("origin"),e.WebsiteName=$("meta[property='og:site_name'").attr("content"),e.RoleId=2,co.User.AccountReSendOpening(e).done((e=>{e.success?Coker.sweet.success("系統將重新發送『加入會員通知』信函至您所登錄之E-Mail中。請靜候開通帳號通知信。",null,!1):(console.log(e.error),console.log(e.message))}))}));else Coker.sweet.error(t.error,null,!1);console.log(t),NewCaptcha($LoginImgCaptcha,$InputLoginVCode)}}))}function RegisterAction(){Coker.sweet.loading();var e=co.Form.getJson($("#RegisterForm").attr("id"));e.WebsiteId=SiteId,e.WebsiteLink=$(location).attr("origin"),e.WebsiteName=$("meta[property='og:site_name'").attr("content"),e.RoleId=2,co.User.AddUser(e).done((t=>{if(t.success)Coker.sweet.success("<div>註冊成功</div><div>您將收到開通帳號的通知信</div><div>請至信箱確認以完成帳號開通</div>",null,!1),registerModal.hide();else{switch(console.log(t),console.log(t.message),t.message){case"重新寄送通知信":Coker.sweet.confirm(t.error,"",t.message,"關閉視窗",(function(){Coker.sweet.loading(),co.User.AccountReSendOpening(e).done((e=>{e.success?Coker.sweet.success("系統將重新發送『加入會員通知』信函至您所登錄之E-Mail中。請靜候開通帳號通知信。",null,!1):(Coker.sweet.error("發生未知錯誤","",null,!1),console.log(e.error),console.log(e.message))}))}));break;case"郵箱已存在":Coker.sweet.info(t.error,null);break;default:Coker.sweet.error(t.error,null,!0)}NewCaptcha($RegisterImgCaptcha,$InputRegisterVCode)}}))}function ForgetAction(){Coker.sweet.loading();var e=co.Form.getJson($("#ForgetForm").attr("id"));e.WebsiteId=SiteId,e.WebsiteLink=$(location).attr("origin"),e.WebsiteName=$("meta[property='og:site_name'").attr("content"),co.User.PasswordForget(e).done((e=>{e.success?(Coker.sweet.success("系統將立即發送『密碼重設通知』信函至您所登錄之E-Mail中，此信函中包含您所設定之登入帳號(即E-mail)、密碼。請靜候密碼重設通知信。",null,!1),registerModal.hide()):(Coker.sweet.error(e.error,null,!0),NewCaptcha($ForgetImgCaptcha,$InputForgetVCode))}))}function ResetAction(e){var t=co.Form.getJson($("#ResetForm").attr("id"));t.ForgetId=e,t.WebsiteId=SiteId,co.User.PasswordChange(t).done((e=>{if(e.success)Coker.sweet.success("密碼重置成功。",(function(){window.location.href=$(location).attr("origin")}),!1),registerModal.hide();else if("密碼錯誤"===e.message)Coker.sweet.confirm(e.error,"","忘記密碼?","確定",(function(){$("#ResetModal .btn_resetforget").click()})),NewCaptcha($ResetImgCaptcha,$InputResetVCode);else Coker.sweet.error(e.error,null,!0),NewCaptcha($ResetImgCaptcha,$InputResetVCode)}))}function NewCaptcha(e,t,n=""){if(!e.data("id")){e.data("id",Math.floor(1e4*Math.random()));const t=e.parents("form");let a=t.find("[name='captchaId']");0==a.length&&(a=$('<input type="hidden" name="captchaId" />'),t.append(a)),a.val(n+e.data("id"))}e.attr("src",`/api/Captcha/index?id=${n}${e.data("id")}&v=${Math.floor(1e4*Math.random())}`),t.val("")}function FormClear(e,t){e.removeClass("was-validated"),t.siblings("div").removeClass("me-4 pe-2"),t.removeClass("is-invalid"),$LoginMail.val(""),$LoginPass.val(""),$LoginRemember.prop("checked",!1),$RegisterMail.val(""),$RegisterName.val(""),$("#InputRegisterNewPass").val(""),$("#RegisterNewPassFeedBack").val(""),$("#InputRegisterCheckPass").val(""),$("#RegisterCheckPassFeedBack").val(""),$("#InputResetNewPass").val(""),$("#ResetNewPassFeedBack").val(""),$("#InputResetCheckPass").val(""),$("#ResetCheckPassFeedBack").val(""),$RegisterAccept.prop("checked",!1),t.val("")}function PassCheck(e,t,n,a){e.addClass("is-invalid"),t.addClass("is-invalid");var o=e.val(),i=0;if(o.length>=8)if(o.length<=32)if(/[0-9]/.test(o)&&(i+=1),/[A-Z]/.test(o)&&(i+=1),/[a-z]/.test(o)&&(i+=1),/[^\a-\z\A-\Z0-9]/g.test(o)&&(i+=1),i>=3){if(e.removeClass("is-invalid"),e.addClass("is-valid"),n.text("　"),t.val()==o)return t.removeClass("is-invalid"),t.addClass("is-valid"),a.text("　"),!0;a.text("密碼不相符")}else n.text("密碼格式有誤"),a.text("密碼格式有誤");else n.text("請輸入32個以下的字元"),a.text("密碼格式有誤");else n.text("請輸入8個以上的字元"),a.text("密碼格式有誤");return!1}var Coker={timeout:{time:1500},User:{AddUser:function(e){return $.ajax({url:"/api/User/AddUser",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})},AccountOpening:function(e){return $.ajax({url:"/api/User/AccountOpening/",type:"GET",contentType:"application/json; charset=utf-8",data:{OpenId:e}})},AccountReSendOpening:function(e){return $.ajax({url:"/api/User/ReSendOpening",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})},PasswordForget:function(e){return $.ajax({url:"/api/User/PasswordForget",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})},ForgetIdCheck:function(e){return $.ajax({url:"/api/User/ForgetIdCheck/",type:"GET",contentType:"application/json; charset=utf-8",data:{ForgetId:e}})},PasswordChange:function(e){return $.ajax({url:"/api/User/PasswordChage",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})},EmailChange:function(e){return $.ajax({url:"/api/User/EmailChage",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})},Login:function(e){return $.ajax({url:"/api/User/Login",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})},GetUser:function(e){return $.ajax({url:"/api/User/GetUserData/",type:"GET",contentType:"application/json; charset=utf-8"})},UserEdit:function(e){return $.ajax({url:"/api/User/FrontUserEdit",type:"POST",contentType:"application/json; charset=utf-8",headers:{Authorization:"Bearer "+localStorage.getItem("token")},data:JSON.stringify(e),dataType:"json"})},Logout:function(){return $.ajax({url:"/api/User/Logout",type:"GET",contentType:"application/json; charset=utf-8",headers:{Authorization:"Bearer "+localStorage.getItem("token")},dataType:"json"})}},ThirdParty:{Request:function(e,t){return $.ajax({url:"/api/ThirdParty/PayRequest",type:"GET",contentType:"application/json; charset=utf-8",headers:{Authorization:"Bearer "+localStorage.getItem("token")},data:{ohid:e,paytype:t}})}},Favorites:{Add:function(e){return $.ajax({url:"/api/Favorites/Add/",type:"GET",contentType:"application/json; charset=utf-8",data:{Pid:e}})},GetDisplay:function(){return $.ajax({url:"/api/Favorites/GetDisplay/",type:"GET",contentType:"application/json; charset=utf-8"})},Delete:function(e){return $.ajax({url:"/api/Favorites/Delete/",type:"GET",contentType:"application/json; charset=utf-8",data:{Fid:e}})},Check:function(e){return $.ajax({url:"/api/Favorites/CheckIsFavorites/",type:"GET",contentType:"application/json; charset=utf-8",data:{Pid:e}})}},Form:{getJson:function(e,t){let n=document.getElementById(e),a=new FormData(n),o=void 0!==t&&t;return Object.fromEntries(Array.from(a.keys(),(e=>{const t=a.getAll(e);return[e,o||t.length>1?t:t.pop()]})))},insertData:function(e,t){void 0===t||null==t?t=$("form").first():"string"==typeof t&&(t=$(t));const n=(t,n,a)=>{switch(t){case"zipcode":co.Zipcode.setData({el:n,addr:a});break;case"date_range":n.data("daterangepicker")||_c.Picker.Init(n),e[n.data("start")]||e[n.data("end")]?(n.data("daterangepicker").setStartDate(e[n.data("start")]),n.data("daterangepicker").setEndDate(e[n.data("end")])):n.val("");break;case"date":n.data("daterangepicker")||_c.Picker.Init(n,{singleDatePicker:!0,timePicker:!1,locale:{format:"YYYY/MM/DD"}}),n.data("daterangepicker").setStartDate(a||Date.now());break;case"disabled":if(n.on("change",(function(){("reverse"==$(this).data("direct")?!$(this).prop("checked"):$(this).prop("checked"))?$(`#${$(this).data("target")}`).attr("disabled","disabled").val(""):$(`#${$(this).data("target")}`).removeAttr("disabled")})),n.data("value")){let e=$(`#${n.data("target")}`).val();"number"==typeof n.data("value")?e=parseInt(e):"string"==typeof n.data("value")&&(e=e.toString()),a="reverse"==n.data("direct")?!(n.data("value")==e):n.data("value")==e}n.prop("checked",a),n.trigger("change");break;case"images":n.data("init")||(n.ImageUploadModalClear(),n.data("init",!0)),co.File.getImgFile({Sid:e[n.data("target")],Type:n.data("image-type"),Size:n.data("image-size")}).done((function(e){e.length>0&&ImageUploadModalDataInsert(n,e[0].id,e[0].link,e[0].name)}));break;case"html":n.empty().html($("<div>").html(a).html());break;default:n.val(a)}};for(const a in e){const o=t.find(`[name="${a}"]`);if(o.length>0)if(o.data("form-type"))n(o.data("form-type"),o,e[a]);else if("INPUT"===o[0].tagName)switch(o.attr("type").toLowerCase()){case"radio":t.find(`[name="${a}"][value="${e[a]}"]`).prop("checked",!0);break;case"checkbox":Array.isArray(e[a])?$(e[a]).each((function(e,n){t.find(`[name="${a}"][value="${n}"]`).prop("checked",!0)})):t.find(`[name="${a}"][value="${e[a]}"]`).prop("checked",!0);break;case"datetime-local":o.val(co.Date.GetDateTimeStr(e[a]));break;default:o.val(e[a])}else o.val(e[a])}}},sweet:{loading:function(){Swal.fire({title:"資料處理中",html:"已收到您填寫的資料，請稍後。",allowOutsideClick:!1,didOpen:()=>{Swal.showLoading()},willClose:()=>{}}).then((e=>{}))},custom:function(e,t,n,a,o,i,r){null==a&&null==i&&(closetime=Coker.timeout.time),Swal.fire({icon:e,title:t,text:n,showConfirmButton:null!=a,showCancelButton:null!=i,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:a,cancelButtonText:i}).then((e=>{e.isConfirmed?"function"==typeof o&&o():e.dismiss===Swal.DismissReason.cancel&&"function"==typeof r&&r()}))},success:function(e,t,n){var a=!1;n&&(a=Coker.timeout.time),Swal.fire({icon:"success",html:e,showConfirmButton:!n,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:a,allowOutsideClick:!1}).then((e=>{e.isConfirmed&&"function"==typeof t&&t()}))},error:function(e,t,n,a){var o=!1;a&&(o=Coker.timeout.time),Swal.fire({icon:"error",title:e,html:t,showConfirmButton:!a,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:o,allowOutsideClick:!1}).then((e=>{e.isConfirmed&&"function"==typeof n&&n()}))},confirm:function(e,t,n,a,o){Swal.fire({icon:"info",title:e,html:t,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:n,cancelButtonText:a,allowOutsideClick:!1}).then((e=>{e.isConfirmed&&"function"==typeof o&&o()}))},info:function(e,t){Swal.fire({icon:"info",title:e,showConfirmButton:!0,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"確定",timer:!1,allowOutsideClick:!1}).then((e=>{e.isConfirmed&&"function"==typeof t&&t()}))},warning:function(e,t,n){Swal.fire({title:e,text:t,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",confirmButtonText:"確定"}).then((e=>{"function"==typeof n&&n()})),"function"==typeof n&&setTimeout(n,3e3)}},stringManager:{ReplaceAndSinge:function(e){if(e){var t=e.replace(/&amp;/g,"&");return t.indexOf("&amp;")>0?_c.stringManager.ReplaceAndSinge(t):t}return""},htmlEncode:function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML}},Search:{Init:function(e){const t=$(e),n=t.find(".dropdown-menu button"),a=t.find(".input_sear"),o=$("#SearchInput");t.data("sid",n.first().data("id")),n.on("click",(function(){t.data("sid",$(this).data("id")),""!=a.val()&&(window.location.href=`/${OrgName}/Search/Get/${t.data("sid")}/${a.val()}`)})),t.find(".btn_sear").on("click",(function(){return""==a.val()?co.sweet.error("錯誤","請輸入搜尋文字",(function(){setTimeout((function(){o.trigger("focus")}),300)}),!1):window.location.href=`/${OrgName}/Search/Get/${t.data("sid")}/${a.val()}`,!1})),0!=o.length&&o.on("keypress",(function(e){13==e.which&&(window.location.href=`/${OrgName}/Search/Get/0/${o.val()}`)}))}},String:{generateRandomString:function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n=" ";const a=t.length;for(let o=0;o<e;o++)n+=t.charAt(Math.floor(Math.random()*a));return n},isNullOrEmpty:function(e){return void 0===e||null==e||""==e.trim()},getWeekNumber:function(e){return"一二三四五六日".charAt(e-1)},thousandSign:function(e){let t=parseFloat(e);return isNaN(t)?"0":t.toLocaleString()}},Zipcode:{init:function(e){const t=co.String.generateRandomString(5);var n,a;$TWzipcode=$(e),$TWzipcode.twzipcode({zipcodeIntoDistrict:!0}),$address=$TWzipcode.find(".address"),n=$TWzipcode.children(".county"),a=$TWzipcode.children(".district"),n.children("select").attr({id:`SelectCity_${t}`,class:"city form-select"}).prop("required",$address.prop("required")),n.append(`<label class='px-4 required' for='SelectCity_${t}'>縣市</label>`);var o=n.children("select").children("option").first();o.text("請選擇縣市"),o.attr("disabled","disabled"),a.children("select").attr({id:`SelectTown_${t}`,class:"town form-select"}).prop("required",$address.prop("required")),a.append(`<label class='required' for='SelectTown_${t}'>鄉鎮</label>`);var i=a.children("select").children("option").first();i.text("請選擇鄉鎮"),i.attr("disabled","disabled")},setData:function(e){const t=e.el.find(".address");if(co.String.isNullOrEmpty(e.addr))e.el.twzipcode("reset"),e.el.find(".address").val("");else{var n=e.addr.split(" ");e.el.twzipcode("set",{county:n[0],district:n[1]}),t.val(n[2])}},getData:function(e){return e.find(".county>select").val()+" "+e.find(".district>select").val()+" "+e.find(".address").val()}},isMobileDevice:function(){let e=["Android","webOS","iPhone","iPad","iPod","BlackBerry","Windows Phone"];for(var t=0;t<e.length;t++)if(navigator.userAgent.match(e[t]))return!0;return!1}};$.fn.extend({goTo:function(e){$("html, body").animate({scrollTop:$(this).offset().top+(e||0)},0)},setRandenId:function(e){const t=$(this);let n=void 0!==t.attr("class")&&""!=t.attr("class")?t.attr("class").split(/\s+/)[0]+"Id":"",a=e||0;""==n&&(n="RandenId");let o=n+(0==a?"":a);0==$(`#${o}`).length?t.attr("id",o):t.setRandenId(a+1)},getFormJson:function(){const e=$(this),t=$(e).serializeArray();return $(t).each((function(){const t=this,n=$(e).find(`[name="${t.name}"]`);switch(n.attr("name")){case"authentiity_token":case"captcha":break;default:if("SELECT"===n.get(0).tagName)t.title=n.nextAll("label").text().trim(),t.value=n.find("option:selected").text().trim();else switch(n.attr("type")){case"radio":case"checkbox":t.title=n.parents(".d-flex").prevAll(".title").text().trim(),t.value="",$(e).find(`[name="${t.name}"]:checked`).each((function(){t.value+=$(this).nextAll("label").text().trim()+" ,"})),t.value=t.value.substring(0,t.value.length-2);break;default:t.title=n.nextAll("label").text().trim()}}})),t}});let _c=Coker,co=Coker;