function PageReady(){const e=$(".search-category>.container>button"),t=$(".search-category .catalog_frame");let a=null;e.on("click",(function(){window.location.href=`/${OrgName}/Search/Get/${$(this).data("id")}/${t.data("search-text")}`})),$(".search-category .catalog_frame [name='startDate']").on("change",(function(){t.data("startDate",$(this).val())})),$(".search-category .catalog_frame [name='endDate']").on("change",(function(){t.data("endDate",$(this).val())})),$(".search-category .search-input").on("change",(function(){t.data("search-text",$(this).val()),window.location.href=`/${OrgName}/Search/Get/${t.data("dirid")}/${t.data("search-text")}`})),$(".search-category .catalog_frame").on("load",(function(){const e=$(this),t=$("#filterTemp").html(),i=$("#filterList"),r=$(this).data("filter");i.empty(),$(r).each(((r,n)=>{const c=$(t),d=`filterType${n.type}`,o=c.find("ul"),l=o.html();o.empty();const f=c.find(".filterType>.form-check-input").data("type",n.type).attr("id",d).on("change",(function(){const e=$(this);e.prop("checked")?e.parents("li").find("li .form-check-input").prop("checked",!0).trigger("change"):e.parents("li").find("li .form-check-input").prop("checked",!1).trigger("change")}));if(c.find(".filterType>label").attr("for",d),$(n.tags).each(((t,i)=>{const r=$(l),c=`filterTag${n.type}-${i.fK_TId}`,d=r.children(".form-check-input").data({type:n.type,gid:n.id,id:i.fK_TId}).attr("id",c).on("change",(function(){const t=$(this);clearTimeout(a),void 0===e.data("filtered")&&e.data("filtered",[]),t.prop("checked")?filteredPush(e.data("filtered"),t.data()):filteredPop(e.data("filtered"),t.data()),a=setTimeout((function(){e.trigger("filter")}),1e3)}));if(r.children("label").attr("for",c),r.find(".tagName").text(i.tag_Name),r.find(".count").text(i.count),o.append(r),void 0!==e.data("filtered")){const t=e.data("filtered").filter((e=>e.type==n.type));if(0!=t.length){const e=t[0].group.filter((e=>e.id==n.id));0!=e.length&&e[0].tags.includes(i.fK_TId)&&d.prop("checked",!0).trigger("change")}}})),void 0!==e.data("filtered")){const t=e.data("filtered").filter((e=>e.type==n.type));if(0!=t.length){const e=t[0].group.filter((e=>e.id==n.id));0!=e.length&&e[0].tags.length==n.tags.length&&f.prop("checked",!0).trigger("change")}}c.find(".typeName").text(n.name),i.append(c)})),clearTimeout(a)})),$(".searchbtn").on("click",(function(){window.location.href=`/${OrgName}/Search/Get/${t.data("dirid")}/${t.data("search-text")}`})),"3"!=$(".search-category .active").data("id")||""==$(".searchText").text().trim()?$("#filterBlock").addClass("d-none"):$("#filterBlock").removeClass("d-none")}function filteredPush(e,t){filteredInsertOrDeleted(e,t,!0)}function filteredPop(e,t){filteredInsertOrDeleted(e,t,!1)}function filteredInsertOrDeleted(e,t,a){const i=e.filter((e=>e.type==t.type));let r=null;0==i.length?(r={type:t.type,group:[]},e.push(r)):r=i[0];const n=r.group.filter((e=>e.id==t.gid));if(0==n.length)r.group.push({id:t.gid,tags:[t.id]});else{const e=n[0].tags;e.includes(t.id)?a||e.splice(e.indexOf(t.id),1):a&&e.push(t.id)}}