function PageReady(){let e=$("#TWzipcode .address").val();co.Zipcode.init("#TWzipcode"),co.Zipcode.setData({el:$("#TWzipcode"),addr:e}),Coker.Token.CheckToken().done((function(e){e.isLogin?Member(e):co.sweet.warning("尚未登入","請登入後再重新操作，將引導至首頁。",(function(){location.href="/"}))}))}function Member(e){$("#ResetForm .reset_old_pass").removeClass("d-none"),$("#ResetForm .reset_old_pass input").removeAttr("disabled"),$("#ResetOldPassFeedBack").removeClass("d-none"),$("#ResetModal .btn_resetforget").removeClass("d-none"),SetMemberData(),SetHistoryData(),$(".btn_logout").on("click",(function(){co.User.Logout().done((function(e){e.success&&(co.sweet.success("登出成功"),setTimeout((e=>{location.href="/"}),1e3))}))})),$(".btn_modifi").on("click",(function(){if(""==$("#Name").val())co.sweet.error("輸入資料錯誤","姓名不可為空",null,!1);else if(""==$("#Email").val())co.sweet.error("輸入資料錯誤","電子郵件不可為空",null,!1);else{var e=co.Form.getJson($("#UserDataForm").attr("id"));e.address=`${e.county} ${e.district} ${e.address}`,co.User.UserEdit(e).done((function(e){co.sweet.success("資料修改完成！",null,!0)}))}})),$(".btn_resetPassword").on("click",(function(){resetModal.show()}))}function SetMemberData(){Coker.User.GetUser().done((function(e){if(e.success){co.Form.insertData(e.data,"#UserDataForm"),$("#ResetForm").data("Email",e.data.email),co.Zipcode.setData({el:$("#TWzipcode"),addr:e.data.address});var t=new Date,o=(t.getMonth()+1).toString();1==o.length&&(o="0"+o);var a=t.getDate().toString();1==a.length&&(a="0"+a);var n=`${t.getFullYear()}-${o}-${a}`;$("#Birthday").attr("max",n),$("#Birthday").on("keydown",(function(e){e.preventDefault()}))}}))}function SetHistoryData(){Product.GetAll.History().done((function(e){$.each(e,(function(e,t){var o=$($("#Template_Prod_List").html()).clone();o.find("*").each((function(){var e=$(this);if(void 0!==e.data("key")){var o=e.data("key");switch(o){case"link":e.attr("href",`${window.location.pathname}${t.link}`),e.attr("title",`連結至：${t.title}`);break;case"image":e.attr("src",t.image),e.attr("alt",`${t.title}的主要照片`);break;default:e.text(t[o])}}})),$("#history-tab-pane").append(o)}))}))}