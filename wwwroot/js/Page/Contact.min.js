var id,$captcha_input,$imgCaptcha,form_correct=!1;function PageReady(){$captcha_input=$("#InputCaptcha"),$imgCaptcha=$("#imgCaptcha"),NewCaptcha();const a=$("#ContactForm");$(".btn_refresh").on("click",NewCaptcha),Array.from(a).forEach((a=>{a.addEventListener("submit",(t=>{a.checkValidity()?(t.preventDefault(),form_correct=!0,CaptchaVerify()):(t.preventDefault(),t.stopPropagation(),form_correct=!1,CaptchaVerify(),NewCaptcha()),a.classList.add("was-validated")}),!1)})),document.addEventListener("keyup",(function(){var a=event.target;if("INPUT"==a.nodeName&&a.value.length==a.maxLength){var t=$(a).parents("form").first().find("input");for(let c=0;c<t.length;c++)if(t[c]==a)return void(t[c+1]&&t[c+1].focus())}}))}function CaptchaVerify(){var a=$captcha_input.val();return""==!a&&$.ajax("/api/Captcha/Validate?id="+id+"&code="+a,{dataType:"JSON",success:function(a){a.success?($captcha_input.removeClass("is-invalid"),form_correct&&(Coker.sweet.success("成功送出表單！",null,!0),verify_correct=!1,setTimeout((function(){$("#ContactForm").submit()}),1500))):(console.log($captcha_input.siblings("div").children("img")),$captcha_input.val(""))}}),!1}function NewCaptcha(){id=Math.floor(1e4*Math.random()),$imgCaptcha.attr("src","/api/Captcha/index?id="+id),$captcha_input.val("")}