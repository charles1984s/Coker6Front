var $input_quantity,Pid,s1,s2,spectype_list,spec_list,s1_list=[],s2_list=[],price_list=[];function PageReady(){ElementInit(),window.CI360.init(),PageDefaultSet(Pid=$(location).attr("href").substr($(location).attr("href").lastIndexOf("/")+1));var e=new Swiper(".PreviewSwiper",{slidesPerView:4,loop:!1,spaceBetween:10,freeMode:!0,watchSlidesProgress:!0,scrollbar:{el:".swiper-scrollbar"},breakpoints:{576:{slidesPerView:4},768:{slidesPerView:6},992:{slidesPerView:8}}});new Swiper(".ProductSwiper",{spaceBetween:15,loop:!0,navigation:{nextEl:".btn_swiper_next_product",prevEl:".btn_swiper_prev_product"},breakpoints:{768:{allowTouchMove:!0},992:{allowTouchMove:!1}},thumbs:{swiper:e}});$(".pro_display").on("click",ShowBigPro);document.getElementById("ProDisplayModal").addEventListener("hidden.bs.modal",(e=>{window.CI360.destroy(),$("#Pro_Youtube").attr("src","")})),$("#shareBlock").cShare({description:"jQuery plugin - C Share buttons",showButtons:["fb","line","plurk","twitter","email"]}),$(document).on("click",".btn_count_plus",(function(){$input_quantity.val(parseInt($input_quantity.val())+1)})),$(document).on("click",".btn_count_minus",(function(){$input_quantity.val(parseInt($input_quantity.val())-1),0==$input_quantity.val()&&$input_quantity.val(1)}));var t=$("#Product > .content > .options > .radio > .control");t.children().length<=2&&t.children("label").toggleClass("pe-none"),$(".btn_addToCar").on("click",AddToCart),$(".btn_tc").on("click",(function(){$("#ProductDescription").removeClass("active show"),$("#TechnicalDocuments").addClass("active show"),$("#pills-description-tab").removeClass("active"),$("#pills-documents-tab").addClass("active");var e=$(this).data("tcid");$(".badge_directions").each((function(){var t=$(this);t.data("pro_tc")==e&&$("html, body").animate({scrollTop:t.offset().top-2*$("header").height()},0)}))}))}function ElementInit(){$input_quantity=$(".input_pro_quantity"),$prod_content=$("#Product > .content"),$pro_name=$prod_content.find(".pro_title"),$pro_introduce=$prod_content.find(".introduce"),$pro_specification=$prod_content.find(".specification").children("ul"),$pro_price=$prod_content.find(".ori_price"),$pro_discount=$prod_content.find(".discount"),$btn_detailed=$prod_content.find(".btn_detailed"),$options=$prod_content.find(".options")}function PageDefaultSet(){Product.GetOne.Prod(Pid).done((function(e){if(void 0!==e){$pro_name.text(e.title),$pro_introduce.append("<li>"+e.introduction.replaceAll("\n","</li><li>")+"</li>"),$pro_specification.append("<li>"+e.description.replaceAll("\n","</li><li>")+"</li>");var t=0;$pro_specification.children("li").each((function(){t+=$(this).height()})),t>$pro_specification.height()&&$btn_detailed.removeClass("d-none"),$("#ProductDescription").append("<li>■ "+e.introduction.replaceAll("\n","</li><li>■ ")+"</li>"),Product.GetOne.TechCert({Id:Pid}).done((function(e){if(e.length>0){$("#Product > .content > .pro_tc").removeClass("d-none");e.forEach((function(e){var t="";e.img.length>0&&(e.img.forEach((function(i){$(".pro_tc > ul").prepend(`<li class="me-1"><button class="btn_tc bg-transparent border-0" data-tcid="${e.id}"><img src="${i.link}" alt="${i.name}" /></button></li>`),t+=`<img class="my-1" src="${i.link}" alt="${i.name}" />`})),$(".pro_tc_content > .filedownload").after(`<div class="badge_${e.id} d-flex align-items-center" data-tcid="${e.id}">\n                                                            <div class="d-flex flex-column py-2 me-5">${t}</div>\n\t\t\t                                                <div class="text d-flex align-items-center">${e.description}</div></div>\n\t\t                                                    <hr class="m-1" />`))})),$(".btn_tc").on("click",(function(){$("#ProductDescription").removeClass("active show"),$("#TechnicalDocuments").addClass("active show"),$("#pills-description-tab").removeClass("active"),$("#pills-documents-tab").addClass("active");var e=$(this);$("html, body").animate({scrollTop:$(`.badge_${e.data("tcid")}`).offset().top-2*$("header > nav").height()},0)}))}})),Product.GetOne.Stock(Pid).done((function(e){if(e.length>1){var t={},i=$($("#Template_Spec_Radio").html()).clone(),n=$($("#Template_Spec_Radio").html()).clone(),o=i.find(".spec_control"),a=n.find(".spec_control");i.data("stype",1),n.data("stype",2),e.forEach((function(e){t.s1id=e.fK_S1id,t.s2id=e.fK_S2id,t.price=e.price,price_list.push(t),t={},e.fK_S1id>0?s1_list.indexOf(e.fK_S1id)<0&&(o.prepend('<label class="btn_radio me-2 my-1 px-3 py-1 align-self-center" for="s1_'+e.fK_S1id+'">'+e.s1_Name+"</label>"),o.prepend('<input id="s1_'+e.fK_S1id+'" type="radio" class="btn-check" name="S1_Radio" autocomplete="off" value="'+e.fK_S1id+'">'),s1_list.push(e.fK_S1id)):!s1>=0&&(s1=0),e.fK_S2id>0?s2_list.indexOf(e.fK_S2id)<0&&(a.prepend('<label class="btn_radio me-2 my-1 px-3 py-1 align-self-center" for="s2_'+e.fK_S2id+'">'+e.s2_Name+"</label>"),a.prepend('<input id="s2_'+e.fK_S2id+'" type="radio" class="btn-check" name="S2_Radio" autocomplete="off" value="'+e.fK_S2id+'">'),s2_list.push(e.fK_S2id)):!s2>=0&&(s2=0)})),$options.prepend(n),$options.prepend(i),$radio=$("#Product > .content > .options > .radio"),$radio.each((function(){$input=$(this).children(".spec_control").children("input"),$input.each((function(){$(this).on("click",SpecRadio)}))})),e[0].price==e[e.length-1].price?$pro_discount.text(e[0].price.toLocaleString("en-US")):$pro_discount.text(e[0].price.toLocaleString("en-US")+" ~ "+e[e.length-1].price.toLocaleString("en-US"))}else s1=e[0].fK_S1id,s2=e[0].fK_S2id,$pro_discount.text(e[0].price.toLocaleString("en-US"))}))}else if(1==window.location.pathname.substr(-2,2)){var i=$($("#TemplateDemoDescription").html()).clone();$("#ProductDescription").append(i);var n=$($("#TemplateIcon").html()).clone();$("#Product > .content > .pro_tc > ul").append(n)}else window.location.href=window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/"))}));var e=$(".ProductSwiper > .swiper-wrapper"),t=$(".PreviewSwiper > .swiper-wrapper");if(1==Pid){var i=$($("#TemplateDemoSlide").html()).clone(),n=$($("#TemplateDemoPreviewSlide").html()).clone();e.append(i),t.append(n)}else{var o=$($("#TemplateImageSlide").html()).clone(),a=o.find(".pro_display");o.data("pid",Pid),a.attr("src","/upload/product/pro_0"+Pid+".png"),e.append(o);var d=$($("#TemplatePreviewSlide").html()).clone(),s=d.find("img");d.data("pid",Pid),s.attr("src","/upload/product/pro_0"+Pid+".png"),t.append(d)}}function SpecRadio(){switch($self=$(this),$self_p=$self.parents(".radio").first(),$self_s=$self_p.siblings(".radio"),$self_p.find("input").each((function(){$radio=$(this),$radio.removeAttr("disabled")})),$self_s.find("input").each((function(){$radio=$(this),$radio.removeAttr("disabled")})),$self_p.data("stype")){case 1:s1=$self.val();var e=[];price_list.forEach((function(t){t.s1id==s1&&e.push(t.s2id)})),$self_s.find("input").attr("disabled","disabled"),$self_s.find("input").each((function(){$radio=$(this),e.indexOf(parseInt($radio.val()))>-1&&$radio.removeAttr("disabled")})),"disabled"==$self_s.find("input[value='"+parseInt(s2)+"']").attr("disabled")&&(s2=null);break;case 2:s2=$self.val();e=[];price_list.forEach((function(t){t.s2id==s2&&e.push(t.s1id)})),$self_s.find("input").attr("disabled","disabled"),$self_s.find("input").each((function(){$radio=$(this),e.indexOf(parseInt($radio.val()))>-1&&$radio.removeAttr("disabled")})),"disabled"==$self_s.find("input[value='"+parseInt(s2)+"']").attr("disabled")&&(s1=null)}null!=s1&&null!=s2&&price_list.forEach((function(e){e.s1id==s1&&e.s2id==s2&&$pro_discount.text(e.price.toLocaleString("en-US"))}))}function AddToCart(){null==$.cookie("cookie")||"reject"==$.cookie("cookie")?Coker.sweet.error("錯誤","若要進行商品選購，請先同意隱私權政策",null,!1):null!=s1&&null!=s2?Product.AddUp.Cart({FK_Tid:$.cookie("Token"),FK_Pid:parseInt(Pid),FK_S1id:s1,FK_S2id:s2,Quantity:$input_quantity.val(),Discont:0,Bonus:0,PriceType:0,IsAdditional:!1,Ser_No:500}).done((function(e){if(e.success){Coker.sweet.success("商品已成功加入購物車",null,!0);var t=e.message.substr(0,1),i=e.message.substr(1);Product.GetOne.Cart(i).done((function(e){"N"==t?CartDropAdd(e):CartDropUpdate(e)}))}else Coker.sweet.error("錯誤","商品加入購物車發生錯誤",null,!0)})).fail((function(){Coker.sweet.error("錯誤","商品加入購物車發生錯誤",null,!0)})):Coker.sweet.error("錯誤","請確實選擇規格",null,!1)}function ShowBigPro(){var e=$(this),t=$("#ProDisplayModal > .modal-dialog > .modal-content > .modal-body");switch(t.children(".pro_img").addClass("d-none"),t.children(".pro_youtube").addClass("d-none"),t.children(".pro_360view").addClass("d-none"),e.data("display-protype")){case"image":t.children(".pro_img").removeClass("d-none"),addImage(e);break;case"youtube":t.children(".pro_youtube").removeClass("d-none"),addYoutube(e);break;case"360view":t.children(".pro_360view").removeClass("d-none"),add360View(e)}}function addImage(e){for(var t=e.attr("src");t.indexOf("/")>=0;)t=t.substr(t.indexOf("/")+1);$("#Pro_Image").attr("data-filename-x",t),$("#ProDisplayModal").on("shown.bs.modal",(function(){document.getElementById("Pro_Image").classList.add("cloudimage-360"),window.CI360.add("Pro_Image")}))}function addYoutube(e){var t=e.data("youtube-link");$("#Pro_Youtube").attr("src","https://www.youtube.com/embed/"+t)}function add360View(e){var t=$("#Pro_360View");t.attr("data-filename-x",e.data("filename-x")),t.attr("data-amount-x",e.data("amount-x")),$("#ProDisplayModal").on("shown.bs.modal",(function(){document.getElementById("Pro_360View").classList.add("cloudimage-360"),window.CI360.add("Pro_360View")}))}