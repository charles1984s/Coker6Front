var Directory={getDirectoryData:function(t){return $.ajax({url:"/api/Directory/GetReleInfo",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})},getDirectoryMenuData:function(t){return $.ajax({url:"/api/Directory/GetReleMenu",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})}};function DirectoryGetDataInit(){var t;$(".catalog_frame").each((function(){var e=$(this),a=e.attr("data-dirid")>0?e.attr("data-dirid"):0;void 0!==e.data("prevdirid")&&a==e.data("prevdirid")||(e.data("prevdirid",a),t=void 0!==e.data("shownum")?e.data("shownum"):12,1,DirectoryDataGet(e,a,1,t))})),$(".menu_directory").each((function(){var t=$(this),e=t.attr("data-dirid")>0?t.attr("data-dirid"):0;void 0!==t.data("prevdirid")&&e==t.data("prevdirid")||(t.data("prevdirid",e),t.find(".title").text(""),t.find(".accordion").empty(),Directory.getDirectoryMenuData({Id:e,WebsiteId:"undefined"!=typeof SiteId?SiteId:0}).done((function(e){void 0!==e&&(t.find(".title").text(e.title),$.each(e.children,(function(a,i){if(t.find(".title").text(e.title),null!=i.children){var n=$($("#TemplateAccordionItem").html()).clone();n.find(".sectitle").text(i.title),n.find(".accordion-header").attr("id",`secheader${i.Id}`),n.find(".accordion-collapse").attr({"aria-labelledby":`secheader${i.Id}`,id:`seccollapse${i.Id}`}),n.find(".accordion-button").attr({"data-bs-target":`#seccollapse${i.Id}`,"aria-controls":`seccollapse${i.Id}`});var r=n.find(".accordion-body");$.each(i.children,(function(t,e){r.append(`<a href="${e.routerName}" title="連結至：${e.title}" class="list-group-item list-group-item-action border-0 py-3">${e.title}</a>`)})),t.find(".accordion").append(n)}else{var o=`<div class="accordion-item border-0 border-bottom px-1"><a href="${i.routerName}" title="連結至：${i.title}" class="list-group-item border-0 py-3 custom_h5 text-black">${i.title}</a></div>`;t.find(".accordion").append(o)}})))})))}))}function DirectoryDataGet(t,e,a,i){Directory.getDirectoryData({Ids:[e],SiteId:"undefined"==typeof SiteId?0:SiteId,Page:a,ShowNum:i}).done((function(n){t.find(".page-item").each((function(){var t=$(this);t.hasClass("btn_prev")||t.hasClass("btn_next")||t.remove()})),n.totalPage<=1&&t.find(".page_btn").addClass("d-none");for(var r=1;r<=n.totalPage;r++)1==r?r==a?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black bg-secondary" data-page=${r}>第一頁</button></li>`):t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" data-page=${r}>第一頁</button></li>`):r==n.totalPage?r==a?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black bg-secondary" data-page=${r}>最後一頁</button></li>`):t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" data-page=${r}>最後一頁</button></li>`):(a<5&&r<7||a>n.totalPage-4&&r>n.totalPage-6||r>=a-2&&r<=a+2)&&(r==a?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black bg-secondary" data-page=${r}>${r}</button></li>`):t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" data-page=${r}>${r}</button></li>`));$(".btn_page").on("click",(function(){var n=$(this);a!=n.data("page")&&(t.find(".catalog").children().each((function(){var t=$(this);t.hasClass("templatecontent")||t.remove()})),a=n.data("page"),DirectoryDataGet(t,e,a,i))})),t.data("init")||($(".btn_prev > button").on("click",(function(){a>1&&(t.find(".catalog").children().each((function(){var t=$(this);t.hasClass("templatecontent")||t.remove()})),a--,DirectoryDataGet(t,e,a,i))})),$(".btn_next > button").on("click",(function(){a<n.totalPage&&(t.find(".catalog").children().each((function(){var t=$(this);t.hasClass("templatecontent")||t.remove()})),a++,DirectoryDataGet(t,e,a,i))}))),t.data("init","true"),DirectoryDataInsert(t,n.releInfos)}))}function DirectoryDataInsert(t,e){e.forEach((function(e){var a=$(t.find(".templatecontent").html()).clone();a.find("a").attr("href",window.location.pathname+e.link),a.find("a").attr("titile",`連結至: ${e.title}`);var i=e.mainImage;"undefined"!=typeof IsFaPage&&"undefined"!=typeof OrgName&&"True"!=IsFaPage&&(i=i.replace("upload",`upload/${OrgName}`)),a.find("img").attr("src",i),a.find("img").attr("alt",`${e.title}的主要圖片`),a.find(".title").text(e.title),a.find(".date").text(e.nodeDate),a.find(".description").text(e.description),t.find(".catalog").append(a)})),HoverEffectInit()}