var Directory={getDirectoryData:function(t){return $.ajax({url:"/api/Directory/GetReleInfo",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})},getDirectoryMenuData:function(t){return $.ajax({url:"/api/Directory/GetReleMenu",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})}};function DirectoryGetDataInit(){var t;$(".catalog_frame").each((function(){var e=$(this),a=e.attr("data-dirid")>0?e.attr("data-dirid"):0;void 0!==e.data("prevdirid")&&a==e.data("prevdirid")||(e.data("prevdirid",a),t=void 0!==e.data("shownum")?e.data("shownum"):12,1,DirectoryDataGet(e,a,1,t))})),$(".menu_directory").each((function(){var t=$(this),e=t.attr("data-dirid")>0?t.attr("data-dirid"):0;void 0!==t.data("prevdirid")&&e==t.data("prevdirid")||(t.data("prevdirid",e),t.find(".title").text(""),t.find(".accordion").empty(),Directory.getDirectoryMenuData({Id:e,WebsiteId:"undefined"!=typeof SiteId?SiteId:0}).done((function(e){void 0!==e&&(t.find(".title").text(e.title),$.each(e.children,(function(a,n){if(t.find(".title").text(e.title),null!=n.children){var i=$($("#TemplateAccordionItem").html()).clone();i.find(".sectitle").text(n.title),i.find(".accordion-header").attr("id",`secheader${n.Id}`),i.find(".accordion-collapse").attr({"aria-labelledby":`secheader${n.Id}`,id:`seccollapse${n.Id}`}),i.find(".accordion-button").attr({"data-bs-target":`#seccollapse${n.Id}`,"aria-controls":`seccollapse${n.Id}`});var r=i.find(".accordion-body");$.each(n.children,(function(t,e){r.append(`<a href="${e.routerName}" title="連結至：${e.title}" class="list-group-item list-group-item-action border-0 py-3">${e.title}</a>`)})),t.find(".accordion").append(i)}else{var o=`<div class="accordion-item border-0 border-bottom px-1"><a href="${n.routerName}" title="連結至：${n.title}" class="list-group-item border-0 py-3 custom_h5 text-black">${n.title}</a></div>`;t.find(".accordion").append(o)}})))})))}))}function DirectoryDataGet(t,e,a,n){Directory.getDirectoryData({Ids:[e],SiteId:"undefined"==typeof SiteId?0:SiteId,Page:a,ShowNum:n}).done((function(i){t.find(".page-item").each((function(){var t=$(this);t.hasClass("btn_prev")||t.hasClass("btn_next")||t.remove()})),i.totalPage<=1&&t.find(".page_btn").addClass("d-none");for(var r=1;r<=i.totalPage;r++)1==r?r==a?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black bg-secondary" data-page=${r}>第一頁</button></li>`):t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" data-page=${r}>第一頁</button></li>`):r==i.totalPage?r==a?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black bg-secondary" data-page=${r}>最後一頁</button></li>`):t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" data-page=${r}>最後一頁</button></li>`):(a<5&&r<7||a>i.totalPage-4&&r>i.totalPage-6||r>=a-2&&r<=a+2)&&(r==a?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black bg-secondary" data-page=${r}>${r}</button></li>`):t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" data-page=${r}>${r}</button></li>`));$(".btn_page").on("click",(function(){var i=$(this);a!=i.data("page")&&(t.find(".catalog").children().each((function(){var t=$(this);t.hasClass("templatecontent")||t.remove()})),a=i.data("page"),DirectoryDataGet(t,e,a,n))})),t.data("init")||($(".btn_prev > button").on("click",(function(){a>1&&(t.find(".catalog").children().each((function(){var t=$(this);t.hasClass("templatecontent")||t.remove()})),a--,DirectoryDataGet(t,e,a,n))})),$(".btn_next > button").on("click",(function(){a<i.totalPage&&(t.find(".catalog").children().each((function(){var t=$(this);t.hasClass("templatecontent")||t.remove()})),a++,DirectoryDataGet(t,e,a,n))}))),t.data("init","true"),DirectoryDataInsert(t,i.releInfos)}))}function DirectoryDataInsert(t,e){e.forEach((function(e){var a=$(t.find(".templatecontent").html()).clone();a.find("a").attr("href",window.location.pathname+e.link),a.find("a").attr("title",`連結至: ${e.title}`);var n=e.mainImage;if("undefined"!=typeof IsFaPage&&"undefined"!=typeof OrgName&&"True"!=IsFaPage&&(n=n.replace("upload",`upload/${OrgName}`)),a.find("img").attr("src",n),a.find("img").attr("alt",`${e.title}的主要圖片`),a.find(".title").text(e.title),a.find(".description").text(e.description),t.find(".catalog").append(a),null!=e.nodeDate&&""!=e.nodeDate){var i=new Date(e.nodeDate);a.find(".date").text(`${i.getFullYear()}/${i.getMonth()+1}/${i.getDate()}`)}})),HoverEffectInit()}