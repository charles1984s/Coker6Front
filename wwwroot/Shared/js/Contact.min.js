function setContact(){$(".ContactForm").contactInit()}document.addEventListener("DOMContentLoaded",(()=>{$.fn.extend({contactInit:function(){$(this).each((function(){$(this).setContact()}))},setContact:function(){const t=this.get(0),e=this,n=e.find('[name="captcha"]'),a=e.find(".img-fluid").last();$("#ContactForm .btn_refresh").off("click").on("click",(()=>{NewCaptcha(a,n,"ContactUs")})),$("#ContactForm .btn_refresh").trigger("click"),e.getFormJson(),t.addEventListener("submit",(o=>{if(o.preventDefault(),o.stopPropagation(),t.classList.add("was-validated"),t.checkValidity()){o.preventDefault();const t={Email:"",Name:""},i=e.find('[name="sender"]');if("SELECT"==i.get(0).tagName){const e=i.find("option:selected");t.Email=e.val(),t.Name=e.text()}else t.Email=i.val(),t.Name=i.data("title");if(""==t.Email)return void co.sweet.error("資料錯誤","請選擇寄件人");$.ajax({url:"/api/Contact/submit",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({sender:t,forms:e.getFormJson()}),dataType:"json",beforeSend:function(t){t.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(t){t.success?(Coker.sweet.success("成功送出表單！",null,!0),e.removeClass("was-validated"),e.get(0).reset()):Coker.sweet.error("發送失敗",t.error,null,!0),NewCaptcha(a,n,"ContactUs")}))}else NewCaptcha(a,n,"ContactUs"),Coker.sweet.error("錯誤","須確實填寫表單資料才可送出",null,!0)}),!1),document.addEventListener("keyup",(function(t){var e=t.target;if("INPUT"==e.nodeName&&e.value.length==e.maxLength){var n=$(e).parents("form").first().find("input");for(let t=0;t<n.length;t++)if(n[t]==e)return void(n[t+1]&&n[t+1].focus())}}))}})}));