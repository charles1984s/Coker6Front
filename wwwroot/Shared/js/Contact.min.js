function setContact(){$(".ContactForm").contactInit()}document.addEventListener("DOMContentLoaded",(()=>{$.fn.extend({contactInit:function(){$(this).each((function(){$(this).setContact()}))},setContact:function(){const e=this.get(0),t=this,n=t.find('[name="captcha"]'),a=t.find(".img-fluid").last();$("#ContactForm .btn_refresh").off("click").on("click",(()=>{NewCaptcha(a,n,"ContactUs")})),$("#ContactForm .btn_refresh").trigger("click"),t.getFormJson(),e.addEventListener("submit",(o=>{if(o.preventDefault(),o.stopPropagation(),e.classList.add("was-validated"),e.checkValidity()){o.preventDefault();const e={Email:"",Name:""},i=t.find('[name="sender"]');if("SELECT"==i.get(0).tagName){const t=i.find("option:selected");e.Email=t.val(),e.Name=t.text()}else e.Email=i.val(),e.Name=i.data("title");if(""==e.Email)return void co.sweet.error("資料錯誤","請選擇寄件人");$.ajax({url:"/api/Contact/submit",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({routerName:PageKey,sender:e,forms:t.getFormJson()}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(e){e.success?(Coker.sweet.success("成功送出表單！",null,!0),t.removeClass("was-validated"),t.get(0).reset()):Coker.sweet.error("發送失敗",e.error,null,!0),NewCaptcha(a,n,"ContactUs")}))}else NewCaptcha(a,n,"ContactUs"),Coker.sweet.error("錯誤","須確實填寫表單資料才可送出",null,!0)}),!1),document.addEventListener("keyup",(function(e){var t=e.target;if("INPUT"==t.nodeName&&t.value.length==t.maxLength){var n=$(t).parents("form").first().find("input");for(let e=0;e<n.length;e++)if(n[e]==t)return void(n[e+1]&&n[e+1].focus())}}))}})}));