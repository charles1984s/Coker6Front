function MarqueeSwiper(e){var t=function(e,t){return $.ajax({url:"/api/Marquee/GetAll",type:"GET",data:{webid:e,placement:t},contentType:"application/json; charset=utf-8",dataType:"json"})};$(".marqueeSwiper").each((function(){$(this);$(this).find(".swiper-wrapper").find(".swiper-slide").each((function(){const e=$(this).width();let t=$(this);const n=t.find(".text").css("font-size");let i=[],l=t.text().replace("(current)",""),r=$('<div class="temp-div"></div>').appendTo("body");r.css("width",e+"px"),r.css("font-size",n);let a=r.height();for(let e=0;e<l.length;e++){r.append(l[e]);let t=r.height();t>a&&(i.push(e),a=t)}for(let e=0;e<i.length;e++){let n=i[e],r=e===i.length-1?l.length:i[e+1],a=t.clone();a.find(".text").text(l.substring(n,r)),t.before(a)}t.remove(),r.remove()}))}));new Swiper(".marqueeSwiper",{a11y:!0,direction:"vertical",allowTouchMove:!1,keyboard:{enabled:!0},autoplay:{delay:3e3}});t(void 0===e?0:e,"Top").done((function(e){const t=e.map((function(e){return{title:e.title,link:e.link,target:e.target}}));if("undefined"==typeof marqueeContainer)return;marqueeContainer.innerHTML="",t.forEach((e=>{const t=document.createElement("div");let n;if(t.classList.add("swiper-slide"),e.link){const t=e.target?"_blank":"_self";n=`\n                    <a class="overflow-hidden text" data-bs-toggle="tooltip" title="${e.target?`連結至：${e.title}(另開視窗)`:`連結至：${e.title}`}" href="${e.link}" target="${t}">\n                        ${e.title}\n                    </a>\n                `}else n=`\n                    <div class="overflow-hidden text" data-bs-toggle="tooltip" title="${e.title}">\n                        ${e.title}\n                    </div>\n                `;t.innerHTML=n,$marquee.append(t)})),$marquee.find(".swiper-slide").each((function(){const e=$(this).width();let t=$(this);const n=t.find(".text").css("font-size");let i=[],l=t.text().replace("(current)",""),r=$('<div class="temp-div"></div>').appendTo("body");r.css("width",e+"px"),r.css("font-size",n);let a=r.height();for(let e=0;e<l.length;e++){r.append(l[e]);let t=r.height();t>a&&(i.push(e),a=t)}for(let e=0;e<i.length;e++){let n=i[e],r=e===i.length-1?l.length:i[e+1],a=t.clone();a.find(".text").text(l.substring(n,r)),t.before(a)}t.remove(),r.remove()}));var n=new Swiper(".marqueeSwiper",{direction:"vertical",allowTouchMove:!1,keyboard:{enabled:!0},autoplay:{delay:3e3}});const i=function(){"function"==typeof $(".marqueeSwiper").swiperBindEven?$(".marqueeSwiper").swiperBindEven(n):setTimeout(i,300)};i()}))}