function MarqueeSwiper(e){var t=function(e,t){return $.ajax({url:"/api/Marquee/GetAll",type:"GET",data:{webid:e,placement:t},contentType:"application/json; charset=utf-8",dataType:"json"})};$(".marqueeSwiper").each((function(){$(this);$(this).find(".swiper-wrapper").find(".swiper-slide").each((function(){const e=$(this).width();let t=$(this);const i=t.find(".text").css("font-size");let n=[],l=t.text().replace("(current)",""),r=$('<div class="temp-div"></div>').appendTo("body");r.css("width",e+"px"),r.css("font-size",i);let o=r.height();for(let e=0;e<l.length;e++){r.append(l[e]);let t=r.height();t>o&&(n.push(e),o=t)}for(let e=0;e<n.length;e++){let i=n[e],r=e===n.length-1?l.length:n[e+1],o=t.clone();o.find(".text").text(l.substring(i,r)),t.before(o)}t.remove(),r.remove()}))}));new Swiper(".marqueeSwiper",{a11y:!0,direction:"vertical",allowTouchMove:!1,keyboard:{enabled:!0},autoplay:{delay:3e3}});t(void 0===e?0:e,"Top").done((function(e){const t=$(".marqueeSwiper"),i=t.find(".swiper-wrapper"),n=e.map((function(e){return{title:e.title,link:e.link,target:e.target}}));if(void 0===t)return;t.innerHTML="",n.forEach((e=>{const t=document.createElement("div");let n;if(t.classList.add("swiper-slide"),e.link){const t=e.target?"_blank":"_self";n=`\n                    <a class="overflow-hidden text" data-bs-toggle="tooltip" title='${e.target?`連結至：${e.title}(另開視窗)`:`連結至：${e.title}`}' href='${e.link}' target="${t}">\n                        ${e.title}\n                    </a>\n                `}else n=`\n                    <div class="overflow-hidden text" data-bs-toggle="tooltip" title="${e.title}">\n                        ${e.title}\n                    </div>\n                `;t.innerHTML=n,i.append(t)})),i.find(".swiper-slide").each((function(){const e=$(this).width();let t=$(this);const i=t.find(".text").css("font-size");let n=[],l=t.text().replace("(current)",""),r=$('<div class="temp-div"></div>').appendTo("body");r.css("width",e+"px"),r.css("font-size",i);let o=r.height();for(let e=0;e<l.length;e++){r.append(l[e]);let t=r.height();t>o&&(n.push(e),o=t)}for(let e=0;e<n.length;e++){let i=n[e],r=e===n.length-1?l.length:n[e+1],o=t.clone();o.find(".text").text(l.substring(i,r)),t.before(o)}t.remove(),r.remove()}));var l=new Swiper(".marqueeSwiper",{direction:"vertical",allowTouchMove:!1,keyboard:{enabled:!0},autoplay:{delay:3e3}});const r=function(){"function"==typeof $(".marqueeSwiper").swiperBindEven?$(".marqueeSwiper").swiperBindEven(l):setTimeout(r,300)};r()}))}