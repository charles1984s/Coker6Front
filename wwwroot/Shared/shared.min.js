function AnchorPointInit(){$(".anchor_directory").each((function(){var t=$(this);t.children("ul").empty(),$(".anchor_title").each((function(){var n=$(this),e=n.text().indexOf("\n")>-1?n.text().substr(0,n.text().indexOf("\n")):n.text();t.children("ul").append(`<li class="fs-5"><a class="text-black text-decoration-none" href="#${n.attr("id")}"><div class="p-2 px-4">${e}</div></a></li>`),n.bind("DOMNodeInserted",(function(){AnchorPointInit()}))})),t.children('a[href^="#"]').click((function(t){var n=$(this).attr("href"),e=$(n).offset().top-50;$("html, body").animate({scrollTop:e},0),t.preventDefault()}))}))}
var Directory={getDirectoryData:function(t){return $.ajax({url:"/api/Directory/GetReleInfo",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})},getDirectoryMenuData:function(t){return $.ajax({url:"/api/Directory/GetReleMenu",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})}};function initElemntAndLoadDir(t,e){const a=t||$(".catalog_frame,.menu_directory").first(),n=a.attr("data-dirid")>0?a.attr("data-dirid"):0;a.data("prevdirid",n);const i=void 0!==a.data("shownum")?a.data("shownum"):12,o=void 0!==a.data("maxlen")?a.data("maxlen"):0,d=e?e.toString():location.hash.replace("#","");void 0!==a.data("page")&&a.data("page")==d||(e=isNaN(d)||""==d?"1":d,a.find(".catalog>.template").remove(),DirectoryDataGet(a,{Ids:[n],SiteId:"undefined"==typeof SiteId?0:SiteId,Page:e,ShowNum:i,MaxLen:void 0===o?0:o}),a.data("page",e))}function DirectoryGetDataInit(){const t=$(".catalog_frame,.menu_directory").length;$(".catalog_frame").each((function(){const t=$(this),e=t.attr("data-dirid")>0?t.attr("data-dirid"):0;void 0!==t.data("prevdirid")&&e==t.data("prevdirid")||initElemntAndLoadDir($(this))})),$(".menu_directory").each((function(){var t=$(this),e=t.attr("data-dirid")>0?t.attr("data-dirid"):0;void 0!==t.data("prevdirid")&&e==t.data("prevdirid")||(t.data("prevdirid",e),t.find(".title").text(""),t.find(".accordion").empty(),Directory.getDirectoryMenuData({Id:e,WebsiteId:"undefined"!=typeof SiteId?SiteId:0}).done((function(e){void 0!==e&&(t.find(".title").text(e.title),$.each(e.children,(function(a,n){if(t.find(".title").text(e.title),null!=n.children){var i=$($("#TemplateAccordionItem").html()).clone();i.find(".sectitle").text(n.title),i.find(".accordion-header").attr("id",`secheader${n.Id}`),i.find(".accordion-collapse").attr({"aria-labelledby":`secheader${n.Id}`,id:`seccollapse${n.Id}`}),i.find(".accordion-button").attr({"data-bs-target":`#seccollapse${n.Id}`,"aria-controls":`seccollapse${n.Id}`});var o=i.find(".accordion-body");$.each(n.children,(function(t,e){o.append(`<a href="${e.routerName}" title="連結至：${e.title}" class="list-group-item list-group-item-action border-0 py-3">${e.title}</a>`)})),t.find(".accordion").append(i)}else{var d=`<div class="accordion-item border-0 border-bottom px-1"><a href="${n.routerName}" title="連結至：${n.title}" class="list-group-item border-0 py-3 custom_h5 text-black">${n.title}</a></div>`;t.find(".accordion").append(d)}})))})))})),1==t&&("onhashchange"in window?window.onhashchange=hashChangeDirectory:setInterval(hashChangeDirectory,1e3))}function hashChangeDirectory(t){t?(initElemntAndLoadDir(),t.preventDefault()):console.log("HashChange錯誤")}function DirectoryDataGet(t,e){const a=$(".catalog_frame,.menu_directory").length;let n=parseInt(e.Page);"search"==t.data("type")&&$.extend(!0,e,{Type:"search",SearchText:t.data("search-text").toString(),StartDate:t.data("startDate"),EndDate:t.data("endDate")}),Directory.getDirectoryData(e).done((function(i){let o=2;"search"==e.Type&&$(".searchCount").text(i.totalCount),t.find(".page-item").each((function(){var t=$(this);t.hasClass("btn_prev")||t.hasClass("btn_next")||t.remove()})),i.totalPage<=1?t.find(".page_btn").addClass("d-none"):t.find(".page_btn").removeClass("d-none"),n>i.totalPage?n=i.totalPage:n<1&&(n=1),1==n?t.find(".btn_prev").addClass("d-none"):t.find(".btn_prev").removeClass("d-none"),n==i.totalPage?t.find(".btn_next").addClass("d-none"):t.find(".btn_next").removeClass("d-none"),1!=n&&n!=i.totalPage||(o=4);for(var d=1;d<=i.totalPage;d++)1==d?d==n?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>1</span></li>`):(t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="第一頁" data-page=${d}>1</button></li>`),n-o-1>0&&t.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>')):d==i.totalPage?d==n?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>${i.totalPage}</span></li>`):(n+o+1<i.totalPage&&t.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>'),t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="最後一頁" data-page=${d}>${i.totalPage}</button></li>`)):d>=n-o&&d<=n+o&&(d==n?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>${d}</span></li>`):t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="移動至第${d}頁" data-page=${d}>${d}</button></li>`));$(".btn_page").off("click").on("click",(function(){var e=$(this);n!=e.data("page")&&(n=e.data("page"),1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(t,n)),t.goTo()})),t.data("init")||(t.find(".btn_prev > button").on("click",(function(){n=parseInt(t.data("page"))-1,n>=1&&(1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(t,$self.data("page"))),t.goTo()})),t.find(".btn_next > button").on("click",(function(){n=parseInt(t.data("page"))+1,n<=i.totalPage&&(1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(t,$self.data("page"))),t.goTo()}))),t.data("init","true"),DirectoryDataInsert(t,i.releInfos)}))}function DirectoryDataInsert(t,e){if(null==e)return;const a=t.find(".templatecontent").html(),n="search"==t.data("type");0==e.length?t.find(".catalog").addClass("empty"):t.find(".catalog").removeClass("empty"),null!=e&&e.forEach((function(e){var i=$(a).clone();let o,d;if(n){if(3===e.type)o=`${null==e.orgName?"":`/${e.orgName}`}/${e.link}/${t.data("search-text")}`;else o=`${null==e.orgName?"":`/${e.orgName}`}/search/${e.link}/${t.data("search-text")}`;if(d="_blank",e.mainImage.indexOf("youtu")>0){var r="",l=e.mainImage.match(/^.*(?:(?:youtu.be\/|v\/|vi\/|u\/w\/|embed\/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*/);null!=l&&l.length>0&&(r=l[1]),e.mainImage="https://img.youtube.com/vi/"+r+"/mqdefault.jpg"}}else o=(window.location.pathname.indexOf(e.orgName)>0?window.location.pathname:`${null==e.orgName?"":`/${e.orgName}`}${window.location.pathname}`)+e.link,d="_self";o=o.replace("//","/");const c={href:o,title:`連結至: ${e.title}${"_blank"==d?"(另開視窗)":""}`,target:d};"A"==i[0].tagName?i.attr(c):i.find("a").attr(c);var s=e.mainImage||"/images/noImg.jpg";if(null!=e.orgName&&("undefined"!=typeof IsFaPage&&"undefined"!=typeof OrgName&&"True"!=IsFaPage||"undefined"!=typeof OrgName&&OrgName!=e.orgName)&&(s=s.replace("upload",`upload/${e.orgName}`)),i.find("img").attr("src",s),i.find("img").attr("alt",`${e.title}的主要圖片`),i.find(".title").text(e.title),i.find(".description").html(e.description),t.find(".catalog").append(i),i.find(".location").length>0&&(null==e.location||""==e.location)?i.find(".location").parents(".py-2").remove():i.find(".location").text(e.location),i.find(".address").length>0&&(null==e.address||""==e.address)?i.find(".address").parents(".py-2").remove():i.find(".address").text(e.address),null!=e.startTime&&""!=e.startTime){var g=new Date(e.startTime);i.find(".startTime").text(`${g.getFullYear()}/${g.getMonth()+1}/${g.getDate()}`)}if(null!=e.nodeDate&&""!=e.nodeDate){var p=new Date(e.nodeDate);i.find(".date").text(`${p.getFullYear()}/${p.getMonth()+1}/${p.getDate()}`),i.find(".date-month").text(`${p.getMonth()+1}月`),i.find(".date-monthyear").text(`${p.getMonth()+1}/${p.getFullYear()}`),p.getDate()<10?i.find(".date-day").text(`0${p.getDate()}`):i.find(".date-day").text(`${p.getDate()}`)}})),HoverEffectInit()}
function FrameInit(){$(".masonry").each((function(){var i=$(this);if(!i.data("isInit")){$(this).find(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-item"});i.data("isInit",!0)}}))}
function HoverEffectInit(){$(".hover_mask").each((function(){$(this).find(".hover_protrude_scale").each((function(){var i=$(this);i.hover((function(){i.siblings().each((function(){$(this).addClass("opacity-50")}))}),(function(){i.siblings().each((function(){$(this).removeClass("opacity-50")}))}))}))})),$(".black-bg .close").click((function(){$(".black-bg").fadeOut(500)})),$("#swiper1, #swiper2, #swiper3, #swiper4, #swiper5, #swiper6, #swiper7, #swiper8").click((function(){$(".black-bg").fadeIn(500)}))}function withebg(){$(".qual-width-images").mouseover((function(){var i=$(this).attr("id").substr(3);$(".image-overlay").not("#overlay"+i).css("display","block")})),$(".qual-width-images").mouseout((function(){$(".image-overlay").css("display","none")}))}
function LinkWithIconInit(){$(".link_with_icon").each((function(){var a=$(this),i=a.attr("href");if(a.find(".icon").empty(),void 0!==i){var e=i.substring(i.lastIndexOf(".")+1,i.length);switch(e){case"jpg":case"jpeg":case"png":case"gif":a.find(".icon").append('<i class="fa-solid fa-file-image" style="color: #ff9500;"></i>');break;case"pdf":a.find(".icon").append('<i class="fa-solid fa-file-pdf" style="color: #b30b00;"></i>');break;case"doc":case"docx":case"odt":a.find(".icon").append('<i class="fa-solid fa-file-word" style="color: #2c599d;"></i>');break;case"ppt":case"pptx":case"odp":a.find(".icon").append('<i class="fa-solid fa-file-powerpoint" style="color: #D04323;"></i>');case"xls":case"xlsx":case"ods":a.find(".icon").append('<i class="fa-solid fa-file-excel" style="color: #037945;"></i>');break;case"zip":case"rar":a.find(".icon").append('<i class="fa-solid fa-file-zipper"></i>');break;default:a.find(".icon").append('<i class="fa-solid fa-file" style="color: #999999;"></i>')}}void 0===a.attr("download")&&a.attr("download","未命名"),a.find(".name").text(a.attr("download")),new RegExp(`${e}$`,"gi").test(a.attr("download"))?a.attr("download",`${a.attr("download")}`):a.attr("download",`${a.attr("download")}.${e}`),a.attr("title",`${a.attr("download")}(另開新視窗)`)}))}
function ShareBlockInit(){$(".shareBlock").each((function(){void 0!==$(this).data("init")&&$(this).data("init")||($(this).cShare({description:"jQuery plugin - C Share buttons...",showButtons:["email","plurk","twitter","fb","line"]}),$(this).data("init",!0))}))}
function SitemapInit(){var e=function(e){return $.ajax({url:"/api/WebMenu/GetAll/",type:"GET",contentType:"application/json; charset=utf-8",data:{WebsiteID:e}})};"undefined"!=typeof SiteId?e(SiteId).done((function(e){CreateSitemap(e.maps)})):e(null).done((function(e){CreateSitemap(e.maps)}))}function CreateSitemap(e){var t=$(".sitemap_hierarchical_frame");t.append('<ul class=""></ul>');var a=1;e.forEach((function(e){var n=$($("#Hierarchical_First_Item").html()).clone(),l=n.find(".first");if(null!=e.children){l.text(`${a} ${e.title}`),n.append('<ul class="ps-5 ps-md-0 col-md-8 py-1"></ul>');var i=n.find("ul"),r=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Second_Item").html()).clone(),n=t.find(".second");if(n.attr("href",e.routerName),n.attr("alt",e.text),null!=e.children){n.removeClass("ps-4 ps-sm-3"),n.append(`<span class="d-flex d-md-none material-symbols-outlined position-absolute start-0">expand_more</span><span class="second p-sm-0 ps-2">${a}-${r} ${e.title}</span><span class="d-none d-md-flex material-symbols-outlined">navigate_next</span>`),t.append('<ul class="ps-5 ps-md-0 col-md-6"></ul>');var l=t.find("ul"),s=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Third_Item").html()).clone(),n=t.find(".third");n.attr("href",`${e.routerName}`),n.attr("alt",e.text),n.text(`${a}-${r}-${s} ${e.title}`),l.append(t),s++}))}else n.text(`${a}-${r} ${e.title}`);i.append(t),r++}))}else l.parent("div").parent("div").html(`<a class="first d-block text-black px-3 rounded-3" href="${e.routerName}" alt="${e.text}">${a} ${e.title}</a>`);t.append(n),a++}))}
function SwiperInit(e){var i={slidesPerView:1,spaceBetween:15};if($.fn.extend({swiperBindEven:function(e){const i=function(){e.autoplay.stop()},t=function(){e.autoplay.start()};$(this).find(".swiper").prepend($(this).find(".swiper_button_prev")),$(this).on("mouseover",i),$(this).find("a").on("focus",i),$(this).on("mouseout",t),$(this).find("a").on("blob",t),$(this).find("button").prop("disabled",!1)}}),$(".one_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var n="#"+t.attr("id")+" > .swiper";const p=$(n).find(".swiper-slide").length>2;var a=!!e.autoplay&&p,r=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0}},a?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{},p?{navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"}}:{});p||$(`#${t.attr("id")}`).find(".swiper_button_next,.swiper_button_prev").remove();var s=new Swiper(n,r);t.data("isInit",!0),a&&s.slides.length-2>1&&t.swiperBindEven(s)}})),$(".two_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var n="#"+t.attr("id")+" > .swiper",a=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0,renderBullet:function(e,i){return t.has(".swiper_pagination_water").length?'<span class="'+i+' material-symbols-outlined ms-3">water_drop</span>':'<span class="'+i+'"></span>'}},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{400:{slidesPerView:1},1024:{slidesPerView:2}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),r=new Swiper(n,a);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(r),t.prepend($("#"+t.attr("id")+" .swiper_button_prev")),console.log(a)}})),$(".four_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var n="#"+t.attr("id")+" > .swiper",a=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper-pagination",clickable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{375:{slidesPerView:1},576:{slidesPerView:3},769:{slidesPerView:4}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),r=new Swiper(n,a);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(r),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".six_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var n="#"+t.attr("id")+" > .swiper",a=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},scrollbar:{el:".swiper-scrollbar",draggable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{320:{slidesPerView:2},375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:6}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),r=new Swiper(n,a);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(r),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".picture-category").length>0&&$("#SwiperModal").length>0){const e=new Swiper("#pictureSwiperThumbs",{spaceBetween:10,breakpoints:{375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:6}},freeMode:!0,watchSlidesProgress:!0}),i=new Swiper("#pictureSwiper",{centeredSlides:!0,spaceBetween:10,navigation:{nextEl:"#pictureSwiper .swiper-button-next",prevEl:"#pictureSwiper .swiper-button-prev"},pagination:{el:"#pictureSwiper .swiper-pagination"},thumbs:{swiper:e}});$(".picture-category a").attr("href","#SwiperModal").on("click",(function(){const t=$(this).parents(".picture-category"),n=$(".picture-category a").index(this),a=[];t.find(".templatecontent img").each((function(){a.push($(this).attr("src"))})),i.removeAllSlides(),e.removeAllSlides();for(let t=0;t<a.length;t++){const n=`<div class="swiper-slide"><img src="${a[t]}" alt=" " /></div>`;i.appendSlide(n),e.appendSlide(n)}return i.slideTo(n,0),e.slideTo(n,0),$("#SwiperModal").modal("show"),!1}))}}
function ViewTypeChangeInit(){$(".type_change_frame").each((function(){var e=$(this);if(!e.data("isInit")){const d=e.find(".btn_grid"),a=e.find(".btn_list"),s=e.find(".btn_text"),n=e.find(".content").first();d.on("click",(function(){d.data("activate")||typeChange(d,a,s,n,"Grid")})),a.on("click",(function(){a.data("activate")||typeChange(a,d,s,n,"List")})),s.on("click",(function(){s.data("activate")||typeChange(s,a,d,n,"Text")})),d.hasClass("d-none")&&!a.hasClass("d-none")&&a.trigger("click"),d.hasClass("d-none")&&a.hasClass("d-none")&&!s.hasClass("d-none")&&s.trigger("click"),e.find(".btn_grid.d-none,.btn_list.d-none,.btn_text.d-none").length>=2?e.find(".switch_control").addClass("d-none"):e.find(".switch_control").removeClass("d-none")}e.data("isInit",!0)}))}function typeChange(e,d,a,s,n){switch(e.data("activate",1),e.removeClass("text-black-50"),d.data("activate",0),d.addClass("text-black-50"),a.data("activate",0),a.addClass("text-black-50"),n){case"List":s.each((function(){var e=$(this);e.addClass("type3").removeClass("type1 type2"),e.removeClass("row row-cols-sm-4"),e.find("figure").removeClass("flex-column"),e.find(".image_frame").removeClass("w-100"),e.find(".image_frame").removeClass("d-none"),e.find(".image").addClass("px-0"),e.find(".image").removeClass("d-none"),e.find(".max-h").addClass("max-hei"),e.find("figcaption").addClass("flex-grow-1 p-3 py-0 py-md-3"),e.find(".description").removeClass("d-none"),e.find(".more").removeClass("d-none"),e.find(".date").removeClass("d-none"),e.find(".box-shadow").removeClass("h_100"),e.find(".box-shadow").removeClass("text-border"),e.find(".box-shadow").addClass("type3").removeClass("type2 type1"),e.find(".box-shadow").addClass("p-1").removeClass("p-3"),e.find(".card-border").removeClass("h_100"),e.find(".hover_protrude_scale").removeClass("text-border"),e.find(".card-border").addClass("type3").removeClass("type2 type1"),e.find(".card-border").addClass("card-border-rd"),e.find(".more-btn").addClass("d-none"),e.find(".related-tag").removeClass("d-none"),e.find(".card-border").removeClass("pr3").addClass("p-3"),e.find(".imgh").addClass("img-h"),e.find(".mergetag").addClass("merge"),e.find(".check_btn").removeClass("w-100").addClass("check_btn-type3"),e.find(".search-more").removeClass("d-none"),e.find(".description").addClass("type3-content").removeClass("type2-content"),e.find(".image_frame").addClass("h-100"),e.find(".title").removeClass("type2-title pr3 text-center h-100").addClass("type1-title  fw-bold"),e.find("figcaption").addClass("pb1")}));break;case"Grid":s.each((function(){var e=$(this);e.addClass("type2").removeClass("type1 type3"),e.addClass("row row-cols-sm-4"),e.find("figure").addClass("flex-column"),e.find(".image_frame").addClass("w-100"),e.find(".image_frame").removeClass("d-none"),e.find(".image").removeClass("px-0"),e.find(".image").removeClass("d-none"),e.find("figcaption").removeClass("flex-grow-1 p-3 py-0 py-md-3"),e.find(".description").addClass("d-none"),e.find(".more").addClass("d-none"),e.find(".date").addClass("d-none"),e.find(".more-btn").addClass("d-none"),e.find(".box-shadow").removeClass("h_100"),e.find(".box-shadow").removeClass("text-border"),e.find(".box-shadow").addClass("type2").removeClass("type1 type3"),e.find(".box-shadow").addClass("p-1").removeClass("p-3"),e.find(".card-border").addClass("type2").removeClass("type1 type3"),e.find(".card-border").removeClass("h_100"),e.find(".card-border").addClass("card-border-rd"),e.find(".card-border").removeClass("pr3").addClass("p-3"),e.find(".related-tag").removeClass("d-none"),e.find(".imgh").removeClass("img-h"),e.find(".mergetag").removeClass("merge"),e.find(".check_btn").addClass("w-100").removeClass("check_btn-type3"),e.find(".search-more").removeClass("d-none"),e.find(".title").removeClass("p-2 pr3"),e.find(".description").addClass("type2-content").removeClass("type3-content"),e.find(".image_frame").removeClass("h-100"),e.find(".title").removeClass("h-100 text-center type2-title").addClass("type1-title fw-bold p-2"),e.find("figcaption").addClass("pb1")}));break;case"Text":s.each((function(){var e=$(this);e.addClass("type2").removeClass("type2 type3"),e.addClass("row row-cols-sm-4"),e.find("figure").addClass("flex-column"),e.find(".image_frame").removeClass("w-100 "),e.find(".image_frame").addClass("d-none"),e.find(".image").removeClass("px-0"),e.find(".image").addClass("d-none"),e.find(".max-h").removeClass("max-hei"),e.find("figcaption").removeClass("flex-grow-1 p-3 py-0 py-md-3"),e.find(".description").addClass("d-none"),e.find(".date").addClass("d-none"),e.find(".more").addClass("d-none"),e.find(".more-btn").removeClass("d-none"),e.find(".title").addClass("pr3").removeClass("p-2"),e.find(".box-shadow").removeClass("h_100"),e.find(".box-shadow").addClass("text-border"),e.find(".box-shadow").addClass("type1").removeClass("type2 type3"),e.find(".box-shadow").addClass("p-1").removeClass("p-3"),e.find(".related-tag").addClass("d-none"),e.find(".card-border").removeClass("h_100"),e.find(".card-border").addClass("type1").removeClass("type2 type3"),e.find(".card-border").removeClass("card-border-rd"),e.find(".card-border").removeClass("p-3").addClass("pr3"),e.find(".imgh").removeClass("img-h"),e.find(".mergetag").removeClass("merge "),e.find(".check_btn").addClass("w-100").removeClass("check_btn-type3"),e.find(".search-more").addClass("d-none"),e.find(".image_frame").removeClass("h-100"),e.find(".title").removeClass("type1-title fw-bold text-center p-2").addClass("type2-title h-100"),e.find("figcaption").removeClass("pb1")}))}}
function date_input_change(t){var a=$(`#${t}`),n=a.attr("date-date-strat-date"),e=a.attr("data-date-end"),d=a.attr("data-location"),i=a.attr("data-addr"),s=a.attr("data-organizer"),r=a.attr("data-a-organizer"),o=a.attr("data-link"),l=a.attr("data-tel"),v=a.find(".activity_start_time").parents("div").eq(1);""==n&&""==e?$(v).addClass("d-none"):$(v).removeClass("d-none");var f=a.find(".activity_location").parents("div").eq(0);""==d?$(f).addClass("d-none"):($(f).find("a").attr({href:`https://maps.google.com.tw/maps?f=q&hl=zh-TW&geocode=&q=${d}&z=16&output=embed&t=`,title:`連結至：${d}(另開新視窗)`,target:"_blank"}),$(f).removeClass("d-none"));var c=a.find(".activity_addr").parents("div").eq(0);""==i?$(c).addClass("d-none"):($(c).find("a").attr({href:`https://maps.google.com.tw/maps?f=q&hl=zh-TW&geocode=&q=${i}&z=16&output=embed&t=`,title:`連結至：${i}(另開新視窗)`,target:"_blank"}),$(c).removeClass("d-none"));var m=a.find(".activity-organizer").parent("div").eq(0);""==s?$(m).addClass("d-none"):$(m).removeClass("d-none");var h=a.find(".activity-a-organizer").parent("div").eq(0);""==r?$(h).addClass("d-none"):$(h).removeClass("d-none");var C=a.find(".activity_link").parents("div").eq(0);""==o?$(C).addClass("d-none"):$(C).removeClass("d-none");var _=a.find(".activity_tel").parents("div").eq(0);return""==l?$(_).addClass("d-none"):$(_).removeClass("d-none"),a.find(".activity_start_time").html(n),a.find(".activity_end_time").html(e),a.find(".activity_location").html(d),a.find(".activity_addr").html(i),a.find(".activity-organizer").html(s),a.find(".activity-a-organizer").html(r),a.find(".activity_link").html(o),a.find(".activity_tel").html(l),a.html()}function namecontrol(t){const a=$("#"+t),n=a.find(".btn_text"),e=a.find(".btn_grid"),d=a.find(".btn_list"),i=a.parents(".type_change_frame").first().find(".content").first();n.hasClass("d-none")?n.hasClass("d-none")&&!e.hasClass("d-none")?typeChange(e,d,n,i,"Grid"):n.hasClass("d-none")&&e.hasClass("d-none")&&!d.hasClass("d-none")&&typeChange(d,e,n,i,"List"):typeChange(n,e,d,i,"Text")}
function setContact(){$(".ContactForm").contactInit()}document.addEventListener("DOMContentLoaded",(()=>{$.fn.extend({contactInit:function(){$(this).each((function(){$(this).setContact()}))},setContact:function(){const t=this.get(0),e=this,n=e.find('[name="captcha"]'),a=e.find(".img-fluid").last();$("#ContactForm .btn_refresh").off("click").on("click",(()=>{NewCaptcha(a,n,"ContactUs")})),$("#ContactForm .btn_refresh").trigger("click"),e.getFormJson(),t.addEventListener("submit",(o=>{if(o.preventDefault(),o.stopPropagation(),t.classList.add("was-validated"),t.checkValidity()){o.preventDefault();const t={Email:"",Name:""},i=e.find('[name="sender"]');if("SELECT"==i.get(0).tagName){const e=i.find("option:selected");t.Email=e.val(),t.Name=e.text()}else t.Email=i.val(),t.Name=i.data("title");if(""==t.Email)return void co.sweet.error("資料錯誤","請選擇寄件人");$.ajax({url:"/api/Contact/submit",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({sender:t,forms:e.getFormJson()}),dataType:"json",beforeSend:function(t){t.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(t){t.success?(Coker.sweet.success("成功送出表單！",null,!0),e.removeClass("was-validated"),e.get(0).reset()):Coker.sweet.error("發送失敗",t.error,null,!0),NewCaptcha(a,n,"ContactUs")}))}else NewCaptcha(a,n,"ContactUs"),Coker.sweet.error("錯誤","須確實填寫表單資料才可送出",null,!0)}),!1),document.addEventListener("keyup",(function(t){var e=t.target;if("INPUT"==e.nodeName&&e.value.length==e.maxLength){var n=$(e).parents("form").first().find("input");for(let t=0;t<n.length;t++)if(n[t]==e)return void(n[t+1]&&n[t+1].focus())}}))}})}));
"use strict";const setBGCanvas=function(){const t=[1,1.1,1.8],n=[.8,1.1,2.2],i=[.9,1.1,2],e=[.9,1.1,1.5];let a=null;$.fn.extend({BGCanvas:function(){const t=$(this),n=function(){if(!isNaN(t.data("type"))&&1===parseInt(t.data("type")))t.BGCanvasType1()};return 0==t.height()?t.find("img").on("load",(function(){console.log("in"),n()})):n(),t},BGCanvasType1:function(){let s=$(this),o=$(this);if(0!=s.length&&"canvas"!=s.get(0).tagName.toLowerCase()&&0==s.find("canvas").length&&(o=$("<canvas>"),s.append(o)),0==s.length)return s;var h,r,l,c=45,d=.25;const{sin:g,cos:f,PI:u,sqrt:v,random:w,floor:y,ceil:p,round:C,abs:x}=Math;return function(){var v=o.get(0),y=v.getContext("2d");function p(){a=window.innerWidth>1500?t:window.innerWidth>1200?n:window.innerWidth>768?i:e,h=s.width()*a[0],r=s.height()*a[0],console.log(s.height()),v.width=h,v.height=r,l=(h<r?h:r)/2,y.fillStyle="rgba(245,251,251,0)",y.fillRect(0,0,h,r)}function x(){this.ang=2*u*w(),this.dang=(-.5+w())/10,this.r=2*l/a[2],this.x=h/2+this.r*f(this.ang),this.y=r/2+a[1]*this.r*g(this.ang),this.update=function(){this.ang+=this.dang,this.x=h/2+this.r*f(this.ang),this.y=r/2+a[1]*this.r*g(this.ang)}}p(),window.onresize=p;var $=[];for(let t=0;t<18;t++)$.push(new x);!function t(){y.fillStyle="rgba(255,255,255,0.03)",y.fillRect(0,0,h,r),y.beginPath(),y.moveTo(($[0].x+$[17].x)/2,($[0].y+$[17].y)/2);for(let t=0;t<18;t++){let n=t+1;18==n&&(n=0),y.quadraticCurveTo($[t].x,$[t].y,($[t].x+$[n].x)/2,($[t].y+$[n].y)/2),$[t].update()}y.strokeStyle=`hsl(${C(180+c)}deg, 100%, 70%)`,y.lineWidth=2*l/432,y.stroke(),y.shadowColor="transparent",((c+=d)>=100||c<=45)&&(d=-d),45==c&&(y.fillStyle="rgba(0,0,0,0)",y.fillRect(0,0,h,r)),window.requestAnimationFrame(t)}()}(),s}}),co.isMobileDevice()||$(".BGCanvas").BGCanvas()};