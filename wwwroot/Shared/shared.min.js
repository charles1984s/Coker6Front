function AnchorPointInit(){$(".anchor_directory").each((function(){var t=$(this);t.children("ul").empty(),$(".anchor_title").each((function(){var n=$(this),e=n.text().indexOf("\n")>-1?n.text().substr(0,n.text().indexOf("\n")):n.text();t.children("ul").append(`<li class="fs-5"><a class="text-black text-decoration-none" href="#${n.attr("id")}"><div class="p-2 px-4">${e}</div></a></li>`),n.bind("DOMNodeInserted",(function(){AnchorPointInit()}))})),t.children('a[href^="#"]').click((function(t){var n=$(this).attr("href"),e=$(n).offset().top-50;$("html, body").animate({scrollTop:e},0),t.preventDefault()}))}))}
var Directory={getDirectoryData:function(t){return $.ajax({url:"/api/Directory/GetReleInfo",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})},getDirectoryMenuData:function(t){return $.ajax({url:"/api/Directory/GetReleMenu",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})}};function DirectoryGetDataInit(){var t,e;$(".catalog_frame").each((function(){var a=$(this);a.data("dirid")&&a.data("shownum")&&(t=a.data("dirid"),1,e=a.data("shownum"),DirectoryDataGet(a,t,1,e))})),$(".menu_directory").each((function(){var t=$(this);1!=t.data("init")&&t.data("dirid")>0&&(Directory.getDirectoryMenuData({Id:t.data("dirid"),WebsiteId:"undefined"!=typeof SiteId?SiteId:0}).done((function(e){t.find(".title").text(e.title),$.each(e.children,(function(a,i){if(t.find(".title").text(e.title),null!=i.children){var n=$($("#TemplateAccordionItem").html()).clone();n.find(".sectitle").text(i.title),n.find(".accordion-header").attr("id",`secheader${i.Id}`),n.find(".accordion-collapse").attr({"aria-labelledby":`secheader${i.Id}`,id:`seccollapse${i.Id}`}),n.find(".accordion-button").attr({"data-bs-target":`#seccollapse${i.Id}`,"aria-controls":`seccollapse${i.Id}`});var r=n.find(".accordion-body");$.each(i.children,(function(t,e){r.append(`<a href="${e.routerName}" title="連結至：${e.title}" class="list-group-item list-group-item-action border-0 py-3">${e.title}</a>`)})),t.find(".accordion").append(n)}else{var o=`<div class="accordion-item border-0 border-bottom px-1"><a href="${i.routerName}" title="連結至：${i.title}" class="list-group-item border-0 py-3 custom_h5 text-black">${i.title}</a></div>`;t.find(".accordion").append(o)}}))})),t.data("init",!0))}))}function DirectoryDataGet(t,e,a,i){Directory.getDirectoryData({Ids:[e],SiteId:"undefined"==typeof SiteId?0:SiteId,Page:a,ShowNum:i}).done((function(e){if(!t.data("init")){for(var n=1;n<=e.totalPage;n++)t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" data-page=${n}>${n}</button></li>`);$(".btn_prev > button").on("click",(function(){a>1&&(t.find(".catalog").children().each((function(){var t=$(this);t.hasClass("templatecontent")||t.remove()})),a--,DirectoryDataGet(t,a,i))})),$(".btn_page").on("click",(function(){var e=$(this);a!=e.data("page")&&(t.find(".catalog").children().each((function(){var t=$(this);t.hasClass("templatecontent")||t.remove()})),a=e.data("page"),DirectoryDataGet(t,a,i))})),$(".btn_next > button").on("click",(function(){a<e.totalPage&&(t.find(".catalog").children().each((function(){var t=$(this);t.hasClass("templatecontent")||t.remove()})),a++,DirectoryDataGet(t,a,i))}))}t.data("init","true"),DirectoryDataInsert(t,e.releInfos)}))}function DirectoryDataInsert(t,e){e.forEach((function(e){var a=$(t.find(".templatecontent").html()).clone();a.find("a").attr("href",e.link),a.find("a").attr("alt",e.name),a.find("img").attr("src",e.mainImage),a.find("img").attr("alt",void 0===e.name?"":`${e.name}的主要圖片`),a.find("a").attr("href",e.link),a.find(".title").text(e.title),a.find(".description").text(e.description),t.find(".catalog").append(a)})),HoverEffectInit()}
function FrameInit(){$(".masonry").each((function(){var i=$(this);if(!i.data("isInit")){$(this).find(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-item"});i.data("isInit",!0)}}))}
function HoverEffectInit(){$(".hover_mask").each((function(){$(this).find(".hover_protrude_scale").each((function(){var i=$(this);i.hover((function(){i.siblings().each((function(){$(this).addClass("opacity-50")}))}),(function(){i.siblings().each((function(){$(this).removeClass("opacity-50")}))}))}))}))}
function LinkWithIconInit(){$(".link_with_icon").each((function(){var i=$(this),a=i.attr("href");if(i.find(".icon").empty(),void 0!==a)switch(a.substring(a.lastIndexOf(".")+1,a.length)){case"jpg":case"jpeg":case"png":case"gif":i.find(".icon").append('<i class="fa-solid fa-file-image" style="color: #ff9500;"></i>');break;case"pdf":i.find(".icon").append('<i class="fa-solid fa-file-pdf" style="color: #b30b00;"></i>');break;case"doc":case"docx":case"odt":i.find(".icon").append('<i class="fa-solid fa-file-word" style="color: #2c599d;"></i>');break;case"ppt":case"pptx":case"odp":i.find(".icon").append('<i class="fa-solid fa-file-powerpoint" style="color: #D04323;"></i>');case"xls":case"xlsx":case"ods":i.find(".icon").append('<i class="fa-solid fa-file-excel" style="color: #037945;"></i>');break;case"zip":case"rar":i.find(".icon").append('<i class="fa-solid fa-file-zipper"></i>');break;default:i.find(".icon").append('<i class="fa-solid fa-file" style="color: #999999;"></i>')}void 0===i.attr("download")&&i.attr("download","未命名"),i.find(".name").text(i.attr("download"))}))}
function ShareBlockInit(){$(".shareBlock").each((function(){void 0!==$(this).data("init")&&$(this).data("init")||($(this).cShare({description:"jQuery plugin - C Share buttons...",showButtons:["email","plurk","twitter","fb","line"]}),$(this).data("init",!0))}))}
function SitemapInit(){var e=function(e){return $.ajax({url:"/api/WebMenu/GetAll/",type:"GET",contentType:"application/json; charset=utf-8",data:{WebsiteID:e}})};"undefined"!=typeof SiteId?e(SiteId).done((function(e){CreateSitemap(e.maps)})):e(null).done((function(e){CreateSitemap(e.maps)}))}function CreateSitemap(e){var t=$(".sitemap_hierarchical_frame");t.append('<ul class=""></ul>');var a=1;e.forEach((function(e){var n=$($("#Hierarchical_First_Item").html()).clone(),l=n.find(".first");if(null!=e.children){l.text(`${a} ${e.title}`),n.append('<ul class="ps-5 ps-md-0 col-md-8 py-1"></ul>');var i=n.find("ul"),r=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Second_Item").html()).clone(),n=t.find(".second");if(n.attr("href",e.routerName),n.attr("alt",e.text),null!=e.children){n.removeClass("ps-4 ps-sm-3"),n.append(`<span class="d-flex d-md-none material-symbols-outlined position-absolute start-0">expand_more</span><span class="second p-sm-0 ps-2">${a}-${r} ${e.title}</span><span class="d-none d-md-flex material-symbols-outlined">navigate_next</span>`),t.append('<ul class="ps-5 ps-md-0 col-md-6"></ul>');var l=t.find("ul"),s=1;e.children.forEach((function(t){var n=$($("#Hierarchical_Third_Item").html()).clone(),i=n.find(".third");i.attr("href",`${e.routerName}#${t.routerName}`),i.attr("alt",t.text),i.text(`${a}-${r}-${s} ${t.title}`),l.append(n),s++}))}else n.text(`${a}-${r} ${e.title}`);i.append(t),r++}))}else l.parent("div").parent("div").html(`<a class="first d-block text-black px-3 rounded-3" href="${e.routerName}" alt="${e.text}">${a} ${e.title}</a>`);t.append(n),a++}))}
function SwiperInit(e){var t={slidesPerView:1,spaceBetween:15};$(".one_swiper").prop("draggable",!0).each((function(){var i=$(this);if(!i.data("isInit")){var a="#"+i.attr("id")+" > .swiper",n=$.extend(t,{pagination:{el:a+" > .swiper_pagination > *",clickable:!0},navigation:{nextEl:a+" > .swiper_button_next > button",prevEl:a+" > .swiper_button_prev > button"}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{});new Swiper(a,n);i.data("isInit",!0)}})),$(".two_swiper").prop("draggable",!0).each((function(){var i=$(this);if(!i.data("isInit")){var a="#"+i.attr("id")+" > .swiper",n=$.extend(t,{pagination:{el:a+" > .swiper_pagination > *",clickable:!0,renderBullet:function(e,t){return i.has(".swiper_pagination_water").length?'<span class="'+t+' material-symbols-outlined ms-3">water_drop</span>':'<span class="'+t+'"></span>'}},navigation:{nextEl:a+" > .swiper_button_next > button",prevEl:a+" > .swiper_button_prev > button"},breakpoints:{375:{slidesPerView:2}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{});new Swiper(a,n);i.data("isInit",!0)}})),$(".four_swiper").prop("draggable",!0).each((function(){var i=$(this);if(!i.data("isInit")){var a="#"+i.attr("id")+" > .swiper",n=$.extend(t,{pagination:{el:a+" > .swiper_pagination > *",clickable:!0},navigation:{nextEl:a+" > .swiper_button_next > button",prevEl:a+" > .swiper_button_prev > button"},breakpoints:{375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{});new Swiper(a,n);i.data("isInit",!0)}})),$(".six_swiper").prop("draggable",!0).each((function(){var i=$(this);if(!i.data("isInit")){var a="#"+i.attr("id")+" > .swiper",n=$.extend(t,{navigation:{nextEl:a+" > .swiper_button_next > button",prevEl:a+" > .swiper_button_prev > button"},slidesPerView:6},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{});new Swiper(a,n);i.data("isInit",!0)}}))}
function ViewTypeChangeInit(){$(".type_change_frame").each((function(){var a=$(this);if(!a.data("isInit")&&"TypeChange"==a.data("action")){const e=a.find(".btn_grid"),i=a.find(".btn_list"),t=a.find(".content").first();e.on("click",(function(){e.data("activate")||typeChange(e,i,t,"Grid")})),i.on("click",(function(){i.data("activate")||typeChange(i,e,t,"List")}))}a.data("isInit",!0)}))}function typeChange(a,e,i,t){a.data("activate",1),a.removeClass("text-black-50"),e.data("activate",0),e.addClass("text-black-50"),"List"==t?i.each((function(){var a=$(this);a.removeClass("row row-cols-2 row-cols-sm-4 row-cols-lg-6"),a.find("figure").removeClass("flex-column"),a.find(".image_frame").removeClass("w-100"),a.find(".image").addClass("px-0"),a.find("figcaption").addClass("flex-grow-1 p-3 py-0 py-md-3"),a.find(".title").removeClass("text-center"),a.find(".title").addClass("h-100"),a.find(".description").removeClass("d-none")})):"Grid"==t&&i.each((function(){var a=$(this);a.addClass("row row-cols-2 row-cols-sm-4 row-cols-lg-6"),a.find("figure").addClass("flex-column"),a.find(".image_frame").addClass("w-100"),a.find(".image").removeClass("px-0"),a.find("figcaption").removeClass("flex-grow-1 p-3 py-0 py-md-3"),a.find(".title").addClass("text-center"),a.find(".title").removeClass("h-100"),a.find(".description").addClass("d-none")}))}