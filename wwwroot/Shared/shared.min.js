function AnchorPointInit(){$(".anchor_directory").each((function(){var t=$(this);t.children("ul").empty(),$(".anchor_title").each((function(){var n=$(this),e=n.text().indexOf("\n")>-1?n.text().substr(0,n.text().indexOf("\n")):n.text();t.children("ul").append(`<li class="fs-5"><a class="text-black text-decoration-none" href="#${n.attr("id")}"><div class="p-2 px-4">${e}</div></a></li>`),n.bind("DOMNodeInserted",(function(){AnchorPointInit()}))})),t.children('a[href^="#"]').click((function(t){var n=$(this).attr("href"),e=$(n).offset().top-50;$("html, body").animate({scrollTop:e},0),t.preventDefault()}))}))}
var Directory={getDirectoryData:function(t){return $.ajax({url:"/api/Directory/GetReleInfo",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})},getDirectoryMenuData:function(t){return $.ajax({url:"/api/Directory/GetReleMenu",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})}};function initElemntAndLoadDir(t,e){const a=t||$(".catalog_frame").first(),n=a.attr("data-dirid")>0?a.attr("data-dirid"):0;a.data("prevdirid",n);const i=void 0!==a.data("shownum")?a.data("shownum"):12,o=void 0!==a.data("maxlen")?a.data("maxlen"):0,d=e?e.toString():location.hash.replace("#","");void 0!==a.data("page")&&a.data("page")==d||(e=isNaN(d)||""==d?"1":d,a.find(".catalog>.template").remove(),DirectoryDataGet(a,{Ids:[n],SiteId:"undefined"==typeof SiteId?0:SiteId,Page:e,ShowNum:i,MaxLen:void 0===o?0:o}),a.data("page",e))}function DirectoryGetDataInit(){const t=$(".catalog_frame").length;$(".catalog_frame").each((function(){const t=$(this),e=t.attr("data-dirid")>0?t.attr("data-dirid"):0;void 0!==t.data("prevdirid")&&e==t.data("prevdirid")||initElemntAndLoadDir($(this))})),$(".menu_directory").each((function(){var t=$(this),e=t.attr("data-dirid")>0?t.attr("data-dirid"):0;void 0!==t.data("prevdirid")&&e==t.data("prevdirid")||(t.data("prevdirid",e),t.find(".title").text(""),t.find(".accordion").empty(),Directory.getDirectoryMenuData({Id:e,WebsiteId:"undefined"!=typeof SiteId?SiteId:0}).done((function(e){if(void 0!==e){t.find(".title").text(e.title);const a=`#${t.find(".accordion").attr("id")}`;$.each(e.children,(function(n,i){if(t.find(".title").text(e.title),null!=i.children){var o=$($("#TemplateAccordionItem").html()).clone();o.find(".sectitle").text(i.title),o.find(".accordion-header").attr("id",`secheader${i.id}`);const e=o.find(".accordion-collapse").attr({"aria-labelledby":`secheader${i.id}`,id:`seccollapse${i.id}`,"data-bs-parent":`${a}`});o.find(".accordion-button").attr({"data-bs-target":`#seccollapse${i.id}`,"aria-controls":`seccollapse${i.id}`});var d=o.find(".accordion-body");$.each(i.children,(function(t,a){"undefined"!=typeof PageKey&&PageKey.toLowerCase()==a.routerName.toLowerCase()&&$(e).collapse("show"),d.append(`<a href="${a.routerName}" title="連結至：${a.title}" class="list-group-item list-group-item-action border-0 py-3">${a.title}</a>`)})),t.find(".accordion").append(o)}else{var r=`<div class="accordion-item border-0 border-bottom px-1"><a href="${i.routerName}" title="連結至：${i.title}" class="list-group-item border-0 py-3 custom_h5 text-black">${i.title}</a></div>`;t.find(".accordion").append(r)}}))}})))})),1==t&&("onhashchange"in window?window.onhashchange=hashChangeDirectory:setInterval(hashChangeDirectory,1e3))}function hashChangeDirectory(t){t?(initElemntAndLoadDir(),t.preventDefault()):console.log("HashChange錯誤")}function DirectoryDataGet(t,e){const a=$(".catalog_frame").length;let n=parseInt(e.Page);"search"==t.data("type")&&$.extend(!0,e,{Type:"search",SearchText:t.data("search-text").toString(),StartDate:t.data("startDate"),EndDate:t.data("endDate")}),Directory.getDirectoryData(e).done((function(i){let o=2;"search"==e.Type&&$(".searchCount").text(i.totalCount),t.find(".page-item").each((function(){var t=$(this);t.hasClass("btn_prev")||t.hasClass("btn_next")||t.remove()})),i.totalPage<=1?t.find(".page_btn").addClass("d-none"):t.find(".page_btn").removeClass("d-none"),n>i.totalPage?n=i.totalPage:n<1&&(n=1),1==n?t.find(".btn_prev").addClass("d-none"):t.find(".btn_prev").removeClass("d-none"),n==i.totalPage?t.find(".btn_next").addClass("d-none"):t.find(".btn_next").removeClass("d-none"),1!=n&&n!=i.totalPage||(o=4);for(var d=1;d<=i.totalPage;d++)1==d?d==n?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>1</span></li>`):(t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="第一頁" data-page=${d}>1</button></li>`),n-o-1>0&&t.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>')):d==i.totalPage?d==n?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>${i.totalPage}</span></li>`):(n+o+1<i.totalPage&&t.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>'),t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="最後一頁" data-page=${d}>${i.totalPage}</button></li>`)):d>=n-o&&d<=n+o&&(d==n?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>${d}</span></li>`):t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="移動至第${d}頁" data-page=${d}>${d}</button></li>`));$(".btn_page").off("click").on("click",(function(){var e=$(this);n!=e.data("page")&&(n=e.data("page"),1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(t,n)),t.goTo()})),t.data("init")||(t.find(".btn_prev > button").on("click",(function(){var e=$(this);n=parseInt(t.data("page"))-1,e.data("page",n),n>=1&&(1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(t,e.data("page"))),t.goTo()})),t.find(".btn_next > button").on("click",(function(){var e=$(this);n=parseInt(t.data("page"))+1,e.data("page",n),n<=i.totalPage&&(1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(t,e.data("page"))),t.goTo()}))),t.data("init","true"),DirectoryDataInsert(t,i.releInfos)}))}function DirectoryDataInsert(t,e){if(null==e)return;const a=t.find(".templatecontent").html(),n=t.find(".templatecontent-tag").html(),i="search"==t.data("type");0==e.length?t.find(".catalog").addClass("empty"):t.find(".catalog").removeClass("empty"),null!=e&&e.forEach((function(e){var o=$(a).clone();let d,r;if(i){if(3===e.type)d=`${null==e.orgName?"":`/${e.orgName}`}/${e.link}/${t.data("search-text")}`;else d=`${null==e.orgName?"":`/${e.orgName}`}/search/${e.link}/${t.data("search-text")}`;if(r="_blank",e.mainImage.indexOf("youtu")>0){var l="",s=e.mainImage.match(/^.*(?:(?:youtu.be\/|v\/|vi\/|u\/w\/|embed\/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*/);null!=s&&s.length>0&&(l=s[1]),e.mainImage="https://img.youtube.com/vi/"+l+"/mqdefault.jpg"}}else d=(window.location.pathname.indexOf(e.orgName)>0?window.location.pathname:`${null==e.orgName?"":`/${e.orgName}`}${window.location.pathname}`)+e.link,r="_self";1==e.type&&0!=e.status&&o.find("a").append(`<span class="status status${e.status}">${e.statusName}</span>`),d=d.replace("//","/");const c={href:d,title:`連結至: ${e.title}${"_blank"==r?"(另開視窗)":""}`,target:r};"A"==o[0].tagName?o.attr(c):o.find("a").attr(c);var g=e.mainImage||"/images/noImg.jpg";if(null!=e.orgName&&("undefined"!=typeof IsFaPage&&"undefined"!=typeof OrgName&&"True"!=IsFaPage||"undefined"!=typeof OrgName&&OrgName!=e.orgName)&&(g=g.replace("upload",`upload/${e.orgName}`)),o.find("img").attr("src",g),o.find("img").imgCheck().attr("alt",`${e.title}的主要圖片`),o.find(".title").text(e.title),o.find(".description").html(e.description),o.find(".location").length>0&&(null==e.location||""==e.location)?o.find(".location").parents(".py-2").remove():o.find(".location").text(e.location),o.find(".address").length>0&&(null==e.address||""==e.address)?o.find(".address").parents(".py-2").remove():o.find(".address").text(e.address),null!=e.startTime&&""!=e.startTime){var p=new Date(e.startTime);o.find(".startTime").text(`${p.getFullYear()}/${p.getMonth()+1}/${p.getDate()}`)}if(null!=e.nodeDate&&""!=e.nodeDate){var f=new Date(e.nodeDate);o.find(".date").text(`${f.getFullYear()}/${f.getMonth()+1}/${f.getDate()}`),o.find(".date-month").text(`${f.getMonth()+1}月`),o.find(".date-monthyear").text(`${f.getMonth()+1}/${f.getFullYear()}`),f.getDate()<10?o.find(".date-day").text(`0${f.getDate()}`):o.find(".date-day").text(`${f.getDate()}`),f.getMonth()<9?o.find(".date-month-number").text(`0${f.getMonth()+1}`):o.find(".date-month-number").text(`${f.getMonth()+1}`),o.find(".date-year").text(`${f.getFullYear()}`)}if(null!=e.price){const t=t=>t.includes("~")?([price_low,price_mid,price_high]=t.split(" "),price_high):t,a=e=>Intl.NumberFormat().format(t(e));if(o.find(".normal-price").text(a(e.price)),o.find(".price-grid").text(a(e.price)),o.find(".itemNo").text(e.itemNo),$tags=o.find(".tags"),$tags.empty(),e.tags.slice(0,2).forEach((t=>{let e=$(n).clone();e.text(t.tag_Name.slice(0,4)),$tags.append(e)})),e.tags.slice(2).forEach((t=>{let e=$(n).clone();e.text(t.tag_Name.slice(0,4)),e.addClass("more-tag d-none"),$tags.append(e)})),e.tags.length>2){let t=$(n).clone();t.text("..."),t.addClass("less-tag"),$tags.append(t)}}o.find(".shareBlock > a").remove(),o.find(".shareBlock").data("href",d),t.find(".catalog").append(o)})),HoverEffectInit(),ShareBlockInit()}
function FrameInit(){$(".masonry").each((function(){var i=$(this);if(!i.data("isInit")){$(this).find(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-item"});i.data("isInit",!0)}}))}
function HoverEffectInit(){$(".hover_mask").each((function(){$(this).find(".hover_protrude_scale").each((function(){var i=$(this);i.hover((function(){i.siblings().each((function(){$(this).addClass("opacity-50")}))}),(function(){i.siblings().each((function(){$(this).removeClass("opacity-50")}))}))}))})),$(".black-bg .close").click((function(){$(".black-bg").fadeOut(500)})),$("#swiper1, #swiper2, #swiper3, #swiper4, #swiper5, #swiper6, #swiper7, #swiper8").click((function(){$(".black-bg").fadeIn(500)}))}function withebg(){$(".qual-width-images").mouseover((function(){var i=$(this).attr("id").substr(3);$(".image-overlay").not("#overlay"+i).css("display","block")})),$(".qual-width-images").mouseout((function(){$(".image-overlay").css("display","none")}))}
function LinkWithIconInit(){$(".link_with_icon").each((function(){var a=$(this),i=a.attr("href");if(a.find(".icon").empty(),void 0!==i){var e=i.substring(i.lastIndexOf(".")+1,i.length);switch(e){case"jpg":case"jpeg":case"png":case"gif":a.find(".icon").append('<i class="fa-solid fa-file-image" style="color: #ff9500;"></i>');break;case"pdf":a.find(".icon").append('<i class="fa-solid fa-file-pdf" style="color: #b30b00;"></i>');break;case"doc":case"docx":case"odt":a.find(".icon").append('<i class="fa-solid fa-file-word" style="color: #2c599d;"></i>');break;case"ppt":case"pptx":case"odp":a.find(".icon").append('<i class="fa-solid fa-file-powerpoint" style="color: #D04323;"></i>');case"xls":case"xlsx":case"ods":a.find(".icon").append('<i class="fa-solid fa-file-excel" style="color: #037945;"></i>');break;case"zip":case"rar":a.find(".icon").append('<i class="fa-solid fa-file-zipper"></i>');break;default:a.find(".icon").append('<i class="fa-solid fa-file" style="color: #999999;"></i>')}}void 0===a.attr("download")&&a.attr("download","未命名"),a.find(".name").text(a.attr("download")),new RegExp(`${e}$`,"gi").test(a.attr("download"))?a.attr("download",`${a.attr("download")}`):a.attr("download",`${a.attr("download")}.${e}`),a.attr("title",`${a.attr("download")}(另開新視窗)`)}))}
function ShareBlockInit(){$(".shareBlock").each(((t,i)=>{if($this=$(i),void 0===$this.data("init")||!$this.data("init")){var h="";"string"==typeof $this.data("href")&&(h=$this.data("href")),$this.cShare({description:"jQuery plugin - C Share buttons...",showButtons:["email","plurk","twitter","fb","line"],shareToText:"分享至",href:h}),$this.hover(ProShare),$this.data("init",!0)}}))}function ProShare(){$(this).toggleClass("show")}
function SitemapInit(){var e=function(e){return $.ajax({url:"/api/WebMenu/GetAll/",type:"GET",contentType:"application/json; charset=utf-8",data:{WebsiteID:e}})};"undefined"!=typeof SiteId?e(SiteId).done((function(e){CreateSitemap(e.maps)})):e(null).done((function(e){CreateSitemap(e.maps)}))}function CreateSitemap(e){var t=$(".sitemap_hierarchical_frame");t.append('<ul class=""></ul>');var a=1;e.forEach((function(e){var n=$($("#Hierarchical_First_Item").html()).clone(),l=n.find(".first");if(null!=e.children){l.text(`${a} ${e.title}`),n.append('<ul class="ps-5 ps-md-0 col-md-8 py-1"></ul>');var i=n.find("ul"),r=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Second_Item").html()).clone(),n=t.find(".second");if(n.attr("href",e.routerName),n.attr("alt",e.text),null!=e.children){n.removeClass("ps-4 ps-sm-3"),n.append(`<span class="d-flex d-md-none material-symbols-outlined position-absolute start-0">expand_more</span><span class="second p-sm-0 ps-2">${a}-${r} ${e.title}</span><span class="d-none d-md-flex material-symbols-outlined">navigate_next</span>`),t.append('<ul class="ps-5 ps-md-0 col-md-6"></ul>');var l=t.find("ul"),s=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Third_Item").html()).clone(),n=t.find(".third");n.attr("href",`${e.routerName}`),n.attr("alt",e.text),n.text(`${a}-${r}-${s} ${e.title}`),l.append(t),s++}))}else n.text(`${a}-${r} ${e.title}`);i.append(t),r++}))}else l.parent("div").parent("div").html(`<a class="first d-block text-black px-3 rounded-3" href="${e.routerName}" alt="${e.text}">${a} ${e.title}</a>`);t.append(n),a++}))}
function SwiperInit(e){var i={slidesPerView:1,spaceBetween:15};if($.fn.extend({swiperBindEven:function(e){const i=function(){e.autoplay.stop()},t=function(){e.autoplay.start()};$(this).find(".swiper").prepend($(this).find(".swiper_button_prev")),$(this).on("mouseover",i),$(this).find("a").on("focus",i),$(this).on("mouseout",t),$(this).find("a").on("blob",t),$(this).find("button").prop("disabled",!1)}}),$(".one_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var a="#"+t.attr("id")+" > .swiper";const l=$(a).find(".swiper-slide").length>=2;var n=t.data("effect"),r=t.data("effect-speed");void 0!==n&&!1!==n||(n="slide"),r=void 0===r||!1===r?300:parseInt(r);var s=!!e.autoplay&&l,p=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},effect:n,speed:r},s?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{},l?{navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"}}:{});l||$(`#${t.attr("id")}`).find(".swiper_button_next,.swiper_button_prev").remove();var o=new Swiper(a,p);t.data("isInit",!0),s&&o.slides.length-2>1&&t.swiperBindEven(o)}})),$(".two_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var a="#"+t.attr("id")+" > .swiper",n=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0,renderBullet:function(e,i){return t.has(".swiper_pagination_water").length?'<span class="'+i+' material-symbols-outlined ms-3">water_drop</span>':'<span class="'+i+'"></span>'}},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{400:{slidesPerView:1},1024:{slidesPerView:2}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),r=new Swiper(a,n);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(r),t.prepend($("#"+t.attr("id")+" .swiper_button_prev")),console.log(n)}})),$(".four_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var a="#"+t.attr("id")+" > .swiper",n=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper-pagination",clickable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{375:{slidesPerView:1},576:{slidesPerView:3},769:{slidesPerView:4}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),r=new Swiper(a,n);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(r),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".six_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var a="#"+t.attr("id")+" > .swiper",n=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},scrollbar:{el:".swiper-scrollbar",draggable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{320:{slidesPerView:2},375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:6}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),r=new Swiper(a,n);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(r),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".picture-category").length>0&&$("#SwiperModal").length>0){const e=new Swiper("#pictureSwiperThumbs",{spaceBetween:10,breakpoints:{375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:6}},freeMode:!0,watchSlidesProgress:!0}),i=new Swiper("#pictureSwiper",{centeredSlides:!0,spaceBetween:10,navigation:{nextEl:"#pictureSwiper .swiper-button-next",prevEl:"#pictureSwiper .swiper-button-prev"},pagination:{el:"#pictureSwiper .swiper-pagination"},thumbs:{swiper:e}});$(".picture-category a").attr("href","#SwiperModal").on("click",(function(){const t=$(this).parents(".picture-category"),a=$(".picture-category a").index(this),n=[];t.find(".templatecontent img").each((function(){n.push($(this).attr("src"))})),i.removeAllSlides(),e.removeAllSlides();for(let t=0;t<n.length;t++){const a=`<div class="swiper-slide"><img src="${n[t]}" alt=" " /></div>`;i.appendSlide(a),e.appendSlide(a)}return i.slideTo(a,0),e.slideTo(a,0),$("#SwiperModal").modal("show"),!1}))}}
const newEnum=e=>{const t={};return Object.keys(e).forEach((n=>{t[t[n]=e[n]]=n})),t},list_type=newEnum({grid:"Grid",list:"List",text:"Text",product_grid:"Product_Grid",product_list:"Product_List"}),display_configurations={[list_type.list]:["type1 bg-white",{".card-border":"card-border-rd type3",".catalog-number":"d-none",".check_btn":"check_btn-type3",".col":"p-1 type3 box-shadow",".description":"type3-content",".image":"px-0",".image_frame":"h-100",".imgh":"img-h",".item-header":"d-none",".like-and-share":"d-none",".max-h":"max-hei",".mergetag":"merge",".more-btn":"d-none",".more-tag":"d-none",".price-grid":"d-none",".purchase":"d-none",".related-tag":"d-none",".shareBlock":"d-none",".tags":"d-none",".title":"type1-title fw-bold p-2",figcaption:"flex-grow-1 p-3 py-0 py-md-3 pb1"}],[list_type.grid]:["type2 row row-cols-sm-4 bg-white",{".card-border":"card-border-rd type2",".catalog-number":"d-none",".check_btn":"w-100",".col":"p-1 type2 box-shadow",".date":"d-none",".description":"d-none type2-content",".image_frame":"w-100",".item-header":"d-none",".like-and-share":"d-none",".more":"d-none",".more-btn":"d-none",".more-tag":"d-none",".price-grid":"d-none",".purchase":"d-none",".related-tag":"d-none",".shareBlock":"d-none",".tags":"d-none",".title":"type1-title fw-bold p-2",figcaption:"pb1",figure:"flex-column"}],[list_type.text]:["type3 row row-cols-sm-4 bg-white",{".card-border":"pr3 type1",".catalog-number":"d-none",".check_btn":"w-100",".col":"p-1 type1 text-border box-shadow",".date":"d-none",".description":"d-none",".image":"d-none",".image_frame":"d-none",".item-header":"d-none",".like-and-share":"d-none",".more":"d-none",".more-tag":"d-none",".price-grid":"d-none",".purchase":"d-none",".related-tag":"d-none",".shareBlock":"d-none",".search-more":"d-none",".tags":"d-none",".title":"type2-title pr3 h-100",figure:"flex-column"}],[list_type.product_grid]:["type4 row row-cols-lg-4 row-cols-md-2  bg-light px-2",{".card-border":"card-border-rd type2",".catalog-number":"d-none",".check_btn":"w-100",".col":"p-1 type4 rounded-lg h-100",".date":"d-none",".description":"d-none type2-content",".image_frame":"type4-image-frame w-100",".item-header":"d-flex",".like-and-share":"d-none",".more":"d-none",".more-btn":"d-none",".more-tag":"d-none",".purchase":"d-none",".shareBlock":"type4",".tags":"align-text-bottom",".title":"type4-title d-inline fs-6",figcaption:"pb1 type4-caption d-flex flex-column",figure:"flex-column"}],[list_type.product_list]:["type1 bg-light px-2",{".bottom-row":"mt-auto",".card-border":"card-border-rd type2",".catalog-number":"type4-title d-inline",".check_btn":"check_btn-type3",".col":" type5 rounded-lg",".description":"type3-content",".image":"px-0",".image_frame":"h-100 w-25",".imgh":"img-h",".item-header":"d-none",".item-title":"d-lg-flex",".less-tag":"d-none",".like-and-share":"d-inline ms-auto fs-5 p-2",".max-h":"max-hei",".mergetag":"merge",".more":"d-none",".more-btn":"d-none",".price-grid":"d-none",".purchase":"ms-auto d-inline",".related-tag":"d-none",".shareBlock":"type5",".tags":"mt-auto mb-2 align-text-bottom d-lg-flex",".title":"type4-title d-inline fs-6 p-2",figcaption:"flex-grow-1 d-flex flex-column"}]};function ViewTypeChangeInit(){$(".type_change_frame").each((function(){var e=$(this);if(!e.data("isInit")){const n=e.find(".btn_grid"),o=e.find(".btn_list"),d=e.find(".btn_text"),r=e.find(".btn_prod_grid"),i=e.find(".btn_prod_list"),a=e.find(".content").first(),c={[list_type.grid]:n,[list_type.list]:o,[list_type.text]:d,[list_type.product_grid]:r,[list_type.product_list]:i};for(const[e,t]of Object.entries(c))t.on("click",(function(){t.data("activate")||typeChange(t,c,a,e)}));n.hasClass("d-none")?o.hasClass("d-none")?d.hasClass("d-none")?r.hasClass("d-none")?i.hasClass("d-none")||i.trigger("click"):r.trigger("click"):d.trigger("click"):o.trigger("click"):n.trigger("click");var t=0;for(const[e,n]of Object.entries(c))(0===n.length||n.hasClass("d-none"))&&(t+=1);t>=4?e.find(".switch_control").addClass("d-none"):e.find(".switch_control").removeClass("d-none")}e.data("isInit",!0)}))}function updateStyle(e,t){for(const[t,n]of Object.entries(display_configurations)){e.removeClass(n[0]);for(const[t,o]of Object.entries(n[1]))e.find(t).removeClass(o)}e.addClass(t[0]);for(const[n,o]of Object.entries(t[1]))e.find(n).addClass(o)}function typeChange(e,t,n,o){for(const[e,n]of Object.entries(t))n.data("activate",0),n.addClass("text-black-50");e.data("activate",1),e.removeClass("text-black-50"),n.each((function(){updateStyle($(this),display_configurations[o])}))}
function date_input_change(t){var a=$(`#${t}`),n=a.attr("date-date-strat-date"),e=a.attr("data-date-end"),i=a.attr("data-location"),d=a.attr("data-addr"),r=a.attr("data-organizer"),s=a.attr("data-a-organizer"),l=a.attr("data-link"),o=a.attr("data-tel"),v=a.find(".activity_start_time").parents("div").eq(1);""==n&&""==e?$(v).addClass("d-none"):$(v).removeClass("d-none");var f=a.find(".activity_location").parents("div").eq(0);""==i?$(f).addClass("d-none"):($(f).find("a").attr({href:`https://www.google.com.tw/maps/place/${i}`,title:`連結至：${i}(另開新視窗)`,target:"_blank"}),$(f).removeClass("d-none"));var c=a.find(".activity_addr").parents("div").eq(0);""==d?$(c).addClass("d-none"):($(c).find("a").attr({href:`https://www.google.com.tw/maps/place/${d}`,title:`連結至：${d}(另開新視窗)`,target:"_blank"}),$(c).removeClass("d-none"));var h=a.find(".activity-organizer").parent("div").eq(0);""==r?$(h).addClass("d-none"):$(h).removeClass("d-none");var m=a.find(".activity-a-organizer").parent("div").eq(0);""==s?$(m).addClass("d-none"):$(m).removeClass("d-none");var _=a.find(".activity_link").parents("div").eq(0);""==l?$(_).addClass("d-none"):($(_).find("a").attr({href:l,title:"連結至：活動網站(另開新視窗)",target:"_blank"}),$(_).removeClass("d-none"));var C=a.find(".activity_tel").parents("div").eq(0);return""==o?$(C).addClass("d-none"):($(C).find("a").attr({href:`tel:${o}`,title:`播打電話：${o}`,target:"_blank"}),$(C).removeClass("d-none")),a.find(".activity_start_time").html(n),a.find(".activity_end_time").html(e),a.find(".activity_location").html(i),a.find(".activity_addr").html(d),a.find(".activity-organizer").html(r),a.find(".activity-a-organizer").html(s),a.find(".activity_link").html(l),a.find(".activity_tel").html(o),a.html()}function namecontrol(t){const a=$("#"+t),n=a.find(".btn_text"),e=a.find(".btn_grid"),i=a.find(".btn_list"),d=a.parents(".type_change_frame").first().find(".content").first();n.hasClass("d-none")?n.hasClass("d-none")&&!e.hasClass("d-none")?typeChange(e,i,n,d,"Grid"):n.hasClass("d-none")&&e.hasClass("d-none")&&!i.hasClass("d-none")&&typeChange(i,e,n,d,"List"):typeChange(n,e,i,d,"Text")}
function setContact(){$(".ContactForm").contactInit()}document.addEventListener("DOMContentLoaded",(()=>{$.fn.extend({contactInit:function(){$(this).each((function(){$(this).setContact()}))},setContact:function(){const t=this.get(0),e=this,n=e.find('[name="captcha"]'),a=e.find(".img-fluid").last();$("#ContactForm .btn_refresh").off("click").on("click",(()=>{NewCaptcha(a,n,"ContactUs")})),$("#ContactForm .btn_refresh").trigger("click"),e.getFormJson(),t.addEventListener("submit",(o=>{if(o.preventDefault(),o.stopPropagation(),t.classList.add("was-validated"),t.checkValidity()){o.preventDefault();const t={Email:"",Name:""},i=e.find('[name="sender"]');if("SELECT"==i.get(0).tagName){const e=i.find("option:selected");t.Email=e.val(),t.Name=e.text()}else t.Email=i.val(),t.Name=i.data("title");if(""==t.Email)return void co.sweet.error("資料錯誤","請選擇寄件人");$.ajax({url:"/api/Contact/submit",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({sender:t,forms:e.getFormJson()}),dataType:"json",beforeSend:function(t){t.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(t){t.success?(Coker.sweet.success("成功送出表單！",null,!0),e.removeClass("was-validated"),e.get(0).reset()):Coker.sweet.error("發送失敗",t.error,null,!0),NewCaptcha(a,n,"ContactUs")}))}else NewCaptcha(a,n,"ContactUs"),Coker.sweet.error("錯誤","須確實填寫表單資料才可送出",null,!0)}),!1),document.addEventListener("keyup",(function(t){var e=t.target;if("INPUT"==e.nodeName&&e.value.length==e.maxLength){var n=$(e).parents("form").first().find("input");for(let t=0;t<n.length;t++)if(n[t]==e)return void(n[t+1]&&n[t+1].focus())}}))}})}));
"use strict";const setBGCanvas=function(){const t=[1,1.1,1.8],n=[.8,1.1,2.2],i=[.9,1.1,2],e=[1,1.1,1.5];let a=null;$.fn.extend({BGCanvas:function(){const t=$(this),n=function(){if(!isNaN(t.data("type"))&&1===parseInt(t.data("type")))t.BGCanvasType1()};return 0==t.height()?t.find("img").on("load",(function(){n()})):n(),t},BGCanvasType1:function(){let s=$(this),o=$(this);if(0!=s.length&&"canvas"!=s.get(0).tagName.toLowerCase()&&0==s.find("canvas").length&&(o=$("<canvas>"),s.append(o)),0==s.length)return s;var h,r,l,d=45,c=.25;const{sin:g,cos:f,PI:u,sqrt:w,random:y,floor:v,ceil:p,round:C,abs:x}=Math;return function(){var w=o.get(0),v=w.getContext("2d");function p(){a=window.innerWidth>1500?t:window.innerWidth>1200?n:window.innerWidth>768?i:e,h=s.width()*a[0],r=s.height()*a[0],console.log(a),w.width=h,w.height=r,l=(h<r?h:r)/2,v.fillStyle="rgba(245,251,251,0)",v.fillRect(0,0,h,r)}function x(){this.ang=2*u*y(),this.dang=(-.5+y())/40,this.r=2*l/a[2],this.x=h/2+this.r*f(this.ang),this.y=r/2+a[1]*this.r*g(this.ang),this.update=function(){this.ang+=this.dang,this.x=h/2+this.r*f(this.ang),this.y=r/2+a[1]*this.r*g(this.ang)}}p(),window.onresize=p;var $=[];for(let t=0;t<18;t++)$.push(new x);!function t(){v.fillStyle="rgba(255,255,255,0.03)",v.fillRect(0,0,h,r),v.beginPath(),v.moveTo(($[0].x+$[17].x)/2,($[0].y+$[17].y)/2);for(let t=0;t<18;t++){let n=t+1;18==n&&(n=0),v.quadraticCurveTo($[t].x,$[t].y,($[t].x+$[n].x)/2,($[t].y+$[n].y)/2),$[t].update()}v.strokeStyle=`hsl(${C(180+d)}deg, 100%, 70%)`,v.lineWidth=2*l/432,v.stroke(),v.shadowColor="transparent",((d+=c)>=100||d<=45)&&(c=-c),45==d&&(v.fillStyle="rgba(0,0,0,0)",v.fillRect(0,0,h,r)),window.requestAnimationFrame(t)}()}(),s}}),$(".BGCanvas").BGCanvas()};
var FileApi={insertNotFondFile:function(t){return t.from=location.href,$.ajax({url:"/api/File/insertNotFondFile",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})}};function jqueryExtend(){$.fn.extend({imgCheck:function(){var t=$(this);return t.each((function(t,e){$(e).on("error",(function(){FileApi.insertNotFondFile({Url:$(e).attr("src"),FK_WebsiteID:"undefined"==typeof SiteId?0:SiteId}),$(e).attr("src","/images/noImg.jpg")}))})),t}})}
function FlipBookInit(){var e=$(".FlipBook");if(e.addClass("d-none"),void 0!==e.data("pdf")&&e.data("pdf"))var o=e.data("pdf");else console.log("No PDF file specified for FlipBook"),o="/lib/pdf-viewer/external/pdfjs-2.1.266-dist/web/compressed.tracemonkey-pldi-09.pdf";console.log(o);var t=document.createElement("div"),i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&(200==this.status&&(t.innerHTML=this.responseText),404==this.status&&(t.innerHTML="Page not found."),e.append(t),e.removeClass("d-none"),$(".FlipBookModal").length>0&&FlipBookModalInit())},i.open("GET","/lib/pdf-viewer/external/pdfjs-2.1.266-dist/web/viewer.html?file="+encodeURIComponent(o),!0),i.send()}function FlipBookModalInit(){$(".FlipBookModal").on("show.bs.modal",(e=>{var o=e.relatedTarget.getAttribute("data-pdf-url");console.log(o),PDFViewerApplication.setInitialView(),PDFViewerApplication.open({url:o,originalUrl:o})}))}