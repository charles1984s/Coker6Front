function AnchorPointInit(){$(".anchor_directory:not(.selectList)").addClass("selectList").each((function(){var e=$(this);e.children("ul").empty(),$(".anchor_title").each((function(){var t=$(this),n=t.text().indexOf("\n")>-1?t.text().replace(/\n/g,""):t.text();e.children("ul").append(`<li class="fs-5"><a class="text-black text-decoration-none" href="#${t.attr("id")}"><div class="p-2 px-4">${n}</div></a></li>`),t.on("DOMNodeInserted",(function(){AnchorPointInit()}))})),e.children('a[href^="#"]').on("click",(function(e){var t=$(this).attr("href"),n=$(t).offset().top-50;$("html, body").animate({scrollTop:n},0),e.preventDefault()}))})),$(window).off("resize.selectList").on("resize.selectList",(e=>{$(".selectList").each(((e,t)=>{const n=$(t);if(0==n.find("select").length||1==n.find("select").children().length){const e=n.find("a"),t=$("<select>");n.find("select").remove(),t.append($("<option>").val("").text("請選擇將前往的標籤")),e.each(((e,n)=>{t.append($("<option>").data("trigger",n).val(n.href).text($(n).text()))})),t.on("change",(function(){const e=t.children(":selected");/^#/.test(e.val())?e.data("trigger").trigger("click"):location.href=e.val()})),n.append(t)}$(window).width()>576?(n.children().first().removeClass("d-none"),n.children("select").addClass("d-none")):(n.children().first().addClass("d-none"),n.children("select").removeClass("d-none"))}))})),$(window).trigger("resize.selectList")}
var Directory={getDirectoryData:function(e){return $.ajax({url:"/api/Directory/GetReleInfo",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})},getDirectoryMenuData:function(e){return $.ajax({url:"/api/Directory/GetReleMenu",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})}};function initElemntAndLoadDir(e,t){const a=e||$(".catalog_frame").first(),n=a.attr("data-dirid")>0?a.attr("data-dirid"):0;a.data("prevdirid",n);const i=void 0!==a.data("shownum")?a.data("shownum"):12,o=void 0!==a.data("maxlen")?a.data("maxlen"):0,d=t?t.toString():location.hash.replace("#","");if(void 0===a.data("page")||a.data("page")!=d){t=isNaN(d)||""==d?"1":d;const r={Ids:[n],SiteId:"undefined"==typeof SiteId?0:SiteId,Page:t,ShowNum:i,MaxLen:void 0===o?0:o,Filters:a.data("filtered"),directoryType:a.data("directoryTypeChecked")};a.find(".catalog>.template").remove(),DirectoryDataGet(a,r),a.off("filter").on("filter",(function(){a.removeData("page"),initElemntAndLoadDir(e,t)})),a.data("page",t)}}function DirectoryGetDataInit(){const e=$(".catalog_frame").length;$(".catalog_frame").each((function(){const e=$(this),t=e.attr("data-dirid")>0?e.attr("data-dirid"):0;void 0!==e.data("prevdirid")&&t==e.data("prevdirid")||initElemntAndLoadDir($(this))})),$(".menu_directory").each((function(){var e=$(this),t=e.attr("data-dirid")>0?e.attr("data-dirid"):0,a=void 0!==e.attr("data-show-unvisible")&&"true"==e.attr("data-show-unvisible").toLowerCase();void 0!==e.data("prevdirid")&&t==e.data("prevdirid")||(e.data("prevdirid",t),e.find(".title").text(""),e.find(".accordion").empty(),Directory.getDirectoryMenuData({Id:t,WebsiteId:"undefined"!=typeof SiteId?SiteId:0,showUnvisible:a}).done((function(t){if(void 0!==t){e.find(".title").text(t.title);const a=`#${e.find(".accordion").attr("id")}`;$.each(t.children,(function(n,i){if(e.find(".title").text(t.title),null!=i.children){var o=$($("#TemplateAccordionItem").html()).clone();o.find(".sectitle").text(i.title),o.find(".accordion-header").attr("id",`secheader${i.id}`);const t=o.find(".accordion-collapse").attr({"aria-labelledby":`secheader${i.id}`,id:`seccollapse${i.id}`,"data-bs-parent":`${a}`});o.find(".accordion-button").attr({"data-bs-target":`#seccollapse${i.id}`,"aria-controls":`seccollapse${i.id}`});var d=o.find(".accordion-body");$.each(i.children,(function(e,a){const n=$(`<a href="${a.routerName}" title="連結至：${a.title}" class="list-group-item list-group-item-action border-0 py-3">${a.title}</a>`);"undefined"!=typeof PageKey&&PageKey.toLowerCase()==a.routerName.toLowerCase()&&($(n).addClass("active"),$(t).collapse("show"),o.find(".accordion-header").addClass("active")),d.append(n)})),e.find(".accordion").append(o)}else{const t=null!=i.routerName&&""!=i.routerName?i.routerName:i.linkUrl;var r=$(`<div class="accordion-item border-0 border-bottom px-1"><a href="${t}" title="連結至：${i.title}" class="list-group-item border-0 py-3 custom_h5 text-black"><span>${i.title}<span></a></div>`);if(null!=i.imgUrl&&""!=i.imgUrl){const e=$('<img alt=" " />');null==i.overImgUrl||"undefined"!=typeof PageKey&&t.toLowerCase().indexOf(PageKey.toLowerCase())>=0?e.attr("src",i.imgUrl):e.attr("src",i.overImgUrl),$(r).find("a").removeClass("py-3").addClass("p-0 imgMenu").append(e)}"undefined"!=typeof PageKey&&PageKey.toLowerCase()==i.routerName.toLowerCase()&&$(r).find("a").addClass("active"),e.find(".accordion").append(r)}})),$(".selectList").length>0&&$(window).trigger("resize.selectList")}})))})),1==e&&("onhashchange"in window?window.onhashchange=hashChangeDirectory:setInterval(hashChangeDirectory,1e3))}function hashChangeDirectory(e){e?(initElemntAndLoadDir(),e.preventDefault()):console.log("HashChange錯誤")}function DirectoryDataGet(e,t){const a=$(".catalog_frame").length;let n=parseInt(t.Page);"search"==e.data("type")?$.extend(!0,t,{Type:"search",SearchText:e.data("search-text").toString(),StartDate:e.data("startDate"),EndDate:e.data("endDate")}):"undefined"!=e.data("type")&&$.extend(!0,t,{Type:e.data("type")}),Directory.getDirectoryData(t).done((function(i){let o=2;"search"==t.Type&&$(".searchCount").text(i.totalCount),e.find(".page-item").each((function(){var e=$(this);e.hasClass("btn_prev")||e.hasClass("btn_next")||e.remove()})),i.totalPage<=1?e.find(".page_btn").addClass("d-none"):e.find(".page_btn").removeClass("d-none"),n>i.totalPage?n=i.totalPage:n<1&&(n=1),1==n?e.find(".btn_prev").addClass("d-none"):e.find(".btn_prev").removeClass("d-none"),n==i.totalPage?e.find(".btn_next").addClass("d-none"):e.find(".btn_next").removeClass("d-none"),1!=n&&n!=i.totalPage||(o=4);for(var d=1;d<=i.totalPage;d++)1==d?d==n?e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>1</span></li>`):(e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="第一頁" data-page=${d}>1</button></li>`),n-o-1>0&&e.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>')):d==i.totalPage?d==n?e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>${i.totalPage}</span></li>`):(n+o+1<i.totalPage&&e.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>'),e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="最後一頁" data-page=${d}>${i.totalPage}</button></li>`)):d>=n-o&&d<=n+o&&(d==n?e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>${d}</span></li>`):e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="移動至第${d}頁" data-page=${d}>${d}</button></li>`));$(".btn_page").off("click").on("click",(function(){var t=$(this);n!=t.data("page")&&(n=t.data("page"),1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(e,n)),e.goTo()})),e.data("init")||(e.find(".btn_prev > button").on("click",(function(){var t=$(this);n=parseInt(e.data("page"))-1,t.data("page",n),n>=1&&(1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(e,t.data("page"))),e.goTo()})),e.find(".btn_next > button").on("click",(function(){var t=$(this);n=parseInt(e.data("page"))+1,t.data("page",n),n<=i.totalPage&&(1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(e,t.data("page"))),e.goTo()}))),e.data("init","true"),DirectoryDataInsert(e,i.releInfos),e.data({filter:i.filter,directoryType:i.directoryType}).trigger("load")}))}function DirectoryDataInsert(e,t){if(null==t)return;const a=e.find(".templatecontent").html(),n=e.find(".templatecontent-tag").html(),i="search"==e.data("type");0==t.length?e.find(".catalog").addClass("empty"):e.find(".catalog").removeClass("empty"),null!=t&&t.forEach((function(t){var o=$(a).clone();let d,r;if(i||window.location.pathname.toLowerCase().indexOf("search")>0){if(3===t.type)d=`${null==t.orgName?"":`/${t.orgName}`}/${t.link}`;else d=`${null==t.orgName?"":`/${t.orgName}`}/search/${t.link}`;if(void 0!==e.data("search-text")&&""!=e.data("search-text")&&(d=`${d}/${e.data("search-text")}`),r="_blank",t.mainImage.indexOf("youtu")>0){var l="",s=t.mainImage.match(/^.*(?:(?:youtu.be\/|v\/|vi\/|u\/w\/|embed\/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*/);null!=s&&s.length>0&&(l=s[1]),t.mainImage="https://img.youtube.com/vi/"+l+"/mqdefault.jpg"}}else d=(window.location.pathname.indexOf(t.orgName)>0?window.location.pathname:`${null==t.orgName?"":`/${t.orgName}`}${window.location.pathname}`)+t.link,r="_self";1==t.type&&0!=t.status&&o.find("a").append(`<span class="status status${t.status}">${t.statusName}</span>`),d=d.replace("//","/");const c={href:d,title:`連結至: ${t.title}${"_blank"==r?"(另開視窗)":""}`,target:r};"A"==o[0].tagName?o.attr(c):o.find("a").attr(c);var g=t.mainImage||"/images/noImg.jpg";if(null!=t.orgName&&("undefined"!=typeof IsFaPage&&"undefined"!=typeof OrgName&&!IsFaPage||"undefined"!=typeof OrgName&&OrgName!=t.orgName)&&(g=g.replace("upload",`upload/${t.orgName}`)),o.find("img").attr("src",g),o.find("img").imgCheck().attr("alt",`${t.title}的主要圖片`),o.find(".title").text(t.title),o.find(".description").html(t.description),o.find(".location").length>0&&(null==t.location||""==t.location)?o.find(".location").parents(".py-2").remove():o.find(".location").text(t.location),o.find(".address").length>0&&(null==t.address||""==t.address)?o.find(".address").parents(".py-2").remove():o.find(".address").text(t.address),null!=t.startTime&&""!=t.startTime){var p=new Date(t.startTime);o.find(".startTime").text(`${p.getFullYear()}/${p.getMonth()+1}/${p.getDate()}`)}else o.find(".startTime").each(((e,t)=>{"span"==t.tagName.toLowerCase()?$(t).parent().remove():$(t).remove()}));if(null!=t.nodeDate&&""!=t.nodeDate){var f=new Date(t.nodeDate);o.find(".date").text(`${f.getFullYear()}/${f.getMonth()+1}/${f.getDate()}`),o.find(".date-month").text(`${f.getMonth()+1}月`),o.find(".date-monthyear").text(`${f.getMonth()+1}/${f.getFullYear()}`),f.getDate()<10?o.find(".date-day").text(`0${f.getDate()}`):o.find(".date-day").text(`${f.getDate()}`),f.getMonth()<9?o.find(".date-month-number").text(`0${f.getMonth()+1}`):o.find(".date-month-number").text(`${f.getMonth()+1}`),o.find(".date-year").text(`${f.getFullYear()}`)}else o.find(".date,.date-month,date-monthyear,date-day").each(((e,t)=>{"span"==t.tagName.toLowerCase()?$(t).parent().remove():$(t).remove()}));if(null!=t.price){const e=e=>e.includes("~")?([price_low,price_mid,price_high]=e.split(" "),price_high):e,a=t=>Intl.NumberFormat().format(e(t));if(o.find(".normal-price").text(a(t.price)),o.find(".price-grid").text(a(t.price)),null!=t.itemNo&&""!=t.itemNo?o.find(".itemNo").text(t.itemNo):o.find(".itemNo").remove(),$tags=o.find(".tags"),$tags.empty(),t.tags.slice(0,2).forEach((e=>{let t=$(n).clone();t.text(e.tag_Name.slice(0,4)),$tags.append(t)})),t.tags.slice(2).forEach((e=>{let t=$(n).clone();t.text(e.tag_Name.slice(0,4)),t.addClass("more-tag d-none"),$tags.append(t)})),t.tags.length>2){let e=$(n).clone();e.text("..."),e.addClass("less-tag"),$tags.append(e)}$tags.children().each((function(){$(this).on("click",(function(){return location.href=`/${OrgName}/Search/Get/3/${$(this).text()}`,!1}))}))}else o.find(".itemNo,.price").remove();o.find(".shareBlock > a").remove(),o.find(".shareBlock").data("href",d),o.find("img").on("load.heigh",(function(){o.find(".shareBlock").css({top:o.find(".image_frame").height()+o.find(".itemNo").height()+30})})),e.find(".catalog").append(o)})),HoverEffectInit(),ShareBlockInit()}
function FrameInit(){$(".masonry").each((function(){var i=$(this);if(!i.data("isInit")){$(this).find(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-item"});i.data("isInit",!0)}}))}
function HoverEffectInit(){$(".hover_mask").each((function(){$(this).find(".hover_protrude_scale").each((function(){var i=$(this);i.hover((function(){i.siblings().each((function(){$(this).addClass("opacity-50")}))}),(function(){i.siblings().each((function(){$(this).removeClass("opacity-50")}))}))}))})),$(".black-bg .close").click((function(){$(".black-bg").fadeOut(500)})),$("#swiper1, #swiper2, #swiper3, #swiper4, #swiper5, #swiper6, #swiper7, #swiper8").click((function(){$(".black-bg").fadeIn(500)}))}function withebg(){$(".qual-width-images").mouseover((function(){var i=$(this).attr("id").substr(3);$(".image-overlay").not("#overlay"+i).css("display","block")})),$(".qual-width-images").mouseout((function(){$(".image-overlay").css("display","none")}))}
function LinkWithIconInit(){$(".link_with_icon").each((function(){var a=$(this),i=a.attr("href");if(a.find(".icon").empty(),void 0!==i){var o=i.substring(i.lastIndexOf(".")+1,i.length);switch(o){case"jpg":case"jpeg":case"png":case"gif":a.find(".icon").append('<i class="fa-solid fa-file-image" style="color: #ff9500;"></i>');break;case"pdf":a.find(".icon").append('<i class="fa-solid fa-file-pdf" style="color: #b30b00;"></i>');break;case"doc":case"docx":case"odt":a.find(".icon").append('<i class="fa-solid fa-file-word" style="color: #2c599d;"></i>');break;case"ppt":case"pptx":case"odp":a.find(".icon").append('<i class="fa-solid fa-file-powerpoint" style="color: #D04323;"></i>');case"xls":case"xlsx":case"ods":a.find(".icon").append('<i class="fa-solid fa-file-excel" style="color: #037945;"></i>');break;case"zip":case"rar":a.find(".icon").append('<i class="fa-solid fa-file-zipper"></i>');break;default:a.find(".icon").append('<i class="fa-solid fa-file" style="color: #999999;"></i>')}}void 0===a.attr("download")&&a.attr("download",local.UnnamedFile),a.attr("title",local.LinkToAndBlank.format(a.attr("download"))),a.find(".name").text(a.attr("download")),"pdf"==o?a.attr({target:"_blank"}).removeAttr("download"):new RegExp(`[.]{1}${o}$`,"gi").test(a.attr("download"))?a.attr("download",`${a.attr("download")}`):a.attr("download",`${a.attr("download")}.${o}`)}))}
function ShareBlockInit(){$(".shareBlock").each(((t,i)=>{if($this=$(i),void 0===$this.data("init")||!$this.data("init")){var a="";a="string"==typeof $this.data("href")?$this.data("href"):location.pathname,$this.cShare({description:"jQuery plugin - C Share buttons...",showButtons:["email","plurk","twitter","fb","line"],shareToText:local.shareTo,href:a}),$this.hover(ProShare),$this.data("init",!0)}}))}function ProShare(){$(this).toggleClass("show")}
function SitemapInit(){var e=function(e){return $.ajax({url:"/api/WebMenu/GetAll/",type:"GET",contentType:"application/json; charset=utf-8",data:{WebsiteID:e}})};"undefined"!=typeof SiteId?e(SiteId).done((function(e){CreateSitemap(e.maps)})):e(null).done((function(e){CreateSitemap(e.maps)}))}function CreateSitemap(e){var t=$(".sitemap_hierarchical_frame");t.append('<ul class=""></ul>');var a=1;e.forEach((function(e){var n=$($("#Hierarchical_First_Item").html()).clone(),l=n.find(".first");if(null!=e.children){l.text(`${a} ${e.title}`),n.append('<ul class="ps-5 ps-md-0 col-md-8 py-1"></ul>');var i=n.find("ul"),r=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Second_Item").html()).clone(),n=t.find(".second");if(n.attr("href",e.routerName),n.attr("alt",e.text),null!=e.children){n.removeClass("ps-4 ps-sm-3"),n.append(`<span class="d-flex d-md-none material-symbols-outlined position-absolute start-0">expand_more</span><span class="second p-sm-0 ps-2">${a}-${r} ${e.title}</span><span class="d-none d-md-flex material-symbols-outlined">navigate_next</span>`),t.append('<ul class="ps-5 ps-md-0 col-md-6"></ul>');var l=t.find("ul"),s=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Third_Item").html()).clone(),n=t.find(".third");n.attr("href",`${e.routerName}`),n.attr("alt",e.text),n.text(`${a}-${r}-${s} ${e.title}`),l.append(t),s++}))}else n.text(`${a}-${r} ${e.title}`);i.append(t),r++}))}else l.parent("div").parent("div").html(`<a class="first d-block text-black px-3 rounded-3" href="${e.routerName}" alt="${e.text}">${a} ${e.title}</a>`);t.append(n),a++}))}
function SwiperInit(e){var i={slidesPerView:1,spaceBetween:15};if($.fn.extend({swiperBindEven:function(e){const i=function(){e.autoplay.stop()},t=function(){e.autoplay.start()};$(this).find(".swiper").prepend($(this).find(".swiper_button_prev")),$(this).on("mouseover",i),$(this).find("a").on("focus",i),$(this).on("mouseout",t),$(this).find("a").on("blob",t),$(this).find("button").prop("disabled",!1)}}),$(".one_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var a="#"+t.attr("id")+" > .swiper";const l=$(a).find(".swiper-slide").length>=2;var r=t.data("effect"),n=t.data("effect-speed");void 0!==r&&!1!==r||(r="slide"),n=void 0===n||!1===n?300:parseInt(n);var s=!!e.autoplay&&l,p=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},effect:r,speed:n},s?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{},l?{navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"}}:{});l||$(`#${t.attr("id")}`).find(".swiper_button_next,.swiper_button_prev").remove();var o=new Swiper(a,p);t.data("isInit",!0),s&&o.slides.length-2>1&&t.swiperBindEven(o)}})),$(".two_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var a="#"+t.attr("id")+" > .swiper",r=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0,renderBullet:function(e,i){return t.has(".swiper_pagination_water").length?'<span class="'+i+' material-symbols-outlined ms-3">water_drop</span>':'<span class="'+i+'"></span>'}},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{400:{slidesPerView:1},1024:{slidesPerView:2}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),n=new Swiper(a,r);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(n),t.prepend($("#"+t.attr("id")+" .swiper_button_prev")),console.log(r)}})),$(".four_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var a="#"+t.attr("id")+" > .swiper",r=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper-pagination",clickable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{375:{slidesPerView:1},576:{slidesPerView:3},992:{slidesPerView:4}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),n=new Swiper(a,r);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(n),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".five_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var a="#"+t.attr("id")+" > .swiper",r=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},scrollbar:{el:".swiper-scrollbar",draggable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{320:{slidesPerView:2},375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:5}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),n=new Swiper(a,r);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(n),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".six_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){var a="#"+t.attr("id")+" > .swiper",r=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},scrollbar:{el:".swiper-scrollbar",draggable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next > button",prevEl:"#"+t.attr("id")+" .swiper_button_prev > button"},breakpoints:{320:{slidesPerView:2},375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:6}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),n=new Swiper(a,r);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(n),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".picture-category").length>0&&$("#SwiperModal").length>0){const e=new Swiper("#pictureSwiperThumbs",{spaceBetween:10,breakpoints:{375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:6}},freeMode:!0,watchSlidesProgress:!0}),i=new Swiper("#pictureSwiper",{centeredSlides:!0,spaceBetween:10,navigation:{nextEl:"#pictureSwiper .swiper-button-next",prevEl:"#pictureSwiper .swiper-button-prev"},pagination:{el:"#pictureSwiper .swiper-pagination"},thumbs:{swiper:e}});$(".picture-category a").attr("href","#SwiperModal").on("click",(function(){const t=$(this).parents(".picture-category"),a=$(".picture-category a").index(this),r=[];t.find(".templatecontent img").each((function(){r.push($(this).attr("src"))})),i.removeAllSlides(),e.removeAllSlides();for(let t=0;t<r.length;t++){const a=`<div class="swiper-slide"><img src="${r[t]}" alt=" " /></div>`;i.appendSlide(a),e.appendSlide(a)}return i.slideTo(a,0),e.slideTo(a,0),$("#SwiperModal").modal("show"),!1}))}}
const newEnum=e=>{const t={};return Object.keys(e).forEach((n=>{t[t[n]=e[n]]=n})),t},list_type=newEnum({grid:"Grid",list:"List",text:"Text",product_grid:"Product_Grid",product_list:"Product_List"}),display_configurations={[list_type.list]:["type1 bg-white",{".card-border":"card-border-rd type3",".catalog-number":"d-none",".check_btn":"check_btn-type3",".col":"p-1 type3 box-shadow",".description":"type3-content",".image":"px-0",".image_frame":"h-100",".imgh":"img-h",".item-header":"d-none",".like-and-share":"d-none",".max-h":"max-hei",".mergetag":"merge",".more-btn":"d-none",".more-tag":"d-none",".price-grid":"d-none",".purchase":"d-none",".related-tag":"d-none",".shareBlock":"d-none",".tags":"d-none",".title":"type1-title fw-bold p-2",figcaption:"flex-grow-1 p-3 py-0 py-md-3 pb1"}],[list_type.grid]:["type2 row row-cols-sm-4 bg-white",{".card-border":"card-border-rd type2",".catalog-number":"d-none",".check_btn":"w-100",".col":"p-1 type2 box-shadow",".date":"d-none",".description":"d-none type2-content",".image_frame":"w-100",".item-header":"d-none",".like-and-share":"d-none",".more":"d-none",".more-btn":"d-none",".more-tag":"d-none",".price-grid":"d-none",".purchase":"d-none",".related-tag":"d-none",".shareBlock":"d-none",".tags":"d-none",".title":"type1-title fw-bold p-2",figcaption:"pb1",figure:"flex-column"}],[list_type.text]:["type3 row row-cols-sm-4 bg-white",{".card-border":"pr3 type1",".catalog-number":"d-none",".check_btn":"w-100",".col":"p-1 type1 text-border box-shadow",".date":"d-none",".description":"d-none",".image":"d-none",".image_frame":"d-none",".item-header":"d-none",".like-and-share":"d-none",".more":"d-none",".more-tag":"d-none",".price-grid":"d-none",".purchase":"d-none",".related-tag":"d-none",".shareBlock":"d-none",".search-more":"d-none",".tags":"d-none",".title":"type2-title pr3 h-100",figure:"flex-column"}],[list_type.product_grid]:["type4 row row-cols-lg-4 row-cols-md-2 row-cols-2  bg-light px-2",{".card-border":"card-border-rd type2",".catalog-number":"d-none",".check_btn":"w-100",".col":"p-1 type4 rounded-lg h-100",".date":"d-none",".description":"d-none type2-content",".image_frame":"type4-image-frame w-100",".item-header":"d-flex",".like-and-share":"d-none",".more":"d-none",".more-btn":"d-none",".more-tag":"d-none",".purchase":"d-none",".shareBlock":"type4",".tags":"align-text-bottom",".title":"type4-title d-inline fs-6",figcaption:"pb1 type4-caption d-flex flex-column",figure:"flex-column"}],[list_type.product_list]:["type1 bg-light px-2",{".bottom-row":"mt-auto",".card-border":"card-border-rd type2",".catalog-number":"type4-title d-inline",".check_btn":"check_btn-type3",".col":" type5 rounded-lg",".description":"type3-content",".image":"px-0",".image_frame":"type5-image-frame",".imgh":"img-h",".item-header":"d-none",".item-title":"d-lg-flex",".less-tag":"d-none",".like-and-share":"d-inline ms-auto fs-5 p-2",".max-h":"max-hei",".mergetag":"merge",".more":"d-none",".more-btn":"d-none",".price-grid":"d-none",".purchase":"ms-auto d-inline",".related-tag":"d-none",".shareBlock":"type5",".tags":"mt-auto mb-2 align-text-bottom d-lg-flex",".title":"type4-title d-inline fs-6 p-2",figcaption:"flex-grow-1 d-flex flex-column"}]};function ViewTypeChangeInit(){$(".type_change_frame").each((function(){var e=$(this);if(!e.data("isInit")){const n=e.find(".btn_grid"),o=e.find(".btn_list"),d=e.find(".btn_text"),r=e.find(".btn_prod_grid"),i=e.find(".btn_prod_list"),a=e.find(".content").first(),c={[list_type.grid]:n,[list_type.list]:o,[list_type.text]:d,[list_type.product_grid]:r,[list_type.product_list]:i};for(const[e,t]of Object.entries(c))t.on("click",(function(){t.data("activate")||typeChange(t,c,a,e)}));n.length>0&&!n.hasClass("d-none")?n.trigger("click"):o.length>0&&!o.hasClass("d-none")?o.trigger("click"):r.length>0&&!r.hasClass("d-none")?r.trigger("click"):i.length>0&&!i.hasClass("d-none")?i.trigger("click"):d.length>0&&!d.hasClass("d-none")&&d.trigger("click");var t=0;for(const[e,n]of Object.entries(c))(0===n.length||n.hasClass("d-none"))&&(t+=1);t>=4?e.find(".switch_control").addClass("d-none"):e.find(".switch_control").removeClass("d-none")}e.data("isInit",!0)}))}function updateStyle(e,t){for(const[t,n]of Object.entries(display_configurations)){e.removeClass(n[0]);for(const[t,o]of Object.entries(n[1]))e.find(t).removeClass(o)}e.addClass(t[0]);for(const[n,o]of Object.entries(t[1]))e.find(n).addClass(o)}function typeChange(e,t,n,o){for(const[e,n]of Object.entries(t))n.data("activate",0),n.addClass("text-black-50");e.data("activate",1),e.removeClass("text-black-50"),n.each((function(){updateStyle($(this),display_configurations[o])}))}
function date_input_change(t){var a=$(`#${t}`),n=a.attr("date-date-strat-date"),e=a.attr("data-date-end"),i=a.attr("data-location"),d=a.attr("data-addr"),r=a.attr("data-organizer"),s=a.attr("data-a-organizer"),l=a.attr("data-link"),o=a.attr("data-tel"),v=a.find(".activity_start_time").parents("div").eq(1);""==n&&""==e?$(v).addClass("d-none"):$(v).removeClass("d-none");var f=a.find(".activity_location").parents("div").eq(0);""==i?$(f).addClass("d-none"):($(f).find("a").attr({href:`https://www.google.com.tw/maps/place/${i}`,title:`連結至：${i}(另開新視窗)`,target:"_blank"}),$(f).removeClass("d-none"));var c=a.find(".activity_addr").parents("div").eq(0);""==d?$(c).addClass("d-none"):($(c).find("a").attr({href:`https://www.google.com.tw/maps/place/${d}`,title:`連結至：${d}(另開新視窗)`,target:"_blank"}),$(c).removeClass("d-none"));var h=a.find(".activity-organizer").parent("div").eq(0);""==r?$(h).addClass("d-none"):$(h).removeClass("d-none");var m=a.find(".activity-a-organizer").parent("div").eq(0);""==s?$(m).addClass("d-none"):$(m).removeClass("d-none");var _=a.find(".activity_link").parents("div").eq(0);""==l?$(_).addClass("d-none"):($(_).find("a").attr({href:l,title:"連結至：活動網站(另開新視窗)",target:"_blank"}),$(_).removeClass("d-none"));var C=a.find(".activity_tel").parents("div").eq(0);return""==o?$(C).addClass("d-none"):($(C).find("a").attr({href:`tel:${o}`,title:`播打電話：${o}`,target:"_blank"}),$(C).removeClass("d-none")),a.find(".activity_start_time").html(n),a.find(".activity_end_time").html(e),a.find(".activity_location").html(i),a.find(".activity_addr").html(d),a.find(".activity-organizer").html(r),a.find(".activity-a-organizer").html(s),a.find(".activity_link").html(l),a.find(".activity_tel").html(o),a.html()}function namecontrol(t){const a=$("#"+t),n=a.find(".btn_text"),e=a.find(".btn_grid"),i=a.find(".btn_list"),d=a.parents(".type_change_frame").first().find(".content").first();n.hasClass("d-none")?n.hasClass("d-none")&&!e.hasClass("d-none")?typeChange(e,i,n,d,"Grid"):n.hasClass("d-none")&&e.hasClass("d-none")&&!i.hasClass("d-none")&&typeChange(i,e,n,d,"List"):typeChange(n,e,i,d,"Text")}
function setContact(){$(".ContactForm").contactInit()}document.addEventListener("DOMContentLoaded",(()=>{$.fn.extend({contactInit:function(){$(this).each((function(){$(this).setContact()}))},setContact:function(){const e=this.get(0),t=this,n=t.find('[name="captcha"]'),a=t.find(".img-fluid").last();$("#ContactForm .btn_refresh").off("click").on("click",(()=>{NewCaptcha(a,n,"ContactUs")})),$("#ContactForm .btn_refresh").trigger("click"),t.getFormJson(),e.addEventListener("submit",(o=>{if(o.preventDefault(),o.stopPropagation(),e.classList.add("was-validated"),e.checkValidity()){o.preventDefault();const e={Email:"",Name:""},r=t.find('[name="sender"]');if("SELECT"==r.get(0).tagName){const t=r.find("option:selected");e.Email=t.val(),e.Name=t.text()}else e.Email=r.val(),e.Name=r.data("title");if(""==e.Email)return void co.sweet.error(local.InformationError,local.NoSelectSender);$.ajax({url:"/api/Contact/submit",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({routerName:PageKey,sender:e,forms:t.getFormJson()}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(e){e.success?(Coker.sweet.success(local.SentSuccessfully,null,!0),t.removeClass("was-validated"),t.get(0).reset()):Coker.sweet.error(local.FailedToSend,e.error,null,!0),NewCaptcha(a,n,"ContactUs")}))}else NewCaptcha(a,n,"ContactUs"),Coker.sweet.error(local.Error,local.FormSubmitMessage,null,!0)}),!1),document.addEventListener("keyup",(function(e){var t=e.target;if("INPUT"==t.nodeName&&t.value.length==t.maxLength){var n=$(t).parents("form").first().find("input");for(let e=0;e<n.length;e++)if(n[e]==t)return void(n[e+1]&&n[e+1].focus())}}))}})}));
"use strict";const setBGCanvas=function(){const t=[1,1.1,1.8],n=[.8,1.1,2.2],i=[.9,1.1,2],e=[1,1.1,1.5];let a=null;$.fn.extend({BGCanvas:function(){const t=$(this),n=function(){if(!isNaN(t.data("type"))&&1===parseInt(t.data("type")))t.BGCanvasType1()};return 0==t.height()?t.find("img").on("load",(function(){n()})):n(),t},BGCanvasType1:function(){let s=$(this),o=$(this);if(0!=s.length&&"canvas"!=s.get(0).tagName.toLowerCase()&&0==s.find("canvas").length&&(o=$("<canvas>"),s.append(o)),0==s.length)return s;var h,r,l,d=45,c=.25;const{sin:g,cos:f,PI:u,sqrt:w,random:y,floor:v,ceil:p,round:C,abs:x}=Math;return function(){var w=o.get(0),v=w.getContext("2d");function p(){a=window.innerWidth>1500?t:window.innerWidth>1200?n:window.innerWidth>768?i:e,h=s.width()*a[0],r=s.height()*a[0],console.log(a),w.width=h,w.height=r,l=(h<r?h:r)/2,v.fillStyle="rgba(245,251,251,0)",v.fillRect(0,0,h,r)}function x(){this.ang=2*u*y(),this.dang=(-.5+y())/40,this.r=2*l/a[2],this.x=h/2+this.r*f(this.ang),this.y=r/2+a[1]*this.r*g(this.ang),this.update=function(){this.ang+=this.dang,this.x=h/2+this.r*f(this.ang),this.y=r/2+a[1]*this.r*g(this.ang)}}p(),window.onresize=p;var $=[];for(let t=0;t<18;t++)$.push(new x);!function t(){v.fillStyle="rgba(255,255,255,0.03)",v.fillRect(0,0,h,r),v.beginPath(),v.moveTo(($[0].x+$[17].x)/2,($[0].y+$[17].y)/2);for(let t=0;t<18;t++){let n=t+1;18==n&&(n=0),v.quadraticCurveTo($[t].x,$[t].y,($[t].x+$[n].x)/2,($[t].y+$[n].y)/2),$[t].update()}v.strokeStyle=`hsl(${C(180+d)}deg, 100%, 70%)`,v.lineWidth=2*l/432,v.stroke(),v.shadowColor="transparent",((d+=c)>=100||d<=45)&&(c=-c),45==d&&(v.fillStyle="rgba(0,0,0,0)",v.fillRect(0,0,h,r)),window.requestAnimationFrame(t)}()}(),s}}),$(".BGCanvas").BGCanvas()};
var FileApi={insertNotFondFile:function(e){return e.from=location.href,$.ajax({url:"/api/File/insertNotFondFile",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})}};function jqueryExtend(){$.fn.extend({imgCheck:function(){var e=$(this);return e.each((function(e,t){$(t).on("error",(function(){FileApi.insertNotFondFile({Url:$(t).attr("src"),FK_WebsiteID:"undefined"==typeof SiteId?0:SiteId}),$(t).attr("src","/images/noImg.jpg")}))})),e}}),$.extend({htmlDecode:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value.replace(/\n/g,"<br />")},loadCss:function(e){const t=$.Deferred();let n=document.getElementsByTagName("HEAD")[0],r=document.createElement("link");return r.rel="stylesheet",r.type="text/css",r.href=e,r.onload=function(){t.resolve()},n.appendChild(r),t.promise()},LoadJs:function(e){const t=$.Deferred();let n=document.getElementsByTagName("HEAD")[0],r=document.createElement("script");return r.type="text/javascript",r.src=e,r.onload=function(){t.resolve()},n.appendChild(r),t.promise()}})}String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,(function(t,n){return void 0!==e[n]?e[n]:t}))});
function FlipBookInit(){var e=$(".FlipBook");if(e.addClass("d-none"),void 0!==e.data("pdf")&&e.data("pdf"))var o=e.data("pdf");else console.log("No PDF file specified for FlipBook"),o="/lib/pdf-viewer/external/pdfjs-2.1.266-dist/web/compressed.tracemonkey-pldi-09.pdf";console.log(o);var t=document.createElement("div"),i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&(200==this.status&&(t.innerHTML=this.responseText),404==this.status&&(t.innerHTML="Page not found."),e.append(t),e.removeClass("d-none"),$(".FlipBookModal").length>0&&FlipBookModalInit())},i.open("GET","/lib/pdf-viewer/external/pdfjs-2.1.266-dist/web/viewer.html?file="+encodeURIComponent(o),!0),i.send()}function FlipBookModalInit(){$(".FlipBookModal").on("show.bs.modal",(e=>{var o=e.relatedTarget.getAttribute("data-pdf-url");console.log(o),PDFViewerApplication.setInitialView(),PDFViewerApplication.open({url:o,originalUrl:o})}))}
function MapMessage(){$.loadCss("https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap"),void 0===window.counterUp?$.LoadJs("/lib/counterup2/index.js").done(setCounter):setCounter();const a=function(a){const e=$(`${$(this).attr("href")||`#${$(this).data("area")}`}`);window.scrollY;$(".MapMessage .active").removeClass("active"),e.addClass("active"),$(`.MapMessage .mapData [data-Area="${e.attr("id")}"]`).addClass("active");const s=window.counterUp.default;return $(".MapMessage .counter").each(((a,e)=>{s(e,{duration:500,delay:16})})),!1};$(".MapMessage map>area").on("click",a),$(".MapMessage map>area,.mapData li").on("mouseover",a)}function setCounter(){const a=window.counterUp.default,e=new IntersectionObserver((e=>{e.forEach((e=>{const s=e.target;e.isIntersecting&&!s.classList.contains("is-visible")&&(a(s,{duration:2e3,delay:16}),s.classList.add("is-visible"))}))}),{threshold:1});document.querySelectorAll(".MapMessage .counter").forEach((a=>{e.observe(a)}))}