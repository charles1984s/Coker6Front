function AnchorPointInit(){const e={childList:!0,subtree:!0},t=$('[data-gjs-type="wrapper"]');if(t.length>0&&void 0===t.data("observer")){const n=function(n,i){i.disconnect();for(const e of n)"childList"===e.type&&($(".anchor_directory").removeClass("selectList"),AnchorPointInit());i.observe(t[0],e)},i=new MutationObserver(n);i.observe(t[0],e),t.data("observer",i)}$(".anchor_directory:not(.selectList)").each((function(){var e=$(this);e.children("ul").empty(),$(".anchor_title").each((function(){var t=$(this),n=t.text().indexOf("\n")>-1?t.text().replace(/\n/g,""):t.text();e.children("ul").append(`<li class="fs-5"><a class="text-black text-decoration-none" href="#${t.attr("id")}"><div class="p-2 px-4">${n}</div></a></li>`)})),e.find('a[href^="#"]').on("click",(function(e){var t=$(this).attr("href"),n=$(t).offset().top-50;$("nav").hasClass("position-fixed")&&(n-=$("nav").outerHeight()-10),$("html, body").animate({scrollTop:n},0),e.preventDefault()})),e.addClass("selectList")})),$(window).off("resize.selectList").on("resize.selectList",(e=>{$(".selectList").each(((e,t)=>{const n=$(t);if(0==n.find("select").length||1==n.find("select").children().length){const e=n.find("a"),t=$("<select id='jampSelect'>"),i=$("<label for='jampSelect' class='d-none'>").text("前往：");if(n.find("select").remove(),n.find('a[href^="#"]').length>0)t.append($("<option>").val("").text("請選擇將前往的標籤"));else{const e=n.data("option-text")||"請選擇前往的頁面";t.append($("<option>").val("").text(e))}e.each(((e,n)=>{t.append($("<option>").data("trigger",n).val(n.href).text($(n).text()))})),t.on("change",(function(){const e=t.children(":selected");/^#/.test(e.val())?e.data("trigger").trigger("click"):location.href=e.val();const n=e.val().split("#")[1],i=$("#"+n);$("nav").hasClass("position-fixed")&&$("html, body").animate({scrollTop:i.offset().top-$("nav").outerHeight()-10})})),n.append(i).append(t)}$(window).width()>576?(n.children().first().removeClass("d-none"),n.children("select").addClass("d-none")):(n.children().first().addClass("d-none"),n.children("select").removeClass("d-none"))}))})),$(window).trigger("resize.selectList")}
var Directory={getDirectoryData:function(e){return $.ajax({url:"/api/Directory/GetReleInfo",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})},getDirectoryMenuData:function(e){return $.ajax({url:"/api/Directory/GetReleMenu",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})},getDirectoryAdvertiseData:function(e){return $.ajax({url:"/api/Directory/GetReleAd",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})}},Advertise={ActivityClick:function(e){return $.ajax({url:"/api/Advertise/ActivityClick/",type:"GET",contentType:"application/json; charset=utf-8",data:{FK_Aid:e}})},ActivityExposure:function(e){return $.ajax({url:"/api/Advertise/ActivityExposure/",type:"GET",contentType:"application/json; charset=utf-8",data:{FK_Aid:e}})}};function initElemntAndLoadDir(e,t){const a=e||$(".catalog_frame").first();var n=a.find(".templatecontent").siblings();if(n.length>0)for(i=0;i<n.length;i++)$(n[i]).hasClass("templatecontent-tag")||n[i].remove();const d=void 0!==a.data("dirid")?"string"==typeof a.data("dirid")?a.data("dirid").split(","):[a.data("dirid")]:0;a.data("prevdirid",d);const o=void 0!==a.data("shownum")?a.data("shownum"):12,r=void 0!==a.data("maxlen")&&""!=a.data("maxlen")?a.data("maxlen"):0,l=t?t.toString():location.hash.replace("#",""),s=a.hasClass("getlatlng"),c=void 0!==a.data("longitude")?a.data("longitude"):null,p=void 0!==a.data("latitude")?a.data("latitude"):null;if((void 0===a.data("page")||a.data("page")!=l)&&(t=isNaN(l)||""==l?"1":l,1!=d.length||""!=d[0])){const i={Ids:d,SiteId:"undefined"==typeof SiteId?0:SiteId,Page:t,ShowNum:o,MaxLen:void 0===r?0:r,Filters:a.data("filtered"),directoryType:a.data("directoryTypeChecked"),target:void 0===a.data("target")?null:a.data("target"),FindNearest:s,Longitude:c,Latitude:p};a.find(".catalog>.template").remove(),DirectoryDataGet(a,i),a.off("filter").on("filter",(function(){a.removeData("page"),initElemntAndLoadDir(e,t)})),a.data("page",t)}}function DirectoryGetDataInit(){const e=$(".catalog_frame").length;$(".catalog_frame").each((function(){const e=$(this),t=void 0!==e.data("dirid")?"string"==typeof e.data("dirid")?e.data("dirid").split(","):[e.data("dirid")]:0;void 0!==e.data("prevdirid")&&t==e.data("prevdirid")||initElemntAndLoadDir($(this))})),$(".menu_directory").each((function(){var e=$(this);const t=void 0!==e.data("dirid")?"string"==typeof e.data("dirid")?e.data("dirid").split(","):[e.data("dirid")]:0;var a=void 0!==e.attr("data-show-unvisible")&&"true"==e.attr("data-show-unvisible").toLowerCase();void 0!==e.data("prevdirid")&&t==e.data("prevdirid")||(e.data("prevdirid",t),e.find(".title").text(""),e.find(".accordion").empty(),Directory.getDirectoryMenuData({Ids:t,WebsiteId:"undefined"!=typeof SiteId?SiteId:0,showUnvisible:a}).done((function(t){if(void 0!==t){e.find(".title").text(t.title);const a=`#${e.find(".accordion").attr("id")}`;$.each(t.children,(function(i,n){if(e.find(".title").text(t.title),null!=n.children){var d=$($("#TemplateAccordionItem").html()).clone();d.find(".sectitle").text(n.title),d.find(".accordion-header").attr("id",`secheader${n.id}`);const t=d.find(".accordion-collapse").attr({"aria-labelledby":`secheader${n.id}`,id:`seccollapse${n.id}`,"data-bs-parent":`${a}`});d.find(".accordion-button").attr({"data-bs-target":`#seccollapse${n.id}`,"aria-controls":`seccollapse${n.id}`});var o=d.find(".accordion-body");$.each(n.children,(function(e,a){const i=$(`<a href="${a.routerName}" title="連結至：${a.title}" class="list-group-item list-group-item-action border-0 py-3">${a.title}</a>`);"undefined"!=typeof PageKey&&PageKey.toLowerCase()==a.routerName.toLowerCase()&&($(i).addClass("active"),$(t).collapse("show"),d.find(".accordion-header").addClass("active")),o.append(i)})),e.find(".accordion").append(d)}else{const t=null!=n.routerName&&""!=n.routerName?n.routerName:n.linkUrl;var r=$(`<div class="accordion-item border-0 border-bottom px-1"><a href="${t}" title="連結至：${n.title}" class="list-group-item border-0 py-3 custom_h5 text-black"><span>${n.title}<span></a></div>`);if(null!=n.imgUrl&&""!=n.imgUrl){const e=$('<img alt=" " />');null==n.overImgUrl||"undefined"!=typeof PageKey&&t.toLowerCase().indexOf(PageKey.toLowerCase())>=0?e.attr("src",n.imgUrl):e.attr("src",n.overImgUrl),$(r).find("a").removeClass("py-3").addClass("p-0 imgMenu").append(e)}"undefined"!=typeof PageKey&&PageKey.toLowerCase()==n.routerName.toLowerCase()&&$(r).find("a").addClass("active"),e.find(".accordion").append(r)}})),$(".selectList").length>0&&$(window).trigger("resize.selectList")}})))})),$(".advertise_directory").each((function(){const e=$(this),t=void 0!==e.data("dirid")?"string"==typeof e.data("dirid")?e.data("dirid").split(","):[e.data("dirid")]:0;Directory.getDirectoryAdvertiseData({Ids:t,WebsiteId:"undefined"!=typeof SiteId?SiteId:0,showUnvisible:!0}).done((function(t){DirectoryAdDataInsert(e,t)}))})),1==e&&("onhashchange"in window?window.onhashchange=hashChangeDirectory:setInterval(hashChangeDirectory,1e3))}function hashChangeDirectory(e){e?(initElemntAndLoadDir(),e.preventDefault()):console.log("HashChange錯誤")}function DirectoryDataGet(e,t){const a=$(".catalog_frame").length;let i=parseInt(t.Page);"search"==e.data("type")?$.extend(!0,t,{Type:"search",SearchText:e.data("search-text").toString(),StartDate:e.data("startDate"),EndDate:e.data("endDate")}):"undefined"!=e.data("type")&&$.extend(!0,t,{Type:e.data("type")}),Directory.getDirectoryData(t).done((function(n){let d=2;"search"==t.Type&&$(".searchCount").text(n.totalCount),e.find(".page-item").each((function(){var e=$(this);e.hasClass("btn_prev")||e.hasClass("btn_next")||e.remove()})),n.totalPage<=1?e.find(".page_btn").addClass("d-none"):e.find(".page_btn").removeClass("d-none"),i>n.totalPage?i=n.totalPage:i<1&&(i=1),1==i?e.find(".btn_prev").addClass("d-none"):e.find(".btn_prev").removeClass("d-none"),i==n.totalPage?e.find(".btn_next").addClass("d-none"):e.find(".btn_next").removeClass("d-none"),1!=i&&i!=n.totalPage||(d=4);for(var o=1;o<=n.totalPage;o++)1==o?o==i?e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${o}>1</span></li>`):(e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="第一頁" data-page=${o}>1</button></li>`),i-d-1>0&&e.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>')):o==n.totalPage?o==i?e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${o}>${n.totalPage}</span></li>`):(i+d+1<n.totalPage&&e.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>'),e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="最後一頁" data-page=${o}>${n.totalPage}</button></li>`)):o>=i-d&&o<=i+d&&(o==i?e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${o}>${o}</span></li>`):e.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="移動至第${o}頁" data-page=${o}>${o}</button></li>`));if($(".btn_page").off("click").on("click",(function(){var t=$(this);i!=t.data("page")&&(i=t.data("page"),1==a&&window.location.hash!=`#${i}`?window.location.hash=`#${i}`:initElemntAndLoadDir(e,i)),e.goTo()})),e.data("init")||(e.find(".btn_prev > button").on("click",(function(){var t=$(this);i=parseInt(e.data("page"))-1,t.data("page",i),i>=1&&(1==a&&window.location.hash!=`#${i}`?window.location.hash=`#${i}`:initElemntAndLoadDir(e,t.data("page"))),e.goTo()})),e.find(".btn_next > button").on("click",(function(){var t=$(this);i=parseInt(e.data("page"))+1,t.data("page",i),i<=n.totalPage&&(1==a&&window.location.hash!=`#${i}`?window.location.hash=`#${i}`:initElemntAndLoadDir(e,t.data("page"))),e.goTo()}))),e.data("init","true"),DirectoryDataInsert(e,n.releInfos),e.data({filter:n.filter,directoryType:n.directoryType}).trigger("load"),e.hasClass("swiper")||e.find(".swiper").length>0||e.hasClass("swiper-wrapper")){let t;t=e.hasClass("swiper")?e:e.find(".swiper").length>0?e.find(".swiper"):e.parents(".swiper"),void 0!==$(t).data("isInit")&&$(t).data("isInit")&&t[0].swiper.destroy(!0,!0),t.parents('[class*="_swiper"]').data("isInit",!1),SwiperInit({autoplay:!0})}}))}function DirectoryDataInsert(e,t){if(null==t)return;const a=e.find(".templatecontent").html(),i=e.find(".templatecontent-tag").html(),n="search"==e.data("type"),d=void 0===e.data("dirpath")?"":e.data("dirpath").toLowerCase();0==t.length?e.find(".catalog").addClass("empty"):e.find(".catalog").removeClass("empty"),null!=t&&t.forEach((function(t){var o=$(a).clone();let r,l;if(n||window.location.pathname.toLowerCase().indexOf("search")>0||window.location.pathname.toLowerCase().indexOf("techcert")>0){if(3===t.type)r=`${null==t.orgName?"":`/${t.orgName}`}/${t.link}`;else r=`${null==t.orgName?"":`/${t.orgName}`}/search/${t.link}`;if(void 0!==e.data("search-text")&&""!=e.data("search-text")&&(r=`${r}/${e.data("search-text")}`),l="_blank",t.mainImage.indexOf("youtu")>0){var s="",c=t.mainImage.match(/^.*(?:(?:youtu.be\/|v\/|vi\/|u\/w\/|embed\/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*/);null!=c&&c.length>0&&(s=c[1]),t.mainImage="https://img.youtube.com/vi/"+s+"/mqdefault.jpg"}}else r=(window.location.pathname.indexOf(t.orgName)>0&&window.location.pathname.toLowerCase().indexOf("home")<0&&window.location.pathname.toLowerCase().indexOf(d)>=0?window.location.pathname:`${null==t.orgName?"":`/${t.orgName}`}${""==d?null==t.orgName?window.location.pathname:window.location.pathname.toLowerCase().replace(`${t.orgName.toLowerCase()}`,""):`/${d}`}`)+t.link,l="_self";1==t.type&&0!=t.status&&o.find("a").append(`<span class="status status${t.status}">${t.statusName}</span>`),/^http/.test(r)||(r=r.replace("//","/"));const p={href:r,title:`連結至: ${t.title}${"_blank"==l?"(另開視窗)":""}`,target:l};o.length>0&&("A"==o[0].tagName?o.attr(p):o.find("a").attr(p)),e.hasClass("cross_graphics_frame")&&""==t.mainImage&&o.children("div:first").addClass("d-none"),e.hasClass("getlatlng")&&(o.find(".dirname").text(t.dirname),o.find(".dirname").removeClass("d-none"));var f=t.mainImage||"/images/noImg.jpg";if(null!=t.orgName&&("undefined"!=typeof IsFaPage&&"undefined"!=typeof OrgName&&!IsFaPage||"undefined"!=typeof OrgName&&OrgName!=t.orgName)&&(f=f.replace("upload",`upload/${t.orgName}`)),o.find("img").attr("src",f),o.find("img").imgCheck().attr("alt",`${t.title}的主要圖片`),o.find(".title").text(t.title),o.find(".subtitle").text(t.subtitle),o.find(".description").html(t.description),o.find("a img").length&&o.find("a").find("h3,h4,h5,h6").length&&o.find("img").imgCheck().attr("alt",""),o.find(".location").length>0&&(null==t.location||""==t.location)?o.find(".location").parents(".py-2").remove():o.find(".location").text(t.location),o.find(".address").length>0&&(null==t.address||""==t.address)?o.find(".address").parents(".py-2").remove():o.find(".address").text(t.address),null!=t.startTime&&""!=t.startTime){var g=new Date(t.startTime);o.find(".startTime").text(`${g.getFullYear()}/${g.getMonth()+1}/${g.getDate()}`)}else o.find(".startTime").each(((e,t)=>{"span"==t.tagName.toLowerCase()?$(t).parent().remove():$(t).remove()}));if(null!=t.nodeDate&&""!=t.nodeDate){var m=new Date(t.nodeDate);o.find(".date").text(`${m.getFullYear()}/${m.getMonth()+1}/${m.getDate()}`),o.find(".date-month").text(`${m.getMonth()+1}月`),o.find(".date-monthyear").text(`${m.getMonth()+1}/${m.getFullYear()}`),m.getDate()<10?o.find(".date-day").text(`0${m.getDate()}`):o.find(".date-day").text(`${m.getDate()}`),m.getMonth()<9?o.find(".date-month-number").text(`0${m.getMonth()+1}`):o.find(".date-month-number").text(`${m.getMonth()+1}`),o.find(".date-year").text(`${m.getFullYear()}`)}else o.find(".date,.date-month,date-monthyear,date-day").each(((e,t)=>{"span"==t.tagName.toLowerCase()?$(t).parent().remove():$(t).remove()}));if(null!=t.price){const e=e=>e.includes("~")?([price_low,price_mid,price_high]=e.split(" "),price_high):e,a=t=>Intl.NumberFormat().format(e(t));o.find(".normal-price").text(a(t.price)),o.find(".price-grid").text(a(t.price))}else o.find(".price").addClass("notshow"),o.find(".price").text("");if(null!=t.itemNo&&""!=t.itemNo?o.find(".itemNo").text(t.itemNo):o.find(".itemNo").remove(),$tags=o.find(".tags"),$tags.empty(),null==t.tags&&(t.tags=[]),t.tags.slice(0,2).forEach((e=>{let t=$(i).clone();t.text(e.tag_Name.slice(0,4)),$tags.append(t)})),t.tags.slice(2).forEach((e=>{let t=$(i).clone();t.text(e.tag_Name.slice(0,4)),t.addClass("more-tag d-none"),$tags.append(t)})),t.tags.length>2){let e=$(i).clone();e.text("..."),e.addClass("less-tag"),$tags.append(e)}$tags.children().each((function(){$(this).on("click",(function(){return location.href=`/${OrgName}/Search/Get/3/${$(this).text()}`,!1}))})),o.find(".shareBlock").data("init",!1),o.find(".shareBlock > a").remove(),o.find(".shareBlock").data("href",r),e.find(".catalog").append(o)})),HoverEffectInit(),ShareBlockInit()}function DirectoryAdDataInsert(e,t){if(e.find(".swiper").length>0)for(var a=e.find(".swiper-wrapper"),i=0;i<t.length;i++){var n=$(a.find(".templatecontent").html()).clone();n=InsertAdDatat(n,t[i]),a.append(n)}else e.find(".File_Frame").each((function(e){var a=$(this);t.length>e&&InsertAdDatat(a,t[e])}))}function InsertAdDatat(e,t){var a,i="undefined"!=typeof OrgName,n=t.fileLink[0],d=n.fileType;switch(parseInt(d)){case 1:var o=e.find(".img_frame");o.find("img").attr("src",n.link),o.find("img").attr("alt",t.title),o.find("a").attr("href",t.link),o.find("a").attr("title","連結至"+t.title+(t.target?"(開新視窗)":"")),o.find("a").attr("target",t.target?"_blank":"_self"),e.find(".title").length>0&&(e.find(".title").text(t.title),e.find(".title").removeClass("d-none")),o.removeClass("d-none"),o.parent().children().not(".img_frame").not(".title").remove();break;case 2:var r=e.find(".video_frame");r.find("video").attr("src",n.link),r.find("video").attr("type",n.video_Type),r.removeClass("d-none"),r.parent().children().not(".video_frame").remove();break;case 3:var l=e.find(".YT_frame");if(l.find("img").attr("src","https://img.youtube.com/vi/"+n.name+"/maxresdefault.jpg"),l.find("img").attr("alt",t.title),l.removeClass("d-none"),l.parent().find("div").not(".YT_frame").remove(),0==$("body").find("#YTPreviewModal").length){$("body").prepend('<div class="modal fade" id="YTPreviewModal" tabindex="-1" aria-labelledby="YTPreviewModal" aria-hidden="true">\n                                                  <div class="modal-dialog modal-xl">\n                                                    <div class="modal-content position-relative bg-black">\n                                                        <div class="modal-header">\n                                                        <button type="button" data-bs-dismiss="modal" aria-label="Close" class="bg-light btn-close rounded-circle"</button>\n                                                        </div>\n                                                        <div class="modal-body"></div>\n                                                    </div>\n                                                  </div>\n                                                </div>'),$("#YTPreviewModal").find(".modal-content").css("height","90vh"),document.getElementById("YTPreviewModal").addEventListener("hidden.bs.modal",(function(e){$("#YTPreviewModal").find(".modal-body").empty()}))}l.on("click",(function(){var e="https://www.youtube-nocookie.com/embed/"+n.name;$("#YTPreviewModal").find(".modal-body").append(`<iframe src="${e}" class="w-100 h-100" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`)})),l.parent().children().not(".YT_frame").remove()}null!=t.describe&&e.find(".describe").length>0&&((t.describe+"").split("\n").forEach((function(e,t){0==t?a=e:a+=`<br/>${e}`})),e.find(".describe").append(a));if(e.find(".tag").length>0){for(var s="",c=0;c<t.tagDatas.length;c++){s+=`<a href="${"undefined"==typeof OrgName?"":`/${OrgName}/Search/Get/${t.tagDatas[c].searchId}/${t.tagDatas[c].title}`}" title="連結至：${t.tagDatas[c].title}" class="pe-2">#${t.tagDatas[c].title}</a>`}e.find(".tag").append(s)}return i&&Advertise.ActivityExposure(t.id).done((function(e){})),e.find(".video_frame").find("video").on("play",(function(){$(this).hasClass("playing")||($(this).addClass("playing"),Advertise.ActivityClick(t.id).done((function(e){})))})),e.find(".video_frame").find("video").on("ended",(function(){$(this).hasClass("playing")&&$(this).removeClass("playing")})),e.on("click",(function(){0==e.find(".video_frame").length&&Advertise.ActivityClick(t.id).done((function(e){}))})),e}
function FrameInit(){$(".masonry").each((function(){var t=$(this);if(!t.data("isInit")){$(this).find(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-item"});t.data("isInit",!0)}})),$(".YTmodal_frame").each((function(){var t=$(this);if(void 0===t.data("isinit")){if(void 0!==t.attr("link")&&""!=t.attr("link")){var i=t.attr("link").substring(t.attr("link").indexOf("v=")+2);t.attr("vid",i);var a=`http://img.youtube.com/vi/${i}/hqdefault.jpg`;t.find("img").attr("src",a)}if(void 0!==t.attr("yttitle")&&""!=t.attr("yttitle")&&t.find("img").attr("alt",t.attr("yttitle")),t.find("button").attr({"data-bs-toggle":"modal","data-bs-target":"#YTPreviewModal"}),0==$("body").find("#YTPreviewModal").length){$("body").prepend('<div class="modal fade" id="YTPreviewModal" tabindex="-1" aria-labelledby="YTPreviewModal" aria-hidden="true">\n                                                      <div class="modal-dialog modal-xl">\n                                                        <div class="modal-content bg-black">\n                                                            <div class="modal-header">\n                                                            <button type="button" data-bs-dismiss="modal" aria-label="Close" class="bg-light btn-close rounded-circle"</button>\n                                                            </div>\n                                                            <div class="modal-body"></div>\n                                                        </div>\n                                                      </div>\n                                                    </div>'),document.getElementById("YTPreviewModal").addEventListener("hidden.bs.modal",(function(t){$("#YTPreviewModal").find(".modal-body").empty()}))}t.find("button").on("click",(function(){var i="https://www.youtube-nocookie.com/embed/"+t.attr("vid");$("#YTPreviewModal").find(".modal-body").append(`<iframe src="${i}" class="w-100 h-100" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`)})),t.attr("data-isInit",!0)}}))}
function HoverEffectInit(){$(".hover_mask").each((function(){$(this).find(".hover_protrude_scale").each((function(){var i=$(this);i.hover((function(){i.siblings().each((function(){$(this).addClass("opacity-50")}))}),(function(){i.siblings().each((function(){$(this).removeClass("opacity-50")}))}))}))})),$(".black-bg .close").click((function(){$(".black-bg").fadeOut(500)})),$("#swiper1, #swiper2, #swiper3, #swiper4, #swiper5, #swiper6, #swiper7, #swiper8").click((function(){$(".black-bg").fadeIn(500)}))}function withebg(){$(".qual-width-images").mouseover((function(){var i=$(this).attr("id").substr(3);$(".image-overlay").not("#overlay"+i).css("display","block")})),$(".qual-width-images").mouseout((function(){$(".image-overlay").css("display","none")}))}
function LinkWithIconInit(){$(".link_with_icon").each((function(){var a=$(this);if(void 0!==a.data("isrun")||a.data("isrun"))return!0;var i=a.attr("href");if(a.find(".icon").empty(),void 0!==i){var n=i.substring(i.lastIndexOf(".")+1,i.length);switch(n){case"jpg":case"jpeg":case"png":case"gif":a.find(".icon").append('<i class="fa-solid fa-file-image font-yellow"></i>');break;case"pdf":a.find(".icon").append('<i class="fa-solid fa-file-pdf font-rad"></i>');break;case"doc":case"docx":case"odt":a.find(".icon").append('<i class="fa-solid fa-file-word font-blue"></i>');break;case"ppt":case"pptx":case"odp":a.find(".icon").append('<i class="fa-solid fa-file-powerpoint font-orange"></i>');case"xls":case"xlsx":case"ods":a.find(".icon").append('<i class="fa-solid fa-file-excel font-green"></i>');break;case"zip":case"rar":a.find(".icon").append('<i class="fa-solid fa-file-zipper"></i>');break;default:a.find(".icon").append('<i class="fa-solid fa-file font-gray"></i>')}}void 0===a.attr("download")&&a.attr("download",local.UnnamedFile),a.attr("title",local.LinkToAndBlank.format(a.attr("download"))),a.find(".name").text(a.attr("download").replace(`.${n}`,"")),"pdf"==n?a.attr({target:"_blank"}).removeAttr("download"):new RegExp(`[.]{1}${n}$`,"gi").test(a.attr("download"))?a.attr("download",`${a.attr("download")}`):a.attr("download",`${a.attr("download")}.${n}`),a.data("isrun",!0)}))}
function ShareBlockInit(){$(".shareBlock").each(((t,i)=>{if($this=$(i),void 0===$this.data("init")||!$this.data("init")){var a="";a="string"==typeof $this.data("href")?$this.data("href"):location.pathname,$this.cShare({description:"jQuery plugin - C Share buttons...",showButtons:["email","plurk","twitter","fb","line"],shareToText:local.shareTo,href:a}),$this.hover(ProShare),$this.data("init",!0)}}))}function ProShare(){$(this).toggleClass("show")}
function SitemapInit(){var e=function(e){return $.ajax({url:"/api/WebMenu/GetAll/",type:"GET",contentType:"application/json; charset=utf-8",data:{WebsiteID:e}})};"undefined"!=typeof SiteId?e(SiteId).done((function(e){CreateSitemap(e.maps)})):e(null).done((function(e){CreateSitemap(e.maps)}))}function CreateSitemap(e){var t=$(".sitemap_hierarchical_frame");const a=$('<ul class=""></ul>');t.append(a);var n=1;e.forEach((function(t){var l=$($("#Hierarchical_First_Item").html()).clone(),i=l.find(".first");if(null!=t.children){i.text(`${n} ${t.title}`),l.append('<ul class="ps-5 ps-md-0 col-md-8 py-1"></ul>');var r=l.find("ul"),s=1;t.children.forEach((function(e){var t=$($("#Hierarchical_Second_Item").html()).clone(),a=t.find(".second");if(a.attr("href",e.routerName),a.attr("title",e.text),null!=e.children){a.removeClass("ps-4 ps-sm-3"),a.append(`<span class="d-flex d-md-none material-symbols-outlined position-absolute start-0">expand_more</span><span class="second p-sm-0 ps-2">${n}-${s} ${e.title}</span><span class="d-none d-md-flex material-symbols-outlined">navigate_next</span>`),t.append('<ul class="ps-5 ps-md-0 col-md-6"></ul>');var l=t.find("ul"),i=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Third_Item").html()).clone(),a=t.find(".third");a.attr("href",`${e.routerName}`),a.attr("alt",e.text),a.text(`${n}-${s}-${i} ${e.title}`),l.append(t),i++}))}else a.text(`${n}-${s} ${e.title}`);r.append(t),s++}))}else i.parent("div").parent("div").html(`<a class="first d-block text-black px-3 rounded-3" href="${t.routerName}" alt="${t.text}">${n} ${t.title}</a>`);n==e.length&&l.removeClass("border-bottom"),a.append(l),n++}))}
function SwiperInit(e){var i={a11y:!0,slidesPerView:1,spaceBetween:15,keyboard:{enabled:!0},lazy:{loadPrevNext:!0},on:{init:function(){const e=function(e){e.preventDefault(),$(this).parents(".swiper-slide").find(".outside-item").addClass("show")},i=function(e){$(this).parents(".swiper-slide").find(".outside-item").removeClass("show")};$(this.el).find(".hover-outside").on("click",e),$(this.el).find(".hover-outside").on("mouseover",e),$(this.el).find(".outside-item").on("mouseover",e),$(this.el).find(".hover-outside").on("mouseout",i),$(this.el).find(".outside-item").on("mouseout",i),$("body").off("click.disableoutsideItem").on("click.disableoutsideItem",i),this.isLoopActive=this.params.loop},slideChange:function(){const e=this;if(e.params.loop){const i=$(e.el),t=i.find(".swiper-slide"),a=(e.slides.length,e.activeIndex,i.find(":focus").parents(".swiper-slide")),s=t.index(a);void 0!==s&&e.isLoopActive?(e.isLoopActive=!1,e.loopDestroy()):void 0!==s||e.isLoopActive||(e.isLoopActive=!0,e.loopCreate())}}}};if($.fn.extend({swiperBindEven:function(e,i){const t=function(){var i=e.activeIndex,t=(e.realIndex,e.slides[i]);$(t).find("video").length>0||e.autoplay.stop()},a=function(){var i=e.activeIndex,t=(e.realIndex,e.slides[i]);$(t).find("video").length>0||e.autoplay.start()};thisSwiper=$(this),$(this).off("mouseover").on("mouseover",t),$(this).find(".swiper-slide a").on("focus",(function(){const i=$(e.el).find(":focus").parents(".swiper-slide").attr("aria-label").split(" / ")[0];e.slideTo(i-1,300),t()})),$(this).off("mouseout").on("mouseout",a),$(this).find("a").on("blob",a),$(this).find("button").prop("disabled",!1),$(window).off("resize.swiper").on("resize.swiper",(function(){const i=e.slides.length,t=e.params.slidesPerView,a=e.navigation.nextEl?e.navigation.nextEl[0]:null,s=e.navigation.prevEl?e.navigation.prevEl[0]:null,n=e.pagination.el;i<=t?(e.autoplay.stop(),a&&(e.navigation.nextEl.style.display="none"),s&&(e.navigation.prevEl.style.display="none"),n&&(n.style.display="none")):(a&&(e.navigation.nextEl.style.display=""),s&&(e.navigation.prevEl.style.display=""),n&&(n.style.display=""))})),$(window).trigger("resize.swiper"),e.update()}}),$(".one_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){t.find("video").each((function(){var e=$(this);e.attr("controls")&&(e.removeAttr("controls"),e.prop("muted",!0),e.prop("playsinline",!0))})),void 0===t.attr("id")&&t.attr("id",`id-${Math.random().toString(36).substring(2,9)}-${Date.now()}`);var a="#"+t.attr("id")+" > .swiper";const l=$(a).find(".swiper-slide").parents(".templatecontent,.template_slide");if(1==$(a).find(".swiper-slide").length&&l.length>0)return!1;const p=0===l.length?$(a).find(".swiper-slide").length>1:$(a).find(".swiper-slide").length>2;var s=t.data("effect"),n=t.data("effect-speed");void 0!==s&&!1!==s||(s="slide"),n=void 0===n||!1===n?300:parseInt(n);var r=!!e.autoplay&&p,o=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},on:{slideChangeTransitionEnd:function(){const e=this,i=(this.slides.length,this.previousIndex),a=($(this.slides[i]),$(this.slides[this.activeIndex]).find("video")),s=a.get(0);a.length>0&&(thisSwiper.off("mouseover"),thisSwiper.off("mouseout"),e.autoplay.stop(),s.onended=function(){thisSwiper.on("mouseover"),thisSwiper.on("mouseout"),e.autoplay.start()}),t.find(".swiper-slide").each((function(){if(parseInt($(this).attr("data-swiper-slide-index"))!=this.realIndex){var e;if($(this).find("iframe").length>0)e=$(this).html();else if($(this).find("video").length>0){var i=$(this).find("video").get(0);i.pause(),i.currentTime=0,i.play()}null!=e&&(t=$(this),a=e,$(t).empty(),$(t).append(a))}var t,a}))}},effect:s,speed:n},r?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{},p?{navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next",prevEl:"#"+t.attr("id")+" .swiper_button_prev"}}:{}),d=new Swiper(a,o);t.data("isInit",!0),t.swiperBindEven(d)}})),$(".one_swiper_thumbs").prop("draggable",!0).each((function(){var t=$(this);const a=t.index(this);if(t.find(".six_thumbs > .swiper-wrapper").empty(),!t.data("isInit")){void 0===t.attr("id")&&t.attr("id",`id-${Math.random().toString(36).substring(2,9)}-${Date.now()}`);var s="#"+t.attr("id")+" .swiper";const w=$(s).find(".swiper-slide").length>=2;var n=t.data("effect"),r=t.data("effect-speed"),o=new Swiper(".six_thumbs",{loop:!1,spaceBetween:10,slidesPerView:6,freeMode:!0,watchSlidesProgress:!0});void 0!==n&&!1!==n||(n="slide"),r=void 0===r||!1===r?300:parseInt(r);var d=!!e.autoplay&&w,l=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},thumbs:{swiper:o},effect:n,speed:r},d?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{},w?{navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next",prevEl:"#"+t.attr("id")+" .swiper_button_prev"}}:{});if(w||$(`#${t.attr("id")}`).find(".swiper_button_next,.swiper_button_prev").remove(),!t.find(".swiper").hasClass(".selfThumbs")){const e=[],i=[],a=[];if(t.find(".swiper-slide img").each((function(){e.push($(this).attr("src")),i.push($(this).attr("alt")),$(this).closest(".swiper-slide").hasClass("backstageType")?a.push("backstageType"):a.push("")})),e.length>1)for(let t=0;t<e.length;t++){const s=`<div class="swiper-slide ${a[t]}"><img src="${e[t]}" alt="${i[t]}" /></div>`;o.appendSlide(s)}}o.slideTo(a,0);var p=new Swiper(s,l);t.data("isInit",!0),d&&p.slides.length-2>1&&t.swiperBindEven(p)}})),$(".two_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){void 0===t.attr("id")&&t.attr("id",`id-${Math.random().toString(36).substring(2,9)}-${Date.now()}`);var a="#"+t.attr("id")+" > .swiper";const o=0===$(a).find(".swiper-slide").parents(".templatecontent,.template_slide").length?$(a).find(".swiper-slide").length:$(a).find(".swiper-slide").length-1,d=o>2;var s=!!e.autoplay&&d,n=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0,renderBullet:function(e,i){return t.has(".swiper_pagination_water").length?'<span class="'+i+' material-symbols-outlined ms-3">water_drop</span>':'<span class="'+i+'"></span>'}},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next",prevEl:"#"+t.attr("id")+" .swiper_button_prev"},breakpoints:{400:{slidesPerView:1},1024:{slidesPerView:2}}},s?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{});!d&&o>0?$(`#${t.attr("id")}`).find(".swiper_button_next,.swiper_button_prev").addClass("d-none"):$(`#${t.attr("id")}`).find(".swiper_button_next,.swiper_button_prev").removeClass("d-none");var r=new Swiper(a,n);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(r),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".three_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){void 0===t.attr("id")&&t.attr("id",`id-${Math.random().toString(36).substring(2,9)}-${Date.now()}`);var a="#"+t.attr("id")+" > .swiper",s=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper-pagination",clickable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next",prevEl:"#"+t.attr("id")+" .swiper_button_prev"},breakpoints:{375:{slidesPerView:1},576:{slidesPerView:2},992:{slidesPerView:3}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),n=new Swiper(a,s);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(n),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".four_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){void 0===t.attr("id")&&t.attr("id",`id-${Math.random().toString(36).substring(2,9)}-${Date.now()}`);var a="#"+t.attr("id")+" > .swiper",s=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper-pagination",clickable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next",prevEl:"#"+t.attr("id")+" .swiper_button_prev"},breakpoints:{375:{slidesPerView:1},576:{slidesPerView:3},992:{slidesPerView:4}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),n=new Swiper(a,s);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(n),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".five_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){void 0===t.attr("id")&&t.attr("id",`id-${Math.random().toString(36).substring(2,9)}-${Date.now()}`);var a="#"+t.attr("id")+" > .swiper",s=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},scrollbar:{el:".swiper-scrollbar",draggable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next",prevEl:"#"+t.attr("id")+" .swiper_button_prev"},breakpoints:{320:{slidesPerView:2},375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:5}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),n=new Swiper(a,s);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(n),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".six_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){void 0===t.attr("id")&&t.attr("id",`id-${Math.random().toString(36).substring(2,9)}-${Date.now()}`);var a="#"+t.attr("id")+" > .swiper",s=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper_pagination",clickable:!0},scrollbar:{el:".swiper-scrollbar",draggable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next",prevEl:"#"+t.attr("id")+" .swiper_button_prev"},breakpoints:{320:{slidesPerView:2},375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:6}}},e.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),n=new Swiper(a,s);t.data("isInit",!0),e.autoplay&&t.swiperBindEven(n),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}})),$(".picture-category").length>0&&$("#SwiperModal").length>0&&!$(this).data("isinit")){const e=$("#SwiperModal .modal-header .imgalt");e.text("");const i=new Swiper("#pictureSwiperThumbs",{spaceBetween:10,breakpoints:{375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4},1024:{slidesPerView:6}},freeMode:!0,watchSlidesProgress:!0}),t=new Swiper("#pictureSwiper",{centeredSlides:!0,spaceBetween:10,loop:!0,navigation:{nextEl:"#pictureSwiper .swiper-button-next",prevEl:"#pictureSwiper .swiper-button-prev"},pagination:{el:"#pictureSwiper .swiper-pagination"},thumbs:{swiper:i},autoplay:{delay:5e3,disableOnInteraction:!1}});t.on("slideChange",(function(){var i=$(t.wrapperEl).find(".swiper-slide").eq(t.activeIndex);e.text(i.find("img").attr("alt"))})),$(".picture-category a").attr("href","#SwiperModal").on("click",(function(){t.removeAllSlides(),i.removeAllSlides();var a=$(this).parents(".picture-category"),s=a.find("a").index(this),n=[];if(a.find(".templatecontent img").each((function(){var e={};e.src=$(this).attr("src"),e.alt=void 0===$(this).attr("alt")?"":$(this).attr("alt"),n.push(e)})),e.text(n[s].alt),1==n.length){var r=`<div class="swiper-slide"><img src="${n[0].src}" alt="${n[0].alt}" /></div>`;t.appendSlide(r)}else for(let e=0;e<n.length;e++){r=`<div class="swiper-slide"><img src="${n[e].src}" alt="${n[e].alt}" /></div>`;t.appendSlide(r);var o=`<div class="swiper-slide align-content-center ms-1 me-2"><img src="${n[e].src}" alt="${n[e].alt}" /></div>`;i.appendSlide(o)}return t.slideTo(s,0),i.slideTo(s,0),$("#SwiperModal").modal("show"),!1})),$(this).data("isinit",!0)}$(".three_two_grid_swiper").prop("draggable",!0).each((function(){var t=$(this);if(!t.data("isInit")){void 0===t.attr("id")&&t.attr("id",`id-${Math.random().toString(36).substring(2,9)}-${Date.now()}`);var a="#"+t.attr("id")+" > .swiper";const o=0===$(a).find(".swiper-slide").parents(".templatecontent,.template_slide").length?$(a).find(".swiper-slide").length:$(a).find(".swiper-slide").length-1,d=o>6;var s=!!e.autoplay&&d,n=Object.assign({},i,{pagination:{el:"#"+t.attr("id")+" .swiper-pagination",clickable:!0},navigation:{nextEl:"#"+t.attr("id")+" .swiper_button_next",prevEl:"#"+t.attr("id")+" .swiper_button_prev"},slidesPerView:3,breakpoints:{375:{slidesPerView:1},576:{slidesPerView:2},992:{slidesPerView:3}},grid:{rows:2,fill:"row"},spaceBetween:30},s?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:d}:{});!d&&o>0?$(`#${t.attr("id")}`).find(".swiper_button_next,.swiper_button_prev").addClass("d-none"):$(`#${t.attr("id")}`).find(".swiper_button_next,.swiper_button_prev").removeClass("d-none");var r=new Swiper(a,n);t.data("isInit",!0),s&&t.swiperBindEven(r),t.prepend($("#"+t.attr("id")+" .swiper_button_prev"))}}))}
const newEnum=e=>{const t={};return Object.keys(e).forEach((n=>{t[t[n]=e[n]]=n})),t},list_type=newEnum({grid:"Grid",list:"List",text:"Text",product_grid:"Product_Grid",product_list:"Product_List"}),display_configurations={[list_type.list]:["type1 bg-white",{".card-border":"card-border-rd type3",".catalog-number":"d-none",".check_btn":"check_btn-type3",".col":"p-1 type3 box-shadow",".description":"type3-content",".image":"px-0",".image_frame":"h-100",".imgh":"img-h",".item-header":"d-none",".like-and-share":"d-none",".max-h":"max-hei",".mergetag":"merge",".more-btn":"d-none",".more-tag":"d-none",".price-grid":"d-none",".purchase":"d-none",".related-tag":"d-none",".shareBlock":"d-none",".tags":"d-none",".title":"type1-title fw-bold p-2",figcaption:"flex-grow-1 p-3 py-0 py-md-3 pb1"}],[list_type.grid]:["type2 row row-cols-sm-4 bg-white",{".card-border":"card-border-rd type2",".catalog-number":"d-none",".check_btn":"w-100",".col":"p-1 type2 box-shadow",".date":"d-none",".description":"d-none type2-content",".image_frame":"w-100",".item-header":"d-none",".like-and-share":"d-none",".more":"d-none",".more-btn":"d-none",".more-tag":"d-none",".price-grid":"d-none",".purchase":"d-none",".related-tag":"d-none",".shareBlock":"d-none",".tags":"d-none",".title":"type1-title fw-bold p-2",figcaption:"pb1",figure:"flex-column"}],[list_type.text]:["type3 row row-cols-sm-4 bg-white",{".card-border":"pr3 type1",".catalog-number":"d-none",".check_btn":"w-100",".col":"p-1 type1 text-border box-shadow",".date":"d-none",".description":"d-none",".image":"d-none",".image_frame":"d-none",".item-header":"d-none",".like-and-share":"d-none",".more":"d-none",".more-tag":"d-none",".price-grid":"d-none",".purchase":"d-none",".related-tag":"d-none",".shareBlock":"d-none",".search-more":"d-none",".tags":"d-none",".title":"type2-title pr3 h-100",figure:"flex-column"}],[list_type.product_grid]:["type4 row row-cols-lg-4 row-cols-md-2 row-cols-2  bg-light px-2",{".card-border":"card-border-rd type2",".catalog-number":"d-none",".check_btn":"w-100",".col":"p-1 type4 rounded-lg h-100",".date":"d-none",".description":"d-none type2-content",".image_frame":"type4-image-frame w-100",".item-header":"d-flex",".like-and-share":"d-none",".more":"d-none",".more-btn":"d-none",".more-tag":"d-none",".purchase":"d-none",".shareBlock":"type4",".tags":"align-text-bottom",".title":"type4-title d-inline fs-6",figcaption:"pb1 type4-caption d-flex flex-column",figure:"flex-column"}],[list_type.product_list]:["type1 bg-light px-2",{".bottom-row":"mt-auto",".card-border":"card-border-rd type2",".catalog-number":"type4-title d-inline",".check_btn":"check_btn-type3",".col":" type5 rounded-lg",".description":"type3-content",".image":"px-0",".image_frame":"type5-image-frame",".imgh":"img-h",".item-header":"d-none",".item-title":"d-lg-flex",".less-tag":"d-none",".like-and-share":"d-inline ms-auto fs-5 p-2",".max-h":"max-hei",".mergetag":"merge",".more":"d-none",".more-btn":"d-none",".price-grid":"d-none",".purchase":"ms-auto d-inline",".related-tag":"d-none",".shareBlock":"type5",".tags":"mt-auto mb-2 align-text-bottom d-lg-flex",".title":"type4-title d-inline fs-6 p-2",figcaption:"flex-grow-1 d-flex flex-column"}]};function ViewTypeChangeInit(){$(".type_change_frame").each((function(){var e=$(this);if(!e.data("isInit")){const a=e.find(".btn_grid"),d=e.find(".btn_list"),l=e.find(".btn_text"),s=e.find(".btn_prod_grid"),c=e.find(".btn_prod_list"),g=e.find(".content").first(),p={[list_type.grid]:a,[list_type.list]:d,[list_type.text]:l,[list_type.product_grid]:s,[list_type.product_list]:c};var t=window.location.pathname;if(t.indexOf("Search")>0)t=t.substring(0,t.indexOf("Search")+6);else if(t.lastIndexOf("_")>0){var n=t.substring(t.lastIndexOf("_")+1);$.isNumeric(n)&&(t=t.substring(0,t.lastIndexOf("_")))}for(const[e,n]of Object.entries(p))n.on("click",(function(){if(!n.data("activate")){var o=n.attr("class").split(" ").filter((e=>e.startsWith("btn_"))).toString().replaceAll(",",".");localStorage.setItem(`switchViewType-${t}`,o),typeChange(n,p,g,e)}}));var o=!1;if(void 0!==localStorage[`switchViewType-${t}`]&&t.indexOf("Search")<0){var i=localStorage[`switchViewType-${t}`];$(`button.${i}`).trigger("click"),o=!0}o||(a.length>0&&!a.hasClass("d-none")?a.trigger("click"):d.length>0&&!d.hasClass("d-none")?d.trigger("click"):s.length>0&&!s.hasClass("d-none")?s.trigger("click"):c.length>0&&!c.hasClass("d-none")?c.trigger("click"):l.length>0&&!l.hasClass("d-none")&&l.trigger("click"));var r=0;for(const[e,t]of Object.entries(p))(0===t.length||t.hasClass("d-none"))&&(r+=1);r>=4?e.find(".switch_control").addClass("d-none"):e.find(".switch_control").removeClass("d-none")}e.data("isInit",!0)}))}function updateStyle(e,t){for(const[t,n]of Object.entries(display_configurations)){e.removeClass(n[0]);for(const[t,o]of Object.entries(n[1]))e.find(t).removeClass(o)}e.addClass(t[0]);for(const[n,o]of Object.entries(t[1]))e.find(n).addClass(o)}function typeChange(e,t,n,o){for(const[e,n]of Object.entries(t))n.data("activate",0),n.addClass("text-black-50");e.data("activate",1),e.removeClass("text-black-50"),n.each((function(){updateStyle($(this),display_configurations[o])}))}
function date_input_change(t){var a=$(`#${t}`),n=a.attr("data-daterange"),e=a.attr("data-location"),i=a.attr("data-addr"),d=a.attr("data-organizer"),r=a.attr("data-a-organizer"),s=a.attr("data-r-organizer"),o=a.attr("data-link"),l=a.attr("data-tel"),v=a.find(".activity_start_time").parents("div").eq(1);""==n?$(v).addClass("d-none"):$(v).removeClass("d-none");var f=a.find(".activity_location").parents("div").eq(0);""==e?$(f).addClass("d-none"):($(f).find("a").attr({href:`https://www.google.com.tw/maps/place/${e}`,title:`連結至：${e}(另開新視窗)`,target:"_blank"}),$(f).removeClass("d-none"));var c=a.find(".activity_addr").parents("div").eq(0);""==i?$(c).addClass("d-none"):($(c).find("a").attr({href:`https://www.google.com.tw/maps/place/${i}`,title:`連結至：${i}(另開新視窗)`,target:"_blank"}),$(c).removeClass("d-none"));var m=a.find(".activity-organizer").parent("div").eq(0);""==d?$(m).addClass("d-none"):$(m).removeClass("d-none");var g=a.find(".activity-a-organizer").parent("div").eq(0);""==r?$(g).addClass("d-none"):$(g).removeClass("d-none");var h=a.find(".activity-r-organizer").parent("div").eq(0);if(0==h.length){const t=$(g).clone();t.find("div, span").removeAttr("id"),t.removeAttr("id").removeClass("d-none"),t.find("div > span").length>0?t.find("div > span").text("執行單位"):t.find("div").text("執行單位"),t.find(".activity-a-organizer").removeClass("activity-a-organizer").addClass("activity-r-organizer"),h=t,$(g).after(t)}void 0!==s&&""!=s?($(h).removeAttr("id").removeClass("d-none"),$(h).find(".activity-r-organizer").text(s)):$(h).remove();var C=a.find(".activity_link").parents("div").eq(0);""==o?$(C).addClass("d-none"):($(C).find("a").attr({href:o,title:"連結至：活動網站(另開新視窗)",target:"_blank"}),$(C).removeClass("d-none"));var _=a.find(".activity_tel").parents("div").eq(0);if(""==l?$(_).addClass("d-none"):($(_).find("a").attr({href:`tel:${l}`,title:`播打電話：${l}`,target:"_blank"}),$(_).removeClass("d-none")),void 0!==n&&n){const t=n.split("~");a.find(".activity_start_time").html(t[0].trim()),a.find(".activity_end_time").html(t[1].trim())}return a.find(".activity_location").html(e),a.find(".activity_addr").html(i),a.find(".activity-organizer").html(d),a.find(".activity-a-organizer").html(r),a.find(".activity_link").html(o),a.find(".activity_tel").html(l),a.html()}function namecontrol(t){const a=$("#"+t),n=a.find(".btn_text"),e=a.find(".btn_grid"),i=a.find(".btn_list"),d=a.parents(".type_change_frame").first().find(".content").first();n.hasClass("d-none")?n.hasClass("d-none")&&!e.hasClass("d-none")?typeChange(e,i,n,d,"Grid"):n.hasClass("d-none")&&e.hasClass("d-none")&&!i.hasClass("d-none")&&typeChange(i,e,n,d,"List"):typeChange(n,e,i,d,"Text")}
function setContact(){$(".ContactForm").contactInit()}document.addEventListener("DOMContentLoaded",(()=>{$.fn.extend({contactInit:function(){$(this).each((function(){$(this).setContact()}))},setContact:function(){const e=this.get(0),t=this,n=t.find('[name="captcha"]'),a=t.find(".img-fluid").last();$("#ContactForm .btn_refresh").off("click").on("click",(()=>{NewCaptcha(a,n,"ContactUs")})),$("#ContactForm .btn_refresh").trigger("click"),t.getFormJson(),e.addEventListener("submit",(o=>{if(o.preventDefault(),o.stopPropagation(),e.classList.add("was-validated"),e.checkValidity()){o.preventDefault();const e={Email:"",Name:""},r=t.find('[name="sender"]');if("SELECT"==r.get(0).tagName){const t=r.find("option:selected");e.Email=t.val(),e.Name=t.text()}else e.Email=r.val(),e.Name=r.data("title");if(""==e.Email)return void co.sweet.error(local.InformationError,local.NoSelectSender);$.ajax({url:"/api/Contact/submit",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({routerName:PageKey,sender:e,forms:t.getFormJson()}),dataType:"json",beforeSend:function(e){e.setRequestHeader("requestverificationtoken",$('input:hidden[name="AntiforgeryFieldname"]').val())}}).done((function(e){e.success?(Coker.sweet.success(local.SentSuccessfully,null,!0),t.removeClass("was-validated"),t.get(0).reset()):Coker.sweet.error(local.FailedToSend,e.error,null,!0),NewCaptcha(a,n,"ContactUs")}))}else NewCaptcha(a,n,"ContactUs"),Coker.sweet.error(local.Error,local.FormSubmitMessage,null,!0)}),!1),document.addEventListener("keyup",(function(e){var t=e.target;if("INPUT"==t.nodeName&&t.value.length==t.maxLength){var n=$(t).parents("form").first().find("input");for(let e=0;e<n.length;e++)if(n[e]==t)return void(n[e+1]&&n[e+1].focus())}}))}})}));
"use strict";const setBGCanvas=function(){const t=[1,1.1,1.8],n=[.8,1.1,2.2],i=[.9,1.1,2],e=[1,1.1,1.5];let a=null;$.fn.extend({BGCanvas:function(){const t=$(this),n=function(){if(!isNaN(t.data("type"))&&1===parseInt(t.data("type")))t.BGCanvasType1()};return 0==t.height()?t.find("img").on("load",(function(){n()})):n(),t},BGCanvasType1:function(){let s=$(this),o=$(this);if(0!=s.length&&"canvas"!=s.get(0).tagName.toLowerCase()&&0==s.find("canvas").length&&(o=$("<canvas>"),s.append(o)),0==s.length)return s;var h,r,l,d=45,c=.25;const{sin:g,cos:f,PI:u,sqrt:w,random:y,floor:v,ceil:p,round:C,abs:x}=Math;return function(){var w=o.get(0),v=w.getContext("2d");function p(){a=window.innerWidth>1500?t:window.innerWidth>1200?n:window.innerWidth>768?i:e,h=s.width()*a[0],r=s.height()*a[0],console.log(a),w.width=h,w.height=r,l=(h<r?h:r)/2,v.fillStyle="rgba(245,251,251,0)",v.fillRect(0,0,h,r)}function x(){this.ang=2*u*y(),this.dang=(-.5+y())/40,this.r=2*l/a[2],this.x=h/2+this.r*f(this.ang),this.y=r/2+a[1]*this.r*g(this.ang),this.update=function(){this.ang+=this.dang,this.x=h/2+this.r*f(this.ang),this.y=r/2+a[1]*this.r*g(this.ang)}}p(),window.onresize=p;var $=[];for(let t=0;t<18;t++)$.push(new x);!function t(){v.fillStyle="rgba(255,255,255,0.03)",v.fillRect(0,0,h,r),v.beginPath(),v.moveTo(($[0].x+$[17].x)/2,($[0].y+$[17].y)/2);for(let t=0;t<18;t++){let n=t+1;18==n&&(n=0),v.quadraticCurveTo($[t].x,$[t].y,($[t].x+$[n].x)/2,($[t].y+$[n].y)/2),$[t].update()}v.strokeStyle=`hsl(${C(180+d)}deg, 100%, 70%)`,v.lineWidth=2*l/432,v.stroke(),v.shadowColor="transparent",((d+=c)>=100||d<=45)&&(c=-c),45==d&&(v.fillStyle="rgba(0,0,0,0)",v.fillRect(0,0,h,r)),window.requestAnimationFrame(t)}()}(),s}}),$(".BGCanvas").BGCanvas()};
var FileApi={insertNotFondFile:function(e){return e.from=location.href,$.ajax({url:"/api/File/insertNotFondFile",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"json"})}};function jqueryExtend(){$.fn.extend({imgCheck:function(){var e=$(this);return e.each((function(e,t){$(t).on("error",(function(){FileApi.insertNotFondFile({Url:$(t).attr("src"),FK_WebsiteID:"undefined"==typeof SiteId?0:SiteId}),$(t).attr("src","/images/noImg.jpg")}))})),e}}),$.extend({htmlDecode:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value.replace(/\n/g,"<br />")},loadCss:function(e){const t=$.Deferred();let n=document.getElementsByTagName("HEAD")[0],r=document.createElement("link");return r.rel="stylesheet",r.type="text/css",r.href=e,r.onload=function(){t.resolve()},n.appendChild(r),t.promise()},LoadJs:function(e){const t=$.Deferred();let n=document.getElementsByTagName("HEAD")[0],r=document.createElement("script");return r.type="text/javascript",r.src=e,/.mjs$/.test(e)&&(r.type="module"),r.onload=function(){t.resolve()},r.onerror=function(){t.reject(new Error(`Failed to load script: ${e}`))},n.appendChild(r),t.promise()}})}String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,(function(t,n){return void 0!==e[n]?e[n]:t}))}),Storage.prototype.isNullOrEmpty||(Storage.prototype.isNullOrEmpty=function(e){const t=this.getItem(e);return null===t||""===t});
function FlipBookInit(){var e=$(".FlipBook");let i=1;isNaN($(".FlipBookItem").data("type"))||(i=parseInt($(".FlipBookItem").data("type")));const t=[{version:"pdfjs-4.5.136-dist",ext:"mjs"},{version:"pdfjs-2.1.266-dist",ext:"js"}][i];if(e.addClass("d-none"),void 0!==e.data("pdf")&&e.data("pdf"))e.data("pdf");else console.log("No PDF file specified for FlipBook"),`/lib/pdf-viewer/external/${t.version}/web/compressed.tracemonkey-pldi-09.pdf`;var o=document.createElement("div"),n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState){200==this.status&&(o.innerHTML=this.responseText),404==this.status&&(o.innerHTML="Page not found."),$(o).find("meta,title,script").remove();const i=[];$.LoadJs(`/lib/pdf-viewer/external/${t.version}/build/pdf.${t.ext}`).done((function(){i.push($.LoadJs(`/lib/pdf-viewer/external/${t.version}/web/viewer.${t.ext}`),$.LoadJs("/lib/pdf-viewer/external/turn.js"),$.LoadJs("/lib/pdf-viewer/pdf-turn/pdf-turn.js"))})),e.append(o),e.removeClass("d-none"),$(".FlipBookModal").length>0&&$.when.apply(null,i).done((function(){/^pdfjs-4/.test(t.version)?FlipBookModalInit({mode:4,lName:"#listeners"}):FlipBookModalInit({mode:3,lName:"_listeners"})}))}},n.open("GET",`/lib/pdf-viewer/external/${t.version}/web/viewer.html?file=`,!0),n.send()}function FlipBookModalInit(e){var i=$(".FlipBookModal");const t=bootstrap.Modal.getOrCreateInstance(i[0]);let o=null;const n=function(){"undefined"!=typeof bookFlip&&"undefined"!=typeof PDFViewerApplication&&void 0!==PDFViewerApplication.eventBus&&null!=PDFViewerApplication.eventBus?void 0!==$(this).data("init")||$(this).data("init")||(console.log("bookFlip.init"),$(this).data("init",!0),PDFViewerApplication.closeModal=function(){t.hide()},void 0!==PDFViewerApplication.initializedPromise&&PDFViewerApplication.initializedPromise.then((function(){PDFViewerApplication.setTitleUsingUrl=function(){},console.log("PDF.js has been initialized, title change has been disabled.")})),bookFlip.init(e)):o=setTimeout(n,100)};o=setTimeout(n,100),i.on("shown.bs.modal",(e=>{var i=e.relatedTarget.getAttribute("data-pdf-url");PDFViewerApplication.setInitialView(),PDFViewerApplication.open({url:i,originalUrl:i})}))}
function MapMessage(){$.loadCss("https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap"),void 0===window.counterUp?$.LoadJs("/lib/counterup2/index.js").done(setCounter):setCounter();const a=function(a){const e=$(`${$(this).attr("href")||`#${$(this).data("area")}`}`);window.scrollY;$(".MapMessage .active").removeClass("active"),e.addClass("active"),$(`.MapMessage .mapData [data-Area="${e.attr("id")}"]`).addClass("active");const s=window.counterUp.default;return $(".MapMessage .counter").each(((a,e)=>{s(e,{duration:500,delay:16})})),!1};$(".MapMessage map>area").on("click",a),$(".MapMessage map>area,.mapData li").on("mouseover",a)}function setCounter(){const a=window.counterUp.default,e=new IntersectionObserver((e=>{e.forEach((e=>{const s=e.target;e.isIntersecting&&!s.classList.contains("is-visible")&&(a(s,{duration:2e3,delay:16}),s.classList.add("is-visible"))}))}),{threshold:1});document.querySelectorAll(".MapMessage .counter").forEach((a=>{e.observe(a)}))}
function GetLatLng(){navigator.geolocation?navigator.geolocation.getCurrentPosition((o=>{const t=o.coords.latitude,e=o.coords.longitude;$(".getlatlng").data("longitude",e),$(".getlatlng").data("latitude",t),DirectoryGetDataInit(),console.log(`Latitude: ${t}, Longitude: ${e}`)}),(o=>{switch(o.code){case o.PERMISSION_DENIED:console.log("GetLatLngError: User denied the request for Geolocation");break;case o.POSITION_UNAVAILABLE:console.log("GetLatLngError: Location information is unavailable");break;case o.TIMEOUT:console.log("GetLatLngError: The request to get user location timed out");break;case o.UNKNOWN_ERROR:console.log("GetLatLngError: An unknown error occurred")}})):console.log("GetLatLngError: Geolocation is not supported by this browser")}
function MarqueeSwiper(e){var t=function(e,t){return $.ajax({url:"/api/Marquee/GetAll",type:"GET",data:{webid:e,placement:t},contentType:"application/json; charset=utf-8",dataType:"json"})};$(".marqueeSwiper").each((function(){$(this);$(this).find(".swiper-wrapper").find(".swiper-slide").each((function(){const e=$(this).width();let t=$(this);const n=t.find(".text").css("font-size");let i=[],l=t.text().replace("(current)",""),r=$('<div class="temp-div"></div>').appendTo("body");r.css("width",e+"px"),r.css("font-size",n);let a=r.height();for(let e=0;e<l.length;e++){r.append(l[e]);let t=r.height();t>a&&(i.push(e),a=t)}for(let e=0;e<i.length;e++){let n=i[e],r=e===i.length-1?l.length:i[e+1],a=t.clone();a.find(".text").text(l.substring(n,r)),t.before(a)}t.remove(),r.remove()}))}));new Swiper(".marqueeSwiper",{a11y:!0,direction:"vertical",allowTouchMove:!1,keyboard:{enabled:!0},autoplay:{delay:3e3}});t(void 0===e?0:e,"Top").done((function(e){const t=e.map((function(e){return{title:e.title,link:e.link,target:e.target}}));if("undefined"==typeof marqueeContainer)return;marqueeContainer.innerHTML="",t.forEach((e=>{const t=document.createElement("div");let n;if(t.classList.add("swiper-slide"),e.link){const t=e.target?"_blank":"_self";n=`\n                    <a class="overflow-hidden text" data-bs-toggle="tooltip" title="${e.target?`連結至：${e.title}(另開視窗)`:`連結至：${e.title}`}" href="${e.link}" target="${t}">\n                        ${e.title}\n                    </a>\n                `}else n=`\n                    <div class="overflow-hidden text" data-bs-toggle="tooltip" title="${e.title}">\n                        ${e.title}\n                    </div>\n                `;t.innerHTML=n,$marquee.append(t)})),$marquee.find(".swiper-slide").each((function(){const e=$(this).width();let t=$(this);const n=t.find(".text").css("font-size");let i=[],l=t.text().replace("(current)",""),r=$('<div class="temp-div"></div>').appendTo("body");r.css("width",e+"px"),r.css("font-size",n);let a=r.height();for(let e=0;e<l.length;e++){r.append(l[e]);let t=r.height();t>a&&(i.push(e),a=t)}for(let e=0;e<i.length;e++){let n=i[e],r=e===i.length-1?l.length:i[e+1],a=t.clone();a.find(".text").text(l.substring(n,r)),t.before(a)}t.remove(),r.remove()}));var n=new Swiper(".marqueeSwiper",{direction:"vertical",allowTouchMove:!1,keyboard:{enabled:!0},autoplay:{delay:3e3}});const i=function(){"function"==typeof $(".marqueeSwiper").swiperBindEven?$(".marqueeSwiper").swiperBindEven(n):setTimeout(i,300)};i()}))}