function AnchorPointInit(){$(".anchor_directory").each((function(){var t=$(this);t.children("ul").empty(),$(".anchor_title").each((function(){var n=$(this),e=n.text().indexOf("\n")>-1?n.text().substr(0,n.text().indexOf("\n")):n.text();t.children("ul").append(`<li class="fs-5"><a class="text-black text-decoration-none" href="#${n.attr("id")}"><div class="p-2 px-4">${e}</div></a></li>`),n.bind("DOMNodeInserted",(function(){AnchorPointInit()}))})),t.children('a[href^="#"]').click((function(t){var n=$(this).attr("href"),e=$(n).offset().top-50;$("html, body").animate({scrollTop:e},0),t.preventDefault()}))}))}
var Directory={getDirectoryData:function(t){return $.ajax({url:"/api/Directory/GetReleInfo",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})},getDirectoryMenuData:function(t){return $.ajax({url:"/api/Directory/GetReleMenu",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json"})}};function initElemntAndLoadDir(t,e){const a=t||$(".catalog_frame,.menu_directory").first(),n=a.attr("data-dirid")>0?a.attr("data-dirid"):0;a.data("prevdirid",n);const i=void 0!==a.data("shownum")?a.data("shownum"):12,d=void 0!==a.data("maxlen")?a.data("maxlen"):0,o=e?e.toString():location.hash.replace("#","");void 0!==a.data("page")&&a.data("page")==o||(e=isNaN(o)||""==o?"1":o,a.find(".catalog>.template").remove(),console.log(e),DirectoryDataGet(a,{Ids:[n],SiteId:"undefined"==typeof SiteId?0:SiteId,Page:e,ShowNum:i,MaxLen:void 0===d?0:d}),a.data("page",e))}function DirectoryGetDataInit(){const t=$(".catalog_frame,.menu_directory").length;$(".catalog_frame").each((function(){const t=$(this),e=t.attr("data-dirid")>0?t.attr("data-dirid"):0;void 0!==t.data("prevdirid")&&e==t.data("prevdirid")||initElemntAndLoadDir($(this))})),$(".menu_directory").each((function(){var t=$(this),e=t.attr("data-dirid")>0?t.attr("data-dirid"):0;void 0!==t.data("prevdirid")&&e==t.data("prevdirid")||(t.data("prevdirid",e),t.find(".title").text(""),t.find(".accordion").empty(),Directory.getDirectoryMenuData({Id:e,WebsiteId:"undefined"!=typeof SiteId?SiteId:0}).done((function(e){void 0!==e&&(t.find(".title").text(e.title),$.each(e.children,(function(a,n){if(t.find(".title").text(e.title),null!=n.children){var i=$($("#TemplateAccordionItem").html()).clone();i.find(".sectitle").text(n.title),i.find(".accordion-header").attr("id",`secheader${n.Id}`),i.find(".accordion-collapse").attr({"aria-labelledby":`secheader${n.Id}`,id:`seccollapse${n.Id}`}),i.find(".accordion-button").attr({"data-bs-target":`#seccollapse${n.Id}`,"aria-controls":`seccollapse${n.Id}`});var d=i.find(".accordion-body");$.each(n.children,(function(t,e){d.append(`<a href="${e.routerName}" title="連結至：${e.title}" class="list-group-item list-group-item-action border-0 py-3">${e.title}</a>`)})),t.find(".accordion").append(i)}else{var o=`<div class="accordion-item border-0 border-bottom px-1"><a href="${n.routerName}" title="連結至：${n.title}" class="list-group-item border-0 py-3 custom_h5 text-black">${n.title}</a></div>`;t.find(".accordion").append(o)}})))})))})),1==t&&("onhashchange"in window?window.onhashchange=hashChangeDirectory:setInterval(hashChangeDirectory,1e3))}function hashChangeDirectory(t){t?(initElemntAndLoadDir(),t.preventDefault()):console.log("HashChange錯誤")}function DirectoryDataGet(t,e){const a=$(".catalog_frame,.menu_directory").length;let n=parseInt(e.Page);Directory.getDirectoryData(e).done((function(e){let i=2;t.find(".page-item").each((function(){var t=$(this);t.hasClass("btn_prev")||t.hasClass("btn_next")||t.remove()})),e.totalPage<=1?t.find(".page_btn").addClass("d-none"):t.find(".page_btn").removeClass("d-none"),n>e.totalPage?n=e.totalPage:n<1&&(n=1),1==n?t.find(".btn_prev").addClass("d-none"):t.find(".btn_prev").removeClass("d-none"),n==e.totalPage?t.find(".btn_next").addClass("d-none"):t.find(".btn_next").removeClass("d-none"),1!=n&&n!=e.totalPage||(i=4);for(var d=1;d<=e.totalPage;d++)1==d?d==n?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>1</span></li>`):(t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="第一頁" data-page=${d}>1</button></li>`),n-i-1>0&&t.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>')):d==e.totalPage?d==n?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>${e.totalPage}</span></li>`):(n+i+1<e.totalPage&&t.find(".page_btn").children(".btn_next").before('<li class="page-item px-2">...</li>'),t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="最後一頁" data-page=${d}>${e.totalPage}</button></li>`)):d>=n-i&&d<=n+i&&(d==n?t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><span class="btn_page page-link text-black bg-secondary" data-page=${d}>${d}</span></li>`):t.find(".page_btn").children(".btn_next").before(`<li class="page-item"><button class="btn_page page-link text-black" title="移動至第${d}頁" data-page=${d}>${d}</button></li>`));$(".btn_page").off("click").on("click",(function(){var e=$(this);n!=e.data("page")&&(n=e.data("page"),1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(t,n))})),t.data("init")||(t.find(".btn_prev > button").on("click",(function(){n=parseInt(t.data("page"))-1,n>1&&(1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(t,$self.data("page")))})),t.find(".btn_next > button").on("click",(function(){n=parseInt(t.data("page"))+1,n<e.totalPage&&(1==a&&window.location.hash!=`#${n}`?window.location.hash=`#${n}`:initElemntAndLoadDir(t,$self.data("page")))}))),t.data("init","true"),DirectoryDataInsert(t,e.releInfos)}))}function DirectoryDataInsert(t,e){e.forEach((function(e){var a=$(t.find(".templatecontent").html()).clone();a.find("a").attr("href",window.location.pathname+e.link),a.find("a").attr("title",`連結至: ${e.title}`);var n=e.mainImage;if("undefined"!=typeof IsFaPage&&"undefined"!=typeof OrgName&&"True"!=IsFaPage&&(n=n.replace("upload",`upload/${OrgName}`)),a.find("img").attr("src",n),a.find("img").attr("alt",`${e.title}的主要圖片`),a.find(".title").text(e.title),a.find(".description").text(e.description),t.find(".catalog").append(a),null!=e.nodeDate&&""!=e.nodeDate){var i=new Date(e.nodeDate);a.find(".date").text(`${i.getFullYear()}/${i.getMonth()+1}/${i.getDate()}`),a.find(".date-month").text(`${i.getMonth()+1}月`),i.getDate()<10?a.find(".date-day").text(`0${i.getDate()}`):a.find(".date-day").text(`${i.getDate()}`)}})),HoverEffectInit()}
function FrameInit(){$(".masonry").each((function(){var i=$(this);if(!i.data("isInit")){$(this).find(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-item"});i.data("isInit",!0)}}))}
function HoverEffectInit(){$(".hover_mask").each((function(){$(this).find(".hover_protrude_scale").each((function(){var i=$(this);i.hover((function(){i.siblings().each((function(){$(this).addClass("opacity-50")}))}),(function(){i.siblings().each((function(){$(this).removeClass("opacity-50")}))}))}))})),$(".black-bg .close").click((function(){$(".black-bg").fadeOut(500)})),$("#swiper1, #swiper2, #swiper3, #swiper4, #swiper5, #swiper6, #swiper7, #swiper8").click((function(){$(".black-bg").fadeIn(500)}))}function withebg(){$(".qual-width-images").mouseover((function(){var i=$(this).attr("id").substr(3);$(".image-overlay").not("#overlay"+i).css("display","block")})),$(".qual-width-images").mouseout((function(){$(".image-overlay").css("display","none")}))}
function LinkWithIconInit(){$(".link_with_icon").each((function(){var a=$(this),i=a.attr("href");if(a.find(".icon").empty(),void 0!==i){var e=i.substring(i.lastIndexOf(".")+1,i.length);switch(e){case"jpg":case"jpeg":case"png":case"gif":a.find(".icon").append('<i class="fa-solid fa-file-image" style="color: #ff9500;"></i>');break;case"pdf":a.find(".icon").append('<i class="fa-solid fa-file-pdf" style="color: #b30b00;"></i>');break;case"doc":case"docx":case"odt":a.find(".icon").append('<i class="fa-solid fa-file-word" style="color: #2c599d;"></i>');break;case"ppt":case"pptx":case"odp":a.find(".icon").append('<i class="fa-solid fa-file-powerpoint" style="color: #D04323;"></i>');case"xls":case"xlsx":case"ods":a.find(".icon").append('<i class="fa-solid fa-file-excel" style="color: #037945;"></i>');break;case"zip":case"rar":a.find(".icon").append('<i class="fa-solid fa-file-zipper"></i>');break;default:a.find(".icon").append('<i class="fa-solid fa-file" style="color: #999999;"></i>')}}void 0===a.attr("download")&&a.attr("download","未命名"),a.find(".name").text(a.attr("download")),new RegExp(`${e}$`,"gi").test(a.attr("download"))?a.attr("download",`${a.attr("download")}`):a.attr("download",`${a.attr("download")}.${e}`),a.attr("title",`${a.attr("download")}(另開新視窗)`)}))}
function ShareBlockInit(){$(".shareBlock").each((function(){void 0!==$(this).data("init")&&$(this).data("init")||($(this).cShare({description:"jQuery plugin - C Share buttons...",showButtons:["email","plurk","twitter","fb","line"]}),$(this).data("init",!0))}))}
function SitemapInit(){var e=function(e){return $.ajax({url:"/api/WebMenu/GetAll/",type:"GET",contentType:"application/json; charset=utf-8",data:{WebsiteID:e}})};"undefined"!=typeof SiteId?e(SiteId).done((function(e){CreateSitemap(e.maps)})):e(null).done((function(e){CreateSitemap(e.maps)}))}function CreateSitemap(e){var t=$(".sitemap_hierarchical_frame");t.append('<ul class=""></ul>');var a=1;e.forEach((function(e){var n=$($("#Hierarchical_First_Item").html()).clone(),l=n.find(".first");if(null!=e.children){l.text(`${a} ${e.title}`),n.append('<ul class="ps-5 ps-md-0 col-md-8 py-1"></ul>');var i=n.find("ul"),r=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Second_Item").html()).clone(),n=t.find(".second");if(n.attr("href",e.routerName),n.attr("alt",e.text),null!=e.children){n.removeClass("ps-4 ps-sm-3"),n.append(`<span class="d-flex d-md-none material-symbols-outlined position-absolute start-0">expand_more</span><span class="second p-sm-0 ps-2">${a}-${r} ${e.title}</span><span class="d-none d-md-flex material-symbols-outlined">navigate_next</span>`),t.append('<ul class="ps-5 ps-md-0 col-md-6"></ul>');var l=t.find("ul"),s=1;e.children.forEach((function(e){var t=$($("#Hierarchical_Third_Item").html()).clone(),n=t.find(".third");n.attr("href",`${e.routerName}`),n.attr("alt",e.text),n.text(`${a}-${r}-${s} ${e.title}`),l.append(t),s++}))}else n.text(`${a}-${r} ${e.title}`);i.append(t),r++}))}else l.parent("div").parent("div").html(`<a class="first d-block text-black px-3 rounded-3" href="${e.routerName}" alt="${e.text}">${a} ${e.title}</a>`);t.append(n),a++}))}
function SwiperInit(i){var t={slidesPerView:1,spaceBetween:15};$.fn.extend({swiperBindEven:function(i){const t=function(){console.log("stop"),i.autoplay.stop()},e=function(){console.log("start"),i.autoplay.start()};$(this).find(".swiper").prepend($(this).find(".swiper_button_prev")),$(this).on("mouseover",t),$(this).find("a").on("focus",t),$(this).on("mouseout",e),$(this).find("a").on("blob",e)}}),$(".one_swiper").prop("draggable",!0).each((function(){var e=$(this);if(!e.data("isInit")){var n="#"+e.attr("id")+" > .swiper",a=Object.assign({},t,{pagination:{el:n+" > .swiper_pagination > *",clickable:!0},navigation:{nextEl:n+" > .swiper_button_next > button",prevEl:n+" > .swiper_button_prev > button"}},i.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),s=new Swiper(n,a);e.data("isInit",!0),e.swiperBindEven(s)}})),$(".two_swiper").prop("draggable",!0).each((function(){var e=$(this);if(!e.data("isInit")){var n="#"+e.attr("id")+" > .swiper",a=Object.assign({},t,{pagination:{el:n+" > .swiper_pagination > *",clickable:!0,renderBullet:function(i,t){return e.has(".swiper_pagination_water").length?'<span class="'+t+' material-symbols-outlined ms-3">water_drop</span>':'<span class="'+t+'"></span>'}},navigation:{nextEl:n+" > .swiper_button_next > button",prevEl:n+" > .swiper_button_prev > button"},breakpoints:{375:{slidesPerView:2}}},i.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),s=new Swiper(n,a);e.data("isInit",!0),e.swiperBindEven(s)}})),$(".four_swiper").prop("draggable",!0).each((function(){var e=$(this);if(!e.data("isInit")){var n="#"+e.attr("id")+" > .swiper",a=Object.assign({},t,{pagination:{el:n+" > .swiper_pagination > *",clickable:!0},navigation:{nextEl:n+" > .swiper_button_next > button",prevEl:n+" > .swiper_button_prev > button"},breakpoints:{375:{slidesPerView:2},576:{slidesPerView:3},769:{slidesPerView:4}}},i.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),s=new Swiper(n,a);e.data("isInit",!0),e.swiperBindEven(s)}})),$(".six_swiper").prop("draggable",!0).each((function(){var e=$(this);if(!e.data("isInit")){var n="#"+e.attr("id")+" > .swiper",a=Object.assign({},t,{navigation:{nextEl:n+" > .swiper_button_next > button",prevEl:n+" > .swiper_button_prev > button"},slidesPerView:6},i.autoplay?{autoplay:{delay:5e3,disableOnInteraction:!1},loop:!0}:{}),s=new Swiper(n,a);e.data("isInit",!0),e.swiperBindEven(s)}}))}
function ViewTypeChangeInit(){$(".type_change_frame").each((function(){var e=$(this);if(!e.data("isInit")){const d=e.find(".btn_grid"),a=e.find(".btn_list"),s=e.find(".btn_text"),n=e.find(".content").first();d.on("click",(function(){d.data("activate")||typeChange(d,a,s,n,"Grid")})),a.on("click",(function(){a.data("activate")||typeChange(a,d,s,n,"List")})),s.on("click",(function(){s.data("activate")||typeChange(s,a,d,n,"Text")})),d.hasClass("d-none")&&!a.hasClass("d-none")&&a.trigger("click"),d.hasClass("d-none")&&a.hasClass("d-none")&&!s.hasClass("d-none")&&s.trigger("click"),e.find(".btn_grid.d-none,.btn_list.d-none,.btn_text.d-none").length>=2?e.find(".switch_control").addClass("d-none"):e.find(".switch_control").removeClass("d-none")}e.data("isInit",!0)}))}function typeChange(e,d,a,s,n){switch(e.data("activate",1),e.removeClass("text-black-50"),d.data("activate",0),d.addClass("text-black-50"),a.data("activate",0),a.addClass("text-black-50"),n){case"List":s.each((function(){var e=$(this);e.removeClass("row row-cols-sm-4"),e.find("figure").removeClass("flex-column"),e.find(".image_frame").removeClass("w-100"),e.find(".image_frame").removeClass("d-none"),e.find(".image").addClass("px-0"),e.find(".image").removeClass("d-none"),e.find(".max-h").addClass("max-hei"),e.find("figcaption").addClass("flex-grow-1 p-3 py-0 py-md-3"),e.find(".description").removeClass("d-none"),e.find(".more").removeClass("d-none"),e.find(".date").removeClass("d-none"),e.find(".box-shadow").removeClass("h_100"),e.find(".box-shadow").removeClass("text-border"),e.find(".box-shadow").addClass("type3").removeClass("type2 type1"),e.find(".box-shadow").addClass("p-1").removeClass("p-3"),e.find(".card-border").removeClass("h_100"),e.find(".hover_protrude_scale").removeClass("text-border"),e.find(".card-border").addClass("type3").removeClass("type2 type1"),e.find(".card-border").addClass("card-border-rd"),e.find(".more-btn").addClass("d-none"),e.find(".related-tag").removeClass("d-none"),e.find(".card-border").removeClass("pr3").addClass("p-3"),e.find(".imgh").addClass("img-h"),e.find(".mergetag").addClass("merge"),e.find(".check_btn").removeClass("w-100").addClass("check_btn-type3"),e.find(".search-more").removeClass("d-none"),e.find(".description").addClass("type3-content").removeClass("type2-content"),e.find(".image_frame").addClass("h-100"),e.find(".title").removeClass("type2-title pr3 text-center h-100").addClass("type1-title  fw-bold"),e.find("figcaption").addClass("pb1")}));break;case"Grid":s.each((function(){var e=$(this);e.addClass("row row-cols-sm-4"),e.find("figure").addClass("flex-column"),e.find(".image_frame").addClass("w-100"),e.find(".image_frame").removeClass("d-none"),e.find(".image").removeClass("px-0"),e.find(".image").removeClass("d-none"),e.find("figcaption").removeClass("flex-grow-1 p-3 py-0 py-md-3"),e.find(".description").addClass("d-none"),e.find(".more").addClass("d-none"),e.find(".date").addClass("d-none"),e.find(".more-btn").addClass("d-none"),e.find(".box-shadow").removeClass("h_100"),e.find(".box-shadow").removeClass("text-border"),e.find(".box-shadow").addClass("type2").removeClass("type1 type3"),e.find(".box-shadow").addClass("p-1").removeClass("p-3"),e.find(".card-border").addClass("type2").removeClass("type1 type3"),e.find(".card-border").removeClass("h_100"),e.find(".card-border").addClass("card-border-rd"),e.find(".card-border").removeClass("pr3").addClass("p-3"),e.find(".related-tag").removeClass("d-none"),e.find(".imgh").removeClass("img-h"),e.find(".mergetag").removeClass("merge"),e.find(".check_btn").addClass("w-100").removeClass("check_btn-type3"),e.find(".search-more").removeClass("d-none"),e.find(".title").removeClass("p-2 pr3"),e.find(".description").addClass("type2-content").removeClass("type3-content"),e.find(".image_frame").removeClass("h-100"),e.find(".title").removeClass("h-100 text-center type2-title").addClass("type1-title fw-bold p-2"),e.find("figcaption").addClass("pb1")}));break;case"Text":s.each((function(){var e=$(this);e.addClass("row row-cols-sm-4"),e.find("figure").addClass("flex-column"),e.find(".image_frame").removeClass("w-100 "),e.find(".image_frame").addClass("d-none"),e.find(".image").removeClass("px-0"),e.find(".image").addClass("d-none"),e.find(".max-h").removeClass("max-hei"),e.find("figcaption").removeClass("flex-grow-1 p-3 py-0 py-md-3"),e.find(".description").addClass("d-none"),e.find(".date").addClass("d-none"),e.find(".more").addClass("d-none"),e.find(".more-btn").removeClass("d-none"),e.find(".title").addClass("pr3").removeClass("p-2"),e.find(".box-shadow").removeClass("h_100"),e.find(".box-shadow").addClass("text-border"),e.find(".box-shadow").addClass("type1").removeClass("type2 type3"),e.find(".box-shadow").addClass("p-1").removeClass("p-3"),e.find(".related-tag").addClass("d-none"),e.find(".card-border").removeClass("h_100"),e.find(".card-border").addClass("type1").removeClass("type2 type3"),e.find(".card-border").removeClass("card-border-rd"),e.find(".card-border").removeClass("p-3").addClass("pr3"),e.find(".imgh").removeClass("img-h"),e.find(".mergetag").removeClass("merge "),e.find(".check_btn").addClass("w-100").removeClass("check_btn-type3"),e.find(".search-more").addClass("d-none"),e.find(".image_frame").removeClass("h-100"),e.find(".title").removeClass("type1-title fw-bold text-center p-2").addClass("type2-title h-100"),e.find("figcaption").removeClass("pb1")}))}}
function date_input_change(a){var t=$(`#${a}`),n=t.attr("date-date-strat-date"),e=t.attr("data-date-end"),d=t.attr("data-location"),i=t.attr("data-addr"),s=t.attr("data-organizer"),r=t.attr("data-a-organizer"),o=t.attr("data-link"),l=t.attr("data-tel"),v=t.find(".activity_start_time").parents("div").eq(1);""==n&&""==e?$(v).addClass("d-none"):$(v).removeClass("d-none");var c=t.find(".activity_location").parents("div").eq(0);""==d?$(c).addClass("d-none"):$(c).removeClass("d-none");var f=t.find(".activity_addr").parents("div").eq(0);""==i?$(f).addClass("d-none"):$(f).removeClass("d-none");var C=t.find(".activity-organizer").parent("div").eq(0);""==s?$(C).addClass("d-none"):$(C).removeClass("d-none");var m=t.find(".activity-a-organizer").parent("div").eq(0);""==r?$(m).addClass("d-none"):$(m).removeClass("d-none");var _=t.find(".activity_link").parents("div").eq(0);""==o?$(_).addClass("d-none"):$(_).removeClass("d-none");var h=t.find(".activity_tel").parents("div").eq(0);return""==l?$(h).addClass("d-none"):$(h).removeClass("d-none"),t.find(".activity_start_time").html(n),t.find(".activity_end_time").html(e),t.find(".activity_location").html(d),t.find(".activity_addr").html(i),t.find(".activity-organizer").html(s),t.find(".activity-a-organizer").html(r),t.find(".activity_link").html(o),t.find(".activity_tel").html(l),t.html()}function namecontrol(a){const t=$("#"+a),n=t.find(".btn_text"),e=t.find(".btn_grid"),d=t.find(".btn_list"),i=t.parents(".type_change_frame").first().find(".content").first();n.hasClass("d-none")?n.hasClass("d-none")&&!e.hasClass("d-none")?typeChange(e,d,n,i,"Grid"):n.hasClass("d-none")&&e.hasClass("d-none")&&!d.hasClass("d-none")&&typeChange(d,e,n,i,"List"):typeChange(n,e,d,i,"Text")}